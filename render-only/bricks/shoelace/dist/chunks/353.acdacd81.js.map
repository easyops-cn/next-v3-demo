{"version":3,"file":"chunks/353.acdacd81.js","mappings":"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","sources":["webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/createProviderClass.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/expressions/beforeVisitGlobalMember.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/expressions/traverse.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/expressions/collectMemberUsage.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/expressions/track.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/functions/traverse.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/functions/collectMemberUsageInFunction.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/permissions.js","webpack:///../../node_modules/@next-core/utils/dist/esm/storyboard/unwrapProvider.js"],"sourcesContent":["export function createProviderClass(api) {\n  return class extends HTMLElement {\n    get $$typeof() {\n      return \"provider\";\n    }\n    resolve() {\n      return api(...arguments);\n    }\n  };\n}\n//# sourceMappingURL=createProviderClass.js.map","export function beforeVisitGlobalMember(usage, objectName) {\n  var level = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  return function beforeVisitGlobal(node, parent) {\n    if (node.name === objectName) {\n      var segments = [];\n      for (var i = 1; i <= level; i++) {\n        var memberParent = parent[parent.length - i];\n        if ((memberParent === null || memberParent === void 0 ? void 0 : memberParent.node.type) === \"MemberExpression\" && memberParent.key === \"object\") {\n          var memberNode = memberParent.node;\n          if (!memberNode.computed && memberNode.property.type === \"Identifier\") {\n            segments.push(memberNode.property.name);\n          } else if (memberNode.computed && memberNode.property.type === \"Literal\" && typeof memberNode.property.value === \"string\") {\n            segments.push(memberNode.property.value);\n          } else {\n            usage.hasNonStaticUsage = true;\n          }\n        } else {\n          usage.hasNonStaticUsage = true;\n        }\n      }\n      if (segments.length === level) {\n        usage.usedProperties.add(segments.join(\".\"));\n      }\n    }\n  };\n}\n//# sourceMappingURL=beforeVisitGlobalMember.js.map","import { isEvaluable, preevaluate } from \"@next-core/cook\";\nimport { isObject } from \"@next-core/utils/general\";\nexport function traverseStoryboardExpressions(data, beforeVisitGlobal,\n// If `options` is a string, it means the *keyword*.\noptions) {\n  var memo = new WeakSet();\n  var {\n    matchExpressionString,\n    visitNotMatchedExpressionString,\n    visitNonExpressionString,\n    visitObject\n  } = typeof options === \"string\" ? {\n    matchExpressionString: v => v.includes(options)\n  } : options;\n  function traverse(value) {\n    if (typeof value === \"string\") {\n      if (isEvaluable(value)) {\n        if (matchExpressionString(value)) {\n          try {\n            preevaluate(value, {\n              withParent: true,\n              hooks: {\n                beforeVisitGlobal(node, parent) {\n                  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                  beforeVisitGlobal(node, parent, value);\n                }\n              }\n            });\n          } catch (error) {\n            // eslint-disable-next-line no-console\n            console.error(\"Parse storyboard expression failed:\", error);\n          }\n        } else {\n          visitNotMatchedExpressionString === null || visitNotMatchedExpressionString === void 0 ? void 0 : visitNotMatchedExpressionString(value);\n        }\n      } else {\n        visitNonExpressionString === null || visitNonExpressionString === void 0 ? void 0 : visitNonExpressionString(value);\n      }\n    } else if (isObject(value)) {\n      // Avoid call stack overflow.\n      if (memo.has(value)) {\n        return;\n      }\n      memo.add(value);\n      visitObject === null || visitObject === void 0 ? void 0 : visitObject(value);\n      for (var item of Array.isArray(value) ? value : Object.values(value)) {\n        traverse(item);\n      }\n    }\n  }\n  traverse(data);\n}\n//# sourceMappingURL=traverse.js.map","import { beforeVisitGlobalMember } from \"./beforeVisitGlobalMember.js\";\nimport { traverseStoryboardExpressions } from \"./traverse.js\";\nexport function strictCollectMemberUsage(data, objectName) {\n  var level = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var {\n    hasNonStaticUsage,\n    nonStaticUsage,\n    usedProperties\n  } = collectMemberUsage(data, objectName, level);\n  if (hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \".concat(objectName, \" is prohibited, check your expression: \\\"\").concat(nonStaticUsage, \"\\\"\"));\n  }\n  return usedProperties;\n}\nexport function collectMemberUsage(data, objectName) {\n  var level = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var usage = {\n    usedProperties: new Set(),\n    hasNonStaticUsage: false\n  };\n  var beforeVisitGlobal = beforeVisitGlobalMember(usage, objectName, level);\n  traverseStoryboardExpressions(data, (node, parent, expr) => {\n    beforeVisitGlobal(node, parent);\n    if (usage.hasNonStaticUsage) {\n      usage.nonStaticUsage = expr;\n    }\n  }, objectName);\n  return usage;\n}\n//# sourceMappingURL=collectMemberUsage.js.map","import { preevaluate } from \"@next-core/cook\";\nimport { beforeVisitGlobalMember } from \"./beforeVisitGlobalMember.js\";\nexport function track(raw, trackText, variableName) {\n  if (raw.includes(trackText)) {\n    var usage = {\n      usedProperties: new Set(),\n      hasNonStaticUsage: false\n    };\n    var {\n      expression\n    } = preevaluate(raw, {\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal: beforeVisitGlobalMember(usage, variableName)\n      }\n    });\n    var trackCtxExp;\n    if (expression.type === \"SequenceExpression\" && (trackCtxExp = expression.expressions[0]) && trackCtxExp.type === \"Literal\" && trackCtxExp.value === trackText) {\n      if (usage.usedProperties.size > 0) {\n        return usage.usedProperties;\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn(\"You are using \\\"\".concat(trackText, \"\\\" but no `\").concat(variableName, \"` usage found in your expression: \").concat(JSON.stringify(raw)));\n      }\n    }\n  }\n  return false;\n}\n//# sourceMappingURL=track.js.map","import { precookFunction } from \"@next-core/cook\";\nexport function traverseStoryboardFunctions(functions, beforeVisitGlobal) {\n  if (Array.isArray(functions)) {\n    for (var fn of functions) {\n      traverseStoryboardFunction(fn, beforeVisitGlobal);\n    }\n  }\n}\nexport function traverseStoryboardFunction(fn, beforeVisitGlobal) {\n  try {\n    precookFunction(fn.source, {\n      typescript: fn.typescript,\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal\n      }\n    });\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(\"Parse storyboard function \\\"\".concat(fn.name, \"\\\" failed:\"), error);\n  }\n}\n//# sourceMappingURL=traverse.js.map","import { beforeVisitGlobalMember } from \"../expressions/beforeVisitGlobalMember.js\";\nimport { traverseStoryboardFunction } from \"./traverse.js\";\nexport function strictCollectMemberUsageInFunction(fn, objectName) {\n  var level = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var {\n    hasNonStaticUsage,\n    usedProperties\n  } = collectMemberUsageInFunction(fn, objectName, level);\n  if (hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \".concat(objectName, \" is prohibited, check your function: \\\"\").concat(fn.name, \"\\\"\"));\n  }\n  return usedProperties;\n}\nexport function collectMemberUsageInFunction(fn, objectName) {\n  var level = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var usage = {\n    usedProperties: new Set(),\n    hasNonStaticUsage: false\n  };\n  traverseStoryboardFunction(fn, beforeVisitGlobalMember(usage, objectName, level));\n  usage.usedProperties.delete(fn.name);\n  return usage;\n}\n//# sourceMappingURL=collectMemberUsageInFunction.js.map","import { traverseStoryboardExpressions } from \"./expressions/index.js\";\nimport { traverseStoryboardFunctions } from \"./functions/index.js\";\nvar PERMISSIONS = \"PERMISSIONS\";\nvar check = \"check\";\nexport function scanPermissionActionsInStoryboard(storyboard) {\n  var _storyboard$meta;\n  var collection = new Set();\n  var beforeVisitPermissions = beforeVisitPermissionsFactory(collection);\n  var {\n    customTemplates,\n    functions\n  } = (_storyboard$meta = storyboard.meta) !== null && _storyboard$meta !== void 0 ? _storyboard$meta : {};\n  traverseStoryboardExpressions([storyboard.routes, customTemplates], beforeVisitPermissions, PERMISSIONS);\n  traverseStoryboardFunctions(functions, beforeVisitPermissions);\n  return Array.from(collection);\n}\nexport function scanPermissionActionsInAny(data) {\n  var collection = new Set();\n  traverseStoryboardExpressions(data, beforeVisitPermissionsFactory(collection), PERMISSIONS);\n  return Array.from(collection);\n}\nfunction beforeVisitPermissionsFactory(collection) {\n  return function beforeVisitPermissions(node, parent) {\n    if (node.name === PERMISSIONS) {\n      var memberParent = parent[parent.length - 1];\n      var callParent = parent[parent.length - 2];\n      if ((callParent === null || callParent === void 0 ? void 0 : callParent.node.type) === \"CallExpression\" && (callParent === null || callParent === void 0 ? void 0 : callParent.key) === \"callee\" && (memberParent === null || memberParent === void 0 ? void 0 : memberParent.node.type) === \"MemberExpression\" && memberParent.key === \"object\" && (memberParent.node.computed ? memberParent.node.property.type === \"Literal\" && memberParent.node.property.value === check : memberParent.node.property.type === \"Identifier\" && memberParent.node.property.name === check)) {\n        for (var arg of callParent.node.arguments) {\n          if (arg.type === \"Literal\" && typeof arg.value === \"string\") {\n            collection.add(arg.value);\n          }\n        }\n      }\n    }\n  };\n}\n//# sourceMappingURL=permissions.js.map","var pool = new Map();\nfunction getProviderBrick(provider) {\n  var brick = pool.get(provider);\n  if (brick) {\n    return brick;\n  }\n  brick = document.createElement(provider);\n  pool.set(provider, brick);\n  return brick;\n}\nexport function unwrapProvider(provider) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    var brick = getProviderBrick(provider);\n    return brick.resolve(...args);\n  };\n}\n//# sourceMappingURL=unwrapProvider.js.map"],"names":["createProviderClass","api","HTMLElement","$$typeof","resolve","arguments","beforeVisitGlobalMember","usage","objectName","level","length","undefined","node","parent","name","segments","i","memberParent","type","key","memberNode","computed","property","value","push","hasNonStaticUsage","usedProperties","add","join","traverseStoryboardExpressions","data","beforeVisitGlobal","options","memo","WeakSet","matchExpressionString","visitNotMatchedExpressionString","visitNonExpressionString","visitObject","v","includes","traverse","isEvaluable","preevaluate","withParent","hooks","error","console","isObject","has","item","Array","isArray","Object","values","strictCollectMemberUsage","nonStaticUsage","collectMemberUsage","Error","concat","Set","expr","track","raw","trackText","variableName","trackCtxExp","expression","expressions","size","warn","JSON","stringify","traverseStoryboardFunctions","functions","fn","traverseStoryboardFunction","precookFunction","source","typescript","strictCollectMemberUsageInFunction","collectMemberUsageInFunction","delete","PERMISSIONS","check","scanPermissionActionsInStoryboard","storyboard","_storyboard$meta","collection","beforeVisitPermissions","beforeVisitPermissionsFactory","customTemplates","meta","routes","from","scanPermissionActionsInAny","callParent","arg","pool","Map","unwrapProvider","provider","_len","args","_key","brick","get","document","createElement","set","getProviderBrick"],"sourceRoot":""}