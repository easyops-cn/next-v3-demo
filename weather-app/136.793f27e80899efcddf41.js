/*! For license information please see 136.793f27e80899efcddf41.js.LICENSE.txt */
"use strict";(self.webpackChunkweather_app=self.webpackChunkweather_app||[]).push([[136],{4795:(e,t,r)=>{function n(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)}))}}r.d(t,{Z:()=>a})},5863:(e,t,r)=>{function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}r.d(t,{Z:()=>n})},175:(e,t,r)=>{function n(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}r.d(t,{Z:()=>n})},687:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(175);function a(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,(0,n.Z)(e,t,"get"))}},3395:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(5863);function a(e,t,r){(0,n.Z)(e,t),t.set(e,r)}},381:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(175);function a(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,(0,n.Z)(e,t,"set"),r),r}},6171:(e,t,r)=>{function n(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}r.d(t,{Z:()=>n})},5866:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(5863);function a(e,t){(0,n.Z)(e,t),t.add(e)}},6666:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(5850);function a(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},3028:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(6666);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},2159:(e,t,r)=>{function n(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}r.d(t,{Z:()=>n})},5850:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(6522);function a(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(t)?t:String(t)}},6522:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:()=>n})},7136:(e,t,r)=>{r.r(t),r.d(t,{Dialog:()=>Mt,Notification:()=>Ft,StoryboardFunctionRegistryFactory:()=>J,__secret_internals:()=>n,applyTheme:()=>N,authenticate:()=>mo,batchSetAppsLocalTheme:()=>U,checkIfByTransform:()=>Qe,checkIfOfComputed:()=>ze,createHistory:()=>ye,createRuntime:()=>fa,customProcessors:()=>b,customTemplates:()=>lt,fetchByProvider:()=>wo,getAuth:()=>go,getBasePath:()=>V,getCssPropertyValue:()=>W,getCurrentMode:()=>D,getCurrentTheme:()=>B,getHistory:()=>be,getPageInfo:()=>en,getRuntime:()=>va,handleHttpError:()=>jt,httpErrorToString:()=>xt,isLoggedIn:()=>bo,isUnauthenticatedError:()=>Lt,logout:()=>yo,matchPath:()=>bt,registerWidgetFunctions:()=>Za,registerWidgetI18n:()=>k,unstable_createRoot:()=>So});var n={};r.r(n),r.d(n,{initializePlayground:()=>Po,legacyDoTransform:()=>_o,loadBricks:()=>Ao,mountUseBrick:()=>Io,renderUseBrick:()=>ko,unmountUseBrick:()=>Oo,updateSnippetPreviewSettings:()=>Lo,updateStoryboard:()=>To,updateStoryboardByRoute:()=>Co,updateStoryboardBySnippet:()=>xo,updateStoryboardByTemplate:()=>Ro,updateTemplatePreviewSettings:()=>Mo});var a=r(3028),o=r(4795),i=r(5178),s=r(4900),c=r(3352),l=function(){var e=(0,o.Z)((function*(e,t){return(yield c.http.post("api/gateway/micro_app.permission.ValidatePermissions/api/micro_app/v1/permission/validate",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}(),u=r(9530),p=r(6081),d=r(4565),f=r(2159),v=r(1337),h=r(8817),m=r(3395),g=r(687),y=new WeakMap,b=new class{constructor(){(0,m.Z)(this,y,{writable:!0,value:new Map})}define(e,t){var[r,n]=e.split("."),a=(0,g.Z)(this,y).get(r);if(a||(a=new Map,(0,g.Z)(this,y).set(r,a)),a.has(n))throw new Error('Custom processor of "'.concat(e,'" already registered'));a.set(n,t)}get(e){return(0,g.Z)(this,y).get(e)}},w=r(9925);function E(e){var{app:t,meta:r}=e;if(null!=r&&r.i18n){var n=S("app",t.id);Object.entries(r.i18n).forEach((e=>{var[t,r]=e;w.i18n.addResourceBundle(t,n,r)}))}}function S(e,t){return"".concat(e,"/").concat(t)}function k(e,t){var r=S("widget",e);Object.entries(t).forEach((e=>{var[t,n]=e;w.i18n.addResourceBundle(t,r,n)}))}function Z(e){return w.i18n.getFixedT(null,S("widget",e))}function I(e,t){return{get(r){var n;return"".concat(null!==(n=window.PUBLIC_ROOT)&&void 0!==n?n:"","bricks/").concat(e,"/").concat(window.PUBLIC_ROOT_WITH_VERSION&&t?"".concat(t,"/"):"","dist/assets/").concat(r)}}}function O(){return window.__BRICK_NEXT_DEVTOOLS_HOOK__}var P=()=>{throw new Error("Can't modify read-only proxy object")},_={set:P,defineProperty:P,deleteProperty:P,setPrototypeOf:P};function A(e){return new Proxy(e,_)}function T(e){var{get:t,ownKeys:r}=e;return O()?A(Object.fromEntries(r(null).map((e=>[e,t(null,e,null)])))):new Proxy(Object.freeze({}),{get:t})}var C="light",R=new p.JsonStorage(localStorage),M="apps-theme";function x(e){if("dark"!==e&&"light"!==e&&"dark-v2"!==e)throw new Error("Unsupported theme: ".concat(e));C=e}function L(){return C}function B(){return document.documentElement.dataset.theme}function N(e){e?x(e):e=L(),e!==B()&&(document.documentElement.dataset.theme=e,window.dispatchEvent(new CustomEvent("theme.change",{detail:e})))}function U(e){R.setItem(M,(0,a.Z)((0,a.Z)({},j()),e))}function j(){var e,t;try{t=R.getItem(M)}catch(e){console.error("JSON parse error inside `getLocalAppsTheme()`")}return null!==(e=t)&&void 0!==e?e:{}}var $="default";function F(e){if("dashboard"!==e&&"default"!==e)throw new Error("Unsupported mode: ".concat(e));$=e}function D(){return document.documentElement.dataset.mode}function K(e){e?F(e):e=$,e!==D()&&(document.documentElement.dataset.mode=e,window.dispatchEvent(new CustomEvent("mode.change",{detail:e})))}function W(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;return r&&(null===(t=window.getComputedStyle(r))||void 0===t?void 0:t.getPropertyValue(e))||""}function V(){var e=document.querySelector("base");return e?e.getAttribute("href"):"/"}function H(e,t){var r={};for(var n of e){var a=q(n,t);void 0!==a&&(r[n]=a)}return r}function q(e,t){var r,n,{collectCoverage:a,widgetId:o,widgetVersion:s,app:c,appendI18nNamespace:l,storyboardFunctions:u,isStoryboardFunction:p}=t;switch(e){case"BASE_URL":return a?"/next":V().replace(/\/$/,"");case"FN":return u;case"IMG":return a?{get:e=>"mock/images/".concat(e)}:o?I(o,s):(r=c.id,n=c.isBuildPush,{get:e=>n?"api/gateway/object_store.object_store.GetObject/api/v1/objectStore/bucket/next-builder/object/".concat(e):"".concat(window.APP_ROOT?"".concat(window.APP_ROOT,"-/"):"","micro-apps/").concat(r,"/images/").concat(e)});case"I18N":return a?i.identity:o?Z(o):w.i18n.getFixedT(null,[l,S("app",c.id)].filter(Boolean));case"I18N_TEXT":return a?G:w.i18nText;case"PERMISSIONS":return A({check:a?z:vo});case"THEME":return A({getTheme:a?()=>"light":L});case"console":return p?A(console):void 0;case"location":return a?{href:"http://localhost:3000/functions/test",origin:"http://localhost:3000",host:"localhost:3000",hostname:"localhost"}:{href:location.href,origin:location.origin,host:location.host,hostname:location.hostname}}}function G(e){return null==e?void 0:e.en}function z(){return!0}function J(){var e,{widgetId:t,widgetVersion:r,collectCoverage:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=new Map,i=new Proxy(Object.freeze({}),{get:(a,s)=>function(a){var s,c=o.get(a);if(c){if(c.processed)return c.cooked;n&&(s=n.createCollector(a));var l=(0,u.precookFunction)(c.source,{typescript:c.typescript,hooks:s&&{beforeVisit:s.beforeVisit}});return c.cooked=(0,u.cook)(l.function,c.source,{rules:{noVar:!0},globalVariables:(0,h.supply)(l.attemptToVisitGlobals,H(l.attemptToVisitGlobals,{collectCoverage:n,widgetId:t,widgetVersion:r,app:e,storyboardFunctions:i,isStoryboardFunction:!0}),!!n),hooks:s&&{beforeEvaluate:s.beforeEvaluate,beforeCall:s.beforeCall,beforeBranch:s.beforeBranch}}),c.processed=!0,c.cooked}}(s)});return{storyboardFunctions:i,registerStoryboardFunctions:function(t,r){if(r&&(e=r),o.clear(),Array.isArray(t))for(var n of t){var a=(0,s.strictCollectMemberUsageInFunction)(n,"FN"),i=(0,s.strictCollectMemberUsageInFunction)(n,"PERMISSIONS").has("check");o.set(n.name,{source:n.source,typescript:n.typescript,deps:a,hasPermissionsCheck:i})}},updateStoryboardFunction(e,t){var r=(0,a.Z)((0,a.Z)({},t),{},{name:e}),n=(0,s.strictCollectMemberUsageInFunction)(r,"FN"),i=(0,s.strictCollectMemberUsageInFunction)(r,"PERMISSIONS").has("check");o.set(e,{source:t.source,typescript:t.typescript,deps:n,hasPermissionsCheck:i})},checkPermissionsUsage(e){var t=new Set,r=e=>{if(!t.has(e)){t.add(e);var n=o.get(e);return!!n&&(n.hasPermissionsCheck||[...n.deps].some(r))}return!1};return e.some(r)}}}var{storyboardFunctions:Q,registerStoryboardFunctions:Y,checkPermissionsUsage:X}=J(),ee={};try{ee.EventTarget=(new EventTarget).constructor}catch(e){!function(e,t){var r=e.create,n=e.defineProperty,a=o.prototype;function o(){t.set(this,r(null))}function i(e,t,r){n(e,t,{configurable:!0,writable:!0,value:r})}function s(e){var t=e.options;return t&&t.once&&e.target.removeEventListener(this.type,e.listener),"function"==typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this),this._stopImmediatePropagationFlag}i(a,"addEventListener",(function(e,r,n){for(var a=t.get(this),o=a[e]||(a[e]=[]),i=0,s=o.length;i<s;i++)if(o[i].listener===r)return;o.push({target:this,listener:r,options:n})})),i(a,"dispatchEvent",(function(e){var r=t.get(this)[e.type];return r&&(i(e,"target",this),i(e,"currentTarget",this),r.slice(0).some(s,e),delete e.currentTarget,delete e.target),!0})),i(a,"removeEventListener",(function(e,r){for(var n=t.get(this),a=n[e]||(n[e]=[]),o=0,i=a.length;o<i;o++)if(a[o].listener===r)return void a.splice(o,1)})),ee.EventTarget=o}(Object,new WeakMap)}const te=ee.EventTarget;var re=function(e){return e.xLarge="xLarge",e.large="large",e.medium="medium",e.small="small",e.xSmall="xSmall",e}({}),ne=new Map([[re.xLarge,"1920px"],[re.large,"1600px"],[re.medium,"1280px"],[re.small,"1024px"],[re.xSmall,0]]),ae=new te,oe={},ie={};function se(e,t){var r=!1;for(var[n]of(oe[t]=e.matches,ne))if(oe[n]&&ie.breakpoint!==n){ie.breakpoint=n,r=!0;break}r&&ae.dispatchEvent(new CustomEvent("change",{detail:ie}))}ne.forEach(((e,t)=>{var r=window.matchMedia("(min-width: ".concat(e,")"));se(r,t),r.addEventListener?r.addEventListener("change",(e=>{se(e,t)})):r.addListener((e=>{se(e,t)}))}));var ce=()=>ie;function le(e){return function(t){var r,n="local"===e?localStorage:sessionStorage;return JSON.parse(null!==(r=n.getItem(t))&&void 0!==r?r:"null")}}var ue=r(8874),pe=(r(8525),r(7857));function de(e,t){var r=(0,i.orderBy)(e,(e=>{var t,r,n;return null!==(t=null===(r=e.app)||void 0===r||null===(n=r.homepage)||void 0===n?void 0:n.length)&&void 0!==t?t:0}),"desc");for(var n of r){var a=n.app.homepage;if("string"==typeof a&&"/"===a[0]&&("/"===a?t===a:"".concat(t.replace(/\/+$/,""),"/").startsWith("".concat(a.replace(/\/+$/,""),"/"))))return n}}function fe(e){var t;return!e||(null===(t=va().getCurrentApp())||void 0===t?void 0:t.id)!==e.app.id&&!window.STANDALONE_MICRO_APPS&&e.app.standaloneMode}var ve,he=["extraQuery","clear","keepHash"],me=!1;function ge(e,t){t(!(me=!confirm(e)))}function ye(){if(!ve){var e=(0,pe.createBrowserHistory)({basename:V().replace(/\/$/,""),getUserConfirmation:ge});Object.assign(e,function(e){var t,{push:r,replace:n}=e;function o(e,t,n){me=!1,r(e,t),null==n||n(me)}function i(e,t,r){me=!1,n(e,t),null==r||r(me)}function s(t){return function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,{extraQuery:s,clear:c,keepHash:l}=n,u=(0,f.Z)(n,he),p=new URLSearchParams(c?"":e.location.search),d={};for(var[v,h]of(Object.assign(d,r,s),Object.entries(d)))if(Array.isArray(h))for(var m of(p.delete(v),h))p.append(v,m);else null==h||""===h?p.delete(v):p.set(v,h);("push"===t?o:i)("?".concat(p.toString()).concat(l?e.location.hash:""),u,a)}}return(0,a.Z)({pushQuery:s("push"),replaceQuery:s("replace"),pushAnchor:function(t,r,n){o((0,a.Z)((0,a.Z)({},e.location),{},{key:void 0,hash:t,state:(0,a.Z)({notify:!1},r)}),void 0,n)},reload:function(t){i((0,a.Z)((0,a.Z)({},e.location),{},{state:(0,a.Z)((0,a.Z)({},e.location.state),{},{notify:!0})}),void 0,t)},setBlockMessage:function(e){t=e},getBlockMessage:function(){return t},unblock:function(){t=void 0}},function(e){var{push:t,replace:r}=e;function n(n){return function(a,o,i){var s,c="string"==typeof a;return"string"==typeof(s=c?(0,pe.parsePath)(a).pathname:a.pathname)&&s.startsWith("/")&&fe(function(e){var t,r;return de(null!==(t=null===(r=da)||void 0===r?void 0:r.storyboards)&&void 0!==t?t:[],e)}(s))?location["push"===n?"assign":"replace"](c?V()+a.substring(1):e.createHref(a)):("push"===n?t:r)(a,o,i)}}return{push:n("push"),replace:n("replace")}}((0,a.Z)((0,a.Z)({},e),{},{push:o,replace:i})))}(e)),ve=e}return ve}function be(){return ve}var we=r(5866),Ee=r(6171),Se=r(381),ke=r(4167),Ze=r(2308),Ie=function(){var e=(0,o.Z)((function*(e,t){return(yield c.http.post("api/contract/single_search",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}(),Oe=new Map,Pe=new Map,_e=(e,t)=>{null==e||e.forEach((e=>{t.set("".concat(e.namespaceId,".").concat(e.name),e)}))},Ae=new Map;function Te(e){return e.includes("@")}function Ce(e,t,r){return Re.apply(this,arguments)}function Re(){return Re=(0,o.Z)((function*(e,t,r){if(!Te(e))return t;if(!e.includes(":"))throw new Error("You're using legacy Custom API \"".concat(e,'" which is dropped in v3, please use Flow API instead'));var n=yield function(e){var t=Ae.get(e);return t||(t=function(e){return Me.apply(this,arguments)}(e),Ae.set(e,t)),t}(e);if(!n)throw new Error('Flow API not found: "'.concat(e,'"'));var a=function(e,t){var r,n,a="string"==typeof t.contract?Ze.safeLoad(t.contract,{schema:Ze.JSON_SCHEMA,json:!0}):t.contract,{uri:o,method:i="GET",ext_fields:s}=null!==(r=null==a?void 0:a.endpoint)&&void 0!==r?r:{},c=!(null==a||!a.response)&&!1!==a.response.wrapper;if(!o)throw new Error('Missing endpoint.uri in contract of provider "'.concat(e,'"'));return{uri:o,method:"list"===i.toLowerCase()?"get":i,ext_fields:s,name:t.name,namespace:t.namespace,serviceName:t.serviceName,version:t.version,isFileType:"file"===(null==a||null===(n=a.response)||void 0===n?void 0:n.type),responseWrapper:c,request:null==a?void 0:a.request}}(e,n);return function(e,t,r){var n,{uri:a,method:o,ext_fields:i,name:s,namespace:c,serviceName:l,responseWrapper:u,version:p,isFileType:d,request:f}=e,v=d&&"saveAs"===r;v&&(n=t.shift());var{url:h,args:m}=function(e,t,r,n,a,o){var i=o?a?"api/gateway/".concat(a):"api/gateway/".concat(n,".").concat(r,"@").concat(o):"api/gateway/api_service.".concat(n,".").concat(r),s=t.slice();return{url:i+e.replace(/:([^/]+)/g,(()=>s.shift())),args:s}}(a,t,s,c,l,p);return[...v?[n]:[],{url:h,originalUri:a,method:o,ext_fields:i,responseWrapper:u,request:f,isFileType:d},...m]}(a,t,r)})),Re.apply(this,arguments)}function Me(){return(Me=(0,o.Z)((function*(e){var[t,r]=e.split("@"),[n,a]=r.split(":"),o=function(e){return Oe.get(e)||Pe.get(e)}("".concat(t,".").concat(n));if(o)return{name:o.name,namespace:o.namespaceId,serviceName:o.serviceName,version:o.version,contract:{endpoint:o.endpoint,response:o.response,request:o.request}};var i,s,{contractData:c}=yield Ie({contractName:"".concat(t,".").concat(n),version:a});return c?{name:c.name,namespace:null===(i=c.namespace)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.name,serviceName:c.serviceName,version:c.version,contract:{endpoint:c.endpoint,response:c.response,request:c.request}}:void 0}))).apply(this,arguments)}var xe="core.provider-flow-api";function Le(e,t){return e.some((e=>e.source===t))}function Be(e){return Ne.apply(this,arguments)}function Ne(){return Ne=(0,o.Z)((function*(e){for(var t,{url:r,originalUri:n,method:o="GET",responseWrapper:s=!0,ext_fields:c=[],request:l,isFileType:u}=e,p=["get","delete","head"].includes(o.toLowerCase()),d=u?{responseType:"blob"}:{},f=arguments.length,v=new Array(f>1?f-1:0),h=1;h<f;h++)v[h-1]=arguments[h];if(p){var m,g,y,b,w,E;n&&"object"===(null==l?void 0:l.type)&&(null!==(m=null===(g=n.match(/:([^/]+)/g))||void 0===g?void 0:g.length)&&void 0!==m?m:0)===(null!==(y=null===(b=l.fields)||void 0===b?void 0:b.length)&&void 0!==y?y:0)?[E]=v:[w,E]=v,t=yield ke.http.simpleRequest(o,r,(0,a.Z)((0,a.Z)({params:w},d),E))}else{var S=function(e){if(!e||"object"!==e.type)return!1;var t=e=>!(0,i.isEmpty)(e)&&e.some((e=>["file","file[]"].includes(e.type)||t(e.fields)));return t(e.fields)}(l),k=function(e){for(var t=Le(e,"query"),r=Le(e,"body"),n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];if(t){if(r){var[s,c,l]=o;return{data:s,options:(0,a.Z)({params:c},l)}}var[u,p]=o;return{data:{},options:(0,a.Z)({params:u},p)}}var[d,f]=o;return{data:d,options:f}}(c,...v);t=yield ke.http.requestWithBody(o,r,S?function(e){if(e instanceof FormData)return e;var t=new FormData,r=function(e){Array.isArray(a)?a.forEach((r=>{t.append(e,r)})):!(0,i.isObject)(a)||a instanceof Blob||a instanceof Date?t.append(e,a):Object.entries(a).forEach((r=>{var[n,a]=r;t.append("".concat(e,"[").concat(n,"]"),a)}))};for(var[n,a]of Object.entries(e))r(n);return t}(k.data):k.data,(0,a.Z)((0,a.Z)({},d),k.options))}return!u&&s?t.data:t})),Ne.apply(this,arguments)}var Ue=new Map;function je(e){return $e.apply(this,arguments)}function $e(){return $e=(0,o.Z)((function*(e){Te(e)&&(e=xe);var t=Ue.get(e);if(t)return t;if(e.includes("-")&&!customElements.get(e))if(e===xe)customElements.define(xe,(0,s.createProviderClass)(Be));else if(yield(0,v.loadBricksImperatively)([e],ma()),!customElements.get(e))throw new Error('Provider not defined: "'.concat(e,'".'));return t=document.createElement(e),Ue.set(e,t),t})),$e.apply(this,arguments)}var Fe=new Map;function De(e,t,r){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,o.Z)((function*(e,t,r){var{useProvider:n,method:o="resolve",args:i=[],onReject:s}=e,c=e.provider;if(c&&!n)throw new Error("You're using \"provider: ".concat(c,'" which is dropped in v3, please use "useProvider" instead'));var l,[u,p]=yield Promise.all([je(n),eo(i,t)]),d=We(u,n,o,p,r,i),{transform:f}=e;try{l=yield d}catch(e){if(!function(e){return!(null==e||!e.transform)}(s))throw e;f=s.transform,l=e}return f?"string"==typeof f?{[f]:l}:eo(f,(0,a.Z)((0,a.Z)({},t),{},{data:l})):l}))).apply(this,arguments)}function We(e,t,r,n,a,o){return Ve.apply(this,arguments)}function Ve(){return Ve=(0,o.Z)((function*(e,t,r,n,a,i){var s,c;try{s=JSON.stringify({useProvider:t,method:r,args:n})}catch(e){if(!i)throw e;s=JSON.stringify({useProvider:t,method:r,originalArgs:i})}return"reload"!==(null==a?void 0:a.cache)&&(c=Fe.get(s)),c||(c=(0,o.Z)((function*(){var a=yield Ce(t,n,r);return e.resolve(...a)}))(),Fe.set(s,c)),c})),Ve.apply(this,arguments)}function He(e,t){return qe.apply(this,arguments)}function qe(){return(qe=(0,o.Z)((function*(e,t){return!(0,p.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||Ga(e.if)?yield eo(e.if,t):e.if)}))).apply(this,arguments)}function Ge(e,t){return!(0,p.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||Ga(e.if)?ro(e.if,t):e.if)}function ze(e){return!(0,p.hasOwnProperty)(e,"if")||!!e.if}function Je(){return(Je=(0,o.Z)((function*(e,t){return(0,p.isObject)(e.if)&&!Ga(e.if)?ze(yield De(e.if,t)):He(e,t)}))).apply(this,arguments)}function Qe(e,t){return Ge(e,{data:t})}var Ye=function(e){return e[e.INITIAL=0]="INITIAL",e[e.USE_BRICK=1]="USE_BRICK",e[e.USE_BRICK_ITEM=2]="USE_BRICK_ITEM",e[e.USE_BRICK_PROPERTIES=3]="USE_BRICK_PROPERTIES",e[e.USE_BRICK_TRANSFORM=4]="USE_BRICK_TRANSFORM",e[e.USE_BRICK_EVENTS=5]="USE_BRICK_EVENTS",e[e.USE_BRICK_IF=6]="USE_BRICK_IF",e[e.USE_BRICK_SLOTS=7]="USE_BRICK_SLOTS",e[e.USE_BRICK_SLOTS_ITEM=8]="USE_BRICK_SLOTS_ITEM",e[e.USE_BRICK_SLOTS_ITEM_BRICKS=9]="USE_BRICK_SLOTS_ITEM_BRICKS",e[e.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM=10]="USE_BRICK_SLOTS_ITEM_BRICKS_ITEM",e[e.USE_BRICK_LIFECYCLE=11]="USE_BRICK_LIFECYCLE",e[e.USE_BRICK_DATA_SOURCE=12]="USE_BRICK_DATA_SOURCE",e}({});function Xe(e){switch(e){case Ye.USE_BRICK_PROPERTIES:case Ye.USE_BRICK_TRANSFORM:case Ye.USE_BRICK_EVENTS:case Ye.USE_BRICK_IF:case Ye.USE_BRICK_LIFECYCLE:case Ye.USE_BRICK_DATA_SOURCE:return!0}return!1}function et(e,t,r){if(Xe(e))return e;if(t)switch(e){case Ye.USE_BRICK:return Ye.USE_BRICK_ITEM;case Ye.USE_BRICK_SLOTS_ITEM_BRICKS:return Ye.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM}else switch(e){case Ye.INITIAL:if("useBrick"===r)return Ye.USE_BRICK;break;case Ye.USE_BRICK:case Ye.USE_BRICK_ITEM:case Ye.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:switch(r){case"properties":return Ye.USE_BRICK_PROPERTIES;case"transform":return Ye.USE_BRICK_TRANSFORM;case"dataSource":return Ye.USE_BRICK_DATA_SOURCE;case"events":return Ye.USE_BRICK_EVENTS;case"slots":return Ye.USE_BRICK_SLOTS;case"children":return Ye.USE_BRICK_SLOTS_ITEM_BRICKS;case"if":return Ye.USE_BRICK_IF;case"lifeCycle":return Ye.USE_BRICK_LIFECYCLE}break;case Ye.USE_BRICK_SLOTS:return Ye.USE_BRICK_SLOTS_ITEM;case Ye.USE_BRICK_SLOTS_ITEM:if("bricks"===r)return Ye.USE_BRICK_SLOTS_ITEM_BRICKS}return Ye.INITIAL}function tt(e){var t=!1,r=!1,n=!1;if("string"==typeof e?(0,u.isEvaluable)(e):Ga(e)){var a="string"==typeof e?e:e[Ha];t=(0,s.track)(a,"track context","CTX"),r=(0,s.track)(a,"track state","STATE"),n=(0,s.track)(a,"track formstate","FORM_STATE")}return{contextNames:t,stateNames:r,formStateNames:n}}function rt(){return rt=(0,o.Z)((function*(e,t,r){return(0,p.isObject)(e)?Object.fromEntries((yield Promise.all(Object.entries(e).map(function(){var e=(0,o.Z)((function*(e){var[n,a]=e;if(Array.isArray(r)){var{contextNames:o,stateNames:i,formStateNames:s}=tt(a);(o||i||s)&&r.push({contextNames:o,stateNames:i,formStateNames:s,propName:n,propValue:a})}var c=yield eo(a,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===n?Ye.USE_BRICK:Ye.INITIAL});if(void 0!==c&&("style"!==n&&"dataset"!==n||(0,p.isObject)(c)))return[n,c]}));return function(t){return e.apply(this,arguments)}}()))).filter(Boolean)):{}})),rt.apply(this,arguments)}function nt(e,t){if(t)for(var[r,n]of Object.entries(t))switch(r){case"style":case"dataset":for(var[a,o]of Object.entries(n))e[r][a]=o;break;case"constructor":case"__proto__":case"innerHTML":throw new Error("set `".concat(r,"` is prohibited"));default:e[r]=n}}function at(e,t,r){var n=function(e,t,r){return(0,p.isObject)(e)?Object.fromEntries(Object.entries(e).map((e=>{var[n,a]=e;if(Array.isArray(r)){var{contextNames:o,stateNames:i,formStateNames:s}=tt(a);(o||i||s)&&r.push({contextNames:o,stateNames:i,formStateNames:s,propName:n,propValue:a})}var c=ro(a,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===n?Ye.USE_BRICK:Ye.INITIAL});if(void 0!==c&&("style"!==n&&"dataset"!==n||(0,p.isObject)(c)))return[n,c]})).filter(Boolean)):{}}(t,r);Array.isArray(e)||(e=[e]),e.forEach((e=>{nt(e,n)}))}function ot(e){var t,r;return!(null===(t=e?e.flags:null===(r=va())||void 0===r?void 0:r.getFeatureFlags())||void 0===t||!t["brick-next-v3-strict-mode"])}function it(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=0===n.length?"":",";e?console.error("".concat(t," is dropped in v3 strict mode").concat(o),...n):console.warn("".concat(t," is deprecated in v3 and will be dropped in strict mode").concat(o),...n)}var st=new Set(["prefix"]),ct=new WeakMap,lt=new class{constructor(){(0,m.Z)(this,ct,{writable:!0,value:new Map})}define(e,t){var r,n,o,s,c=(0,g.Z)(this,ct).has(e);c?console.warn('Custom template of "'.concat(e,'" already registered.')):(c=!!customElements.get(e))&&console.warn('Custom template of "'.concat(e,'" already defined by customElements.'));var l=ot(),u=null!==(r=null===(n=t.proxy)||void 0===n?void 0:n.properties)&&void 0!==r?r:{},p=[],d=[];for(var[f,v]of Object.entries(u))v.asVariable?(it(l,"Template `asVariable`",e,f),l||d.push(f)):v.mergeProperty||v.refTransform?console.error("Template `mergeProperty` and `refTransform` are dropped in v3:",e,f):v.ref&&p.push([f,v]);var h=(0,a.Z)((0,a.Z)({},t),{},{proxy:(0,a.Z)((0,a.Z)({},t.proxy),{},{properties:Object.fromEntries(p)}),state:(t.state?l?t.state:t.state.map((e=>(0,a.Z)({expose:!0},e))):[]).concat(d.map((e=>({name:e,expose:!0}))))});(0,g.Z)(this,ct).set(e,(0,a.Z)((0,a.Z)({},h),{},{name:e}));var m,y,b=(m=h.state,(0,i.uniq)(null!==(y=null==m?void 0:m.filter((e=>e.expose)).map((e=>e.name)))&&void 0!==y?y:[])),w=Object.entries(null!==(o=null===(s=h.proxy)||void 0===s?void 0:s.methods)&&void 0!==o?o:{}),E=b.concat(p.map((e=>e[0]))),S=w.map((e=>e[0])),k=E.concat(S).filter((e=>e in HTMLElement.prototype&&!st.has(e)));if(k.length>0&&(it(l,"Using native HTMLElement properties as template properties or methods",e,...k),l))throw new Error('In custom template "'.concat(e,'", ').concat(k.map((e=>'"'.concat(e,'"'))).join(", ")," are native HTMLElement properties, and should be avoid to be used as brick properties or methods."));if(!c){class t extends HTMLElement{get $$typeof(){return"custom-template"}static get _dev_only_definedProperties(){return E}static get _dev_only_definedMethods(){return S}$$getElementByRef(e){var t,r,n,a;return null===(t=this.$$tplStateStore)||void 0===t||null===(r=t.hostBrick)||void 0===r||null===(n=r.tplHostMetadata)||void 0===n||null===(a=n.internalBricksByRef.get(e))||void 0===a?void 0:a.element}connectedCallback(){var e=this.shadowRoot;e||(e=this.attachShadow({mode:"open"}));var t=document.createDocumentFragment(),r=document.createElement("style");r.textContent=":host{display:block}:host([hidden]){display:none}";var n=document.createElement("slot");t.appendChild(r),t.appendChild(n),e.appendChild(t)}disconnectedCallback(){this.shadowRoot&&(this.shadowRoot.textContent="")}}var Z=function(r){if(p.some((e=>e[0]===r)))return console.error('Cannot define an exposed state that is also a proxy property: "'.concat(r,'" in ').concat(e)),"continue";Object.defineProperty(t.prototype,r,{get(){return this.$$tplStateStore.getValue(r)},set(e){var t;null===(t=this.$$tplStateStore)||void 0===t||t.updateValue(r,e,"replace")},enumerable:!0})};for(var I of b)Z(I);var O=function(e,r){Object.defineProperty(t.prototype,e,{get(){var t;return this.$$getElementByRef(r.ref)[null!==(t=r.refProperty)&&void 0!==t?t:e]},set(t){var n,a,o=null===(n=this.$$getElementByRef)||void 0===n?void 0:n.call(this,r.ref);o&&(o[null!==(a=r.refProperty)&&void 0!==a?a:e]=t)},enumerable:!0})};for(var[P,_]of p)O(P,_);var A=function(e,r){Object.defineProperty(t.prototype,e,{value(){var t;this.$$getElementByRef(r.ref)[null!==(t=r.refMethod)&&void 0!==t?t:e](...arguments)},enumerable:!0})};for(var[T,C]of w)A(T,C);customElements.define(e,t)}}get(e){return(0,g.Z)(this,ct).get(e)}};function ut(e,t,r){var{tplStateStoreId:n,tplStateStoreMap:a}=e;if(!n)throw new Error('Using "'.concat(t,'" outside of a custom template').concat(null!=r?r:""));var o=a.get(n);if(!o)throw new Error('Template state store is not found when using "'.concat(t,'"').concat(null!=r?r:"",".\nThis is a bug of Brick Next, please report it."));return o}function pt(e,t,r){var n=ut(e,t,r).hostBrick.element;if(!n)throw new Error('Template host element is gone when using "'.concat(t,'"').concat(null!=r?r:"",".\nThis is a bug of Brick Next, please report it."));return n}function dt(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function ft(e){return e&&e.sensitive?"":"i"}function vt(e,t,r){return function(e,t,r){void 0===r&&(r={});for(var n=r.strict,a=void 0!==n&&n,o=r.start,i=void 0===o||o,s=r.end,c=void 0===s||s,l=r.encode,u=void 0===l?function(e){return e}:l,p=r.delimiter,d=void 0===p?"/#?":p,f=r.endsWith,v="[".concat(dt(void 0===f?"":f),"]|$"),h="[".concat(dt(d),"]"),m=i?"^":"",g=0,y=e;g<y.length;g++){var b=y[g];if("string"==typeof b)m+=dt(u(b));else{var w=dt(u(b.prefix)),E=dt(u(b.suffix));if(b.pattern)if(t&&t.push(b),w||E)if("+"===b.modifier||"*"===b.modifier){var S="*"===b.modifier?"?":"";m+="(?:".concat(w,"((?:").concat(b.pattern,")(?:").concat(E).concat(w,"(?:").concat(b.pattern,"))*)").concat(E,")").concat(S)}else m+="(?:".concat(w,"(").concat(b.pattern,")").concat(E,")").concat(b.modifier);else"+"===b.modifier||"*"===b.modifier?m+="((?:".concat(b.pattern,")").concat(b.modifier,")"):m+="(".concat(b.pattern,")").concat(b.modifier);else m+="(?:".concat(w).concat(E,")").concat(b.modifier)}}if(c)a||(m+="".concat(h,"?")),m+=r.endsWith?"(?=".concat(v,")"):"$";else{var k=e[e.length-1],Z="string"==typeof k?h.indexOf(k[k.length-1])>-1:void 0===k;a||(m+="(?:".concat(h,"(?=").concat(v,"))?")),Z||(m+="(?=".concat(h,"|").concat(v,")"))}return new RegExp(m,ft(r))}(function(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:r,value:e[r++]});else{var a=1,o="";if("?"===e[s=r+1])throw new TypeError('Pattern cannot start with "?" at '.concat(s));for(;s<e.length;)if("\\"!==e[s]){if(")"===e[s]){if(0==--a){s++;break}}else if("("===e[s]&&(a++,"?"!==e[s+1]))throw new TypeError("Capturing groups are not allowed at ".concat(s));o+=e[s++]}else o+=e[s++]+e[s++];if(a)throw new TypeError("Unbalanced pattern at ".concat(r));if(!o)throw new TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:o}),r=s}else{for(var i="",s=r+1;s<e.length;){var c=e.charCodeAt(s);if(!(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||95===c))break;i+=e[s++]}if(!i)throw new TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:i}),r=s}else t.push({type:"CLOSE",index:r,value:e[r++]});else t.push({type:"OPEN",index:r,value:e[r++]});else t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});else t.push({type:"MODIFIER",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,a=void 0===n?"./":n,o="[^".concat(dt(t.delimiter||"/#?"),"]+?"),i=[],s=0,c=0,l="",u=function(e){if(c<r.length&&r[c].type===e)return r[c++].value},p=function(e){var t=u(e);if(void 0!==t)return t;var n=r[c],a=n.type,o=n.index;throw new TypeError("Unexpected ".concat(a," at ").concat(o,", expected ").concat(e))},d=function(){for(var e,t="";e=u("CHAR")||u("ESCAPED_CHAR");)t+=e;return t};c<r.length;){var f=u("CHAR"),v=u("NAME"),h=u("PATTERN");if(v||h){var m=f||"";-1===a.indexOf(m)&&(l+=m,m=""),l&&(i.push(l),l=""),i.push({name:v||s++,prefix:m,suffix:"",pattern:h||o,modifier:u("MODIFIER")||""})}else{var g=f||u("ESCAPED_CHAR");if(g)l+=g;else if(l&&(i.push(l),l=""),u("OPEN")){m=d();var y=u("NAME")||"",b=u("PATTERN")||"",w=d();p("CLOSE"),i.push({name:y||(b?s++:""),pattern:y&&!b?o:b,prefix:m,suffix:w,modifier:u("MODIFIER")||""})}else p("END")}}return i}(e,r),t,r)}function ht(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,a=r.exec(e.source);a;)t.push({name:a[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),a=r.exec(e.source);return e}(e,t):Array.isArray(e)?function(e,t,r){var n=e.map((function(e){return ht(e,t,r).source}));return new RegExp("(?:".concat(n.join("|"),")"),ft(r))}(e,t,r):vt(e,t,r)}var mt=new Map,gt=1e4,yt=0;function bt(e,t){var{path:r,exact:n=!1,strict:a=!1,sensitive:o=!0}=t;return(Array.isArray(r)?r:[r]).reduce(((t,r)=>{if(t)return t;var{regexp:i,keys:s}=function(e,t){var r="".concat(t.end).concat(t.strict).concat(t.sensitive),n=mt.get(r);n||mt.set(r,n=new Map);var a=n.get(e);if(a)return a;var o=[],i={regexp:ht(e,o,t),keys:o};return yt<gt&&(n.set(e,i),yt++),i}(r,{end:n,strict:a,sensitive:o}),c=i.exec(e);if(!c)return null;var[l,...u]=c,p=e===l;return n&&!p?null:{path:r,url:"/"===r&&""===l?"/":l,isExact:p,params:s.reduce(((e,t,r)=>(e[t.name]=u[r],e)),{})}}),null)}function wt(){return(wt=(0,o.Z)((function*(e,t){for(var r of e){if("string"!=typeof r.path)throw console.error("Invalid route with invalid path:",r),new Error("Invalid route with invalid type of path: ".concat(typeof r.path));var n=r.path.replace(/^\$\{APP.homepage\}/,t.app.homepage),a=bt(t.location.pathname,{path:n,exact:r.exact});if(a&&(yield He(r,t)))return t.app.noAuthGuard||r.public||bo()?{match:a,route:r}:"unauthenticated"}return"missed"}))).apply(this,arguments)}var Et,St=Symbol.for("tpl.asyncComputedPropsFromHost"),kt=Symbol.for("tpl.stateStoreId"),Zt=Symbol.for("tpl.externalForEachItem"),It=r(6666),Ot=new Set,Pt=function(e){return e.REQUEST_FAILED="REQUEST_FAILED",e.SOMETHING_WENT_WRONG="SOMETHING_WENT_WRONG",e.LOGIN_TIMEOUT_MESSAGE="LOGIN_TIMEOUT_MESSAGE",e.NETWORK_ERROR="NETWORK_ERROR",e}({}),_t={[Pt.REQUEST_FAILED]:"Request Failed",[Pt.SOMETHING_WENT_WRONG]:"Something went wrong!",[Pt.LOGIN_TIMEOUT_MESSAGE]:"You haven't logged in or your login session has expired. Login right now?",[Pt.NETWORK_ERROR]:"Network error, please check your network."},At={[Pt.REQUEST_FAILED]:"请求失败",[Pt.SOMETHING_WENT_WRONG]:"出现了一些问题！",[Pt.LOGIN_TIMEOUT_MESSAGE]:"您还未登录或登录信息已过期，现在重新登录？",[Pt.NETWORK_ERROR]:"网络错误，请检查您的网络连接。"},Tt="core/runtime",Ct={en:_t,zh:At};function Rt(e){ga([e]).then((()=>{Et=document.createElement(e)}),(e=>{console.error("Load dialog service failed:",e)}))}var Mt=Object.freeze({show:function(e){return Et?Et.resolve(e):"confirm"===e.type?confirm(e.content)?new Promise((e=>setTimeout((()=>{e()}),1))):new Promise(((e,t)=>setTimeout((()=>{t()}),1))):(alert(e.content),new Promise((e=>setTimeout((()=>{e()}),1e3))))}});function xt(e){if(e instanceof Event&&e.target instanceof HTMLScriptElement)return e.target.src;if(e instanceof ke.HttpFetchError)return w.i18n.t("".concat(Tt,":").concat(Pt.NETWORK_ERROR));if(e instanceof ke.HttpResponseError&&e.responseJson){if("string"==typeof e.responseJson.error)return e.responseJson.error;if("string"==typeof e.responseJson.msg)return e.responseJson.msg}return null==e?"Unknown error":e.toString()}function Lt(e){return e instanceof ke.HttpResponseError&&401===e.response.status&&!!e.responseJson&&100003===e.responseJson.code}var Bt,Nt,Ut=!1;function jt(e){if(!(e instanceof ke.HttpAbortError)){if(Lt(e)&&!window.NO_AUTH_GUARD){if(Ut)return;return Ut=!0,void Mt.show({type:"confirm",content:w.i18n.t("".concat(Tt,":").concat(Pt.LOGIN_TIMEOUT_MESSAGE))}).then((()=>{var e,t;e=va().getFeatureFlags()["sso-enabled"],(t=be()).push(e?"/sso-auth/login":"/auth/login",{from:(0,a.Z)((0,a.Z)({},t.location),{},{state:void 0})}),Ut=!1}),(()=>{Ut=!1}))}console.error(e);var t=xt(e);t!==Bt&&(Bt=t,Mt.show({type:"error",title:w.i18n.t("".concat(Tt,":").concat(Pt.REQUEST_FAILED)),content:t,contentStyle:{whiteSpace:"pre-wrap"}}).then((()=>{Bt=void 0})))}}function $t(e){ga([e]).then((()=>{Nt=document.createElement(e)}),(e=>{console.error("Load notification service failed:",e)}))}var Ft=Object.freeze({show:function(e){Nt?Nt.resolve(e):alert(e.message)}});function Dt(e,t,r){t&&Object.entries(t).forEach((t=>{var[n,a]=t,o=Ht(a,r,{element:e});for(var i of(e.addEventListener(n,o),e.$$listeners||(e.$$listeners=[]),e.$$listeners.push([n,o]),e.$$eventListeners||(e.$$eventListeners=[]),[].concat(a)))e.$$eventListeners.push([n,null,i])}))}function Kt(e){return"string"==typeof e.action}function Wt(e){return"string"==typeof e.useProvider}function Vt(e){return!(!e.target&&!e.targetRef||!e.method&&!e.properties)}function Ht(e,t,r){return function(n){for(var o of[].concat(e))if(Ge(o,(0,a.Z)((0,a.Z)({},t),{},{event:n})))if(Kt(o)){var[i,s]=o.action.split(".");switch(o.action){case"history.push":case"history.replace":case"history.pushQuery":case"history.replaceQuery":case"history.pushAnchor":case"history.block":case"history.goBack":case"history.goForward":case"history.reload":case"history.unblock":Yt(n,s,o.args,o.callback,t);break;case"window.open":Xt(n,o.args,t);break;case"location.reload":case"location.assign":rr(n,s,o.args,t);break;case"localStorage.setItem":case"localStorage.removeItem":case"sessionStorage.setItem":case"sessionStorage.removeItem":nr(n,i,s,o.args,t);break;case"event.preventDefault":n.preventDefault();break;case"console.log":case"console.error":case"console.warn":case"console.info":ar(n,s,o.args,t);break;case"message.success":case"message.error":case"message.info":case"message.warn":or(n,s,o.args,t);break;case"handleHttpError":jt(n.detail);break;case"context.assign":case"context.replace":case"context.refresh":case"context.load":er(n,s,o.args,o.callback,t);break;case"state.update":case"state.refresh":case"state.load":tr(n,s,o.args,o.callback,t);break;case"tpl.dispatchEvent":var[c,l]=sr(o.args,t,n);pt(t,o.action,": ".concat(c)).dispatchEvent(new CustomEvent(c,l));break;case"theme.setDarkTheme":case"theme.setLightTheme":N("theme.setDarkTheme"===o.action?"dark":"light");break;case"theme.setTheme":var[u]=sr(o.args,t,n);N(u);break;case"mode.setDashboardMode":case"mode.setDefaultMode":K("mode.setDashboardMode"===o.action?"dashboard":"default");break;default:console.error("unknown event listener action:",o.action)}}else Wt(o)?qt(n,o,t,r):Vt(o)?zt(n,o,t,r):console.error("unknown event handler:",o)}}function qt(e,t,r,n){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,o.Z)((function*(e,t,r,n){try{Jt(e,yield je(t.useProvider),t,"saveAs"!==t.method?"resolve":"saveAs",r,n)}catch(e){console.error(xt(e))}}))).apply(this,arguments)}function zt(e,t,r,n){var o=[],i=t.target,s=t.targetRef,c=i;if(("string"==typeof i?(0,u.isEvaluable)(i):Ga(i))&&(c=ro(i,(0,a.Z)((0,a.Z)({},r),{},{event:e}))),"string"==typeof c)if("_self"===c)o.push(n.element);else if(t.multiple)o=Array.from(document.querySelectorAll(c));else{var l=document.querySelector(c);null!==l&&o.push(l)}else if(c)c instanceof HTMLElement?o.push(c):console.error("unexpected target:",c);else if(s){var p=s;("string"==typeof s?(0,u.isEvaluable)(s):Ga(s))&&(p=ro(s,(0,a.Z)((0,a.Z)({},r),{},{event:e})));var d=[].concat(p),f=pt(r,"targetRef",": ".concat(d.join(", ")));o.push(...d.map((e=>{var t;return null===(t=f.$$getElementByRef)||void 0===t?void 0:t.call(f,e)})).filter(Boolean))}0!==o.length?function(e){return!!e.method}(t)?o.forEach((a=>{Jt(e,a,t,t.method,r,n,{useEventAsDefault:!0})})):function(e){return!!e.properties}(t)&&at(o,t.properties,(0,a.Z)((0,a.Z)({},r),{},{event:e})):console.error("target not found:",i||s)}function Jt(e,t,r,n,a,o,i){return Qt.apply(this,arguments)}function Qt(){return Qt=(0,o.Z)((function*(e,t,r,n,i,s,c){var l;if("function"==typeof t[n]){var u=function(){var a=(0,o.Z)((function*(){var a=sr(r.args,i,e,c);return Wt(r)&&(a=yield Ce(r.useProvider,a,n)),t[n](...a)}));return function(){return a.apply(this,arguments)}}();if(r.callback){var p,d=ir(r.callback,i,s),f={progress:d("progress"),success:d("success"),error:d("error"),finally:d("finally")};if(Wt(r)&&(p=ro(r.poll,(0,a.Z)((0,a.Z)({},i),{},{event:e}))),null!==(l=p)&&void 0!==l&&l.enabled)!function(e,t,r){var n,{progress:a,success:i,error:s,finally:c}=t,{interval:l,leadingRequestDelay:u,continueOnError:p,delegateLoadingBar:d,expectPollEnd:f,expectPollStopImmediately:v}=r,h=ya();function m(){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)((function*(){var t;Ot.delete(n);try{if(!(t=null==v?void 0:v())){var r=yield e();(t=(null==v?void 0:v())||h!==ya())||(null==a||a(r),null!=f&&f(r)?(d&&window.dispatchEvent(new Event("request.end")),null==i||i(r),null==c||c()):y(null!=l?l:3e3))}}catch(e){(t=(null==v?void 0:v())||h!==ya())||(null==s||s(e),p?y(null!=l?l:3e3):null==c||c())}finally{d&&t&&window.dispatchEvent(new Event("request.end"))}}))).apply(this,arguments)}function y(e){n=setTimeout(m,e),Ot.add(n)}y(null!=u?u:0),d&&window.dispatchEvent(new Event("request.start"))}(u,f,p);else try{var v=yield u();f.success(v)}catch(e){f.error(e)}finally{f.finally()}}else u()}else console.error("target has no method:",{target:t,method:n})})),Qt.apply(this,arguments)}function Yt(e,t,r,n,a){var o=0,i=!1,s=t;switch(t){case"push":case"replace":case"pushQuery":case"replaceQuery":case"pushAnchor":o=2,i=!0;break;case"reload":i=!0;break;case"block":o=1,s="setBlockMessage"}var c=[];if(o>0&&((c=sr(r,a,e,{useEventDetailAsDefault:!0})).length=o),i&&n){var l=ir(n,a,void 0);c.push((e=>{l(e?"error":"success")({blocked:e}),l("finally")({blocked:e})}))}be()[s](...c)}function Xt(e,t,r){var[n,a,o]=sr(t,r,e);window.open(n,a||"_self",o)}function er(e,t,r,n,a){var[o,i]=sr(r,a,e);a.ctxStore.updateValue(o,i,t,n,a)}function tr(e,t,r,n,a){var[o,i]=sr(r,a,e);ut(a,"state.".concat(t),": ".concat(o)).updateValue(o,i,"update"===t?"replace":t,n,a)}function rr(e,t,r,n){if("assign"===t){var[a]=sr(r,n,e);location.assign(a)}else location[t]()}function nr(e,t,r,n,a){var o="localStorage"===t?localStorage:sessionStorage,[i,s]=sr(n,a,e);"setItem"===r?void 0!==s&&o.setItem(i,JSON.stringify(s)):o.removeItem(i)}function ar(e,t,r,n){console[t](...sr(r,n,e,{useEventAsDefault:!0}))}function or(e,t,r,n){var a=sr(r,n,e,{useEventAsDefault:!0});Ft.show({type:t,message:a[0]})}function ir(e,t,r){return function(n){return function(a){var o=null==e?void 0:e[n];if(o)try{var i=new CustomEvent("callback.".concat(n),{detail:a});Ht(o,t,r)(i)}catch(e){console.error(e)}else"error"===n&&console.error("Unhandled callback error:",a)}}}function sr(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Array.isArray(e)?ro(e,(0,a.Z)((0,a.Z)({},t),{},{event:r})):n.useEventAsDefault?[r]:n.useEventDetailAsDefault?[r.detail]:[]}class cr{constructor(e,t){(0,It.Z)(this,"type",void 0),(0,It.Z)(this,"data",new Map),(0,It.Z)(this,"changeEventType",void 0),(0,It.Z)(this,"pendingStack",[]),(0,It.Z)(this,"hostBrick",void 0),this.type=e,this.changeEventType="FORM_STATE"===this.type?"formstate.change":"STATE"===this.type?"state.change":"context.change",this.hostBrick=t}getValue(e){var t;return null===(t=this.data.get(e))||void 0===t?void 0:t.value}updateValue(e,t,r,n,o){var i=this.data.get(e);if(!i)throw new Error("".concat(this.type," '").concat(e,"' is not defined"));if("refresh"!==r&&"load"!==r)"replace"===r?i.value=t:(0,p.isObject)(i.value)?Object.assign(i.value,t):(console.warn('Non-object current value of "'.concat(this.type,".").concat(e,'" for "context.assign", try "context.replace" instead.')),i.value=t),i.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:i.value}));else{if(!i.load)throw new Error("You can not ".concat(r,' "').concat(this.type,".").concat(e,'" which has no resolve'));var s;if("load"===r&&(i.loaded?s=Promise.resolve(i.value):i.loading&&(s=i.loading)),s||(s=i.loading=i.load((0,a.Z)({cache:"load"===r?"default":"reload"},t))).then((e=>{i.loaded=!0,i.value=e,i.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:i.value}))}),(e=>{null!=n&&n.error||jt(e)})),n){var c=ir(n,o);s.then((e=>{c("success")({value:e}),c("finally")()}),(e=>{c("error")(e),c("finally")()}))}}}define(e,t,r){if(Array.isArray(e)&&e.length>0){var n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CTX",n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CTX",r=new Map;for(var n of e){var a=(0,s.collectMemberUsage)([n.if,n.value,n.resolve],t);r.set(n,a)}return r}(e,r),a=new Map;for(var i of Array.from(n.keys()).map((e=>e.name))){var c;a.set(i,(null!==(c=a.get(i))&&void 0!==c?c:0)+1)}var l=Array.from(n.values()).some((e=>e.hasNonStaticUsage)),u=new WeakSet,p=new Map,d=new Map([...new Set(e.map((e=>e.name)))].map((e=>[e,new Promise(((t,r)=>{p.set(e,{resolve:t,reject:r})}))]))),f=function(){var e=(0,o.Z)((function*(e){var r;u.add(e);var o=yield t(e);n.delete(e);var i=null!==(r=a.get(e.name))&&void 0!==r?r:0;if(o){if(p.get(e.name).resolve(),a.delete(e.name),0===i)throw new Error("Duplicated context defined: ".concat(e.name))}else 1===i?(p.get(e.name).resolve(),a.delete(e.name)):a.set(e.name,i-1);yield h()}));return function(t){return e.apply(this,arguments)}}(),v=l;function h(){return m.apply(this,arguments)}function m(){return m=(0,o.Z)((function*(){var e=Array.from(n.entries()).filter(function(e,t){return(r,n)=>t?0===n:![...r[1].usedProperties].some((t=>e.has(t)))}(a,v)).map((e=>e[0])).filter((e=>!u.has(e)));yield Promise.all(e.map(f))})),m.apply(this,arguments)}return{pendingResult:h().then((0,o.Z)((function*(){for(var e of(n.size>0&&(function(e,t){var r=new Map(e),n=new Set(Array.from(r.keys()).map((e=>e.name))),a=()=>{var e=!1;for(var[t,o]of r.entries())[...o.usedProperties].some((e=>n.has(e)))||(r.delete(t),n.delete(t.name),e=!0);e&&a()};if(a(),r.size>0)throw new ReferenceError("Circular ".concat(t," detected: ").concat(Array.from(r.keys()).map((e=>e.name)).join(", ")))}(n,r),v=!0,yield h()),p.values()))e.resolve()}))).catch((e=>{for(var t of p.values())t.reject(e);throw e})),pendingContexts:d}}(e,(e=>this.resolve(e,t,r)),this.type);this.pendingStack.push(n)}}onChange(e,t){var r;null===(r=this.data.get(e))||void 0===r||r.eventTarget.addEventListener(this.changeEventType,t)}waitFor(e){var t=this;return(0,o.Z)((function*(){var r=function*(t){yield Promise.all([...e].map((e=>t.get(e))))};for(var{pendingContexts:n}of t.pendingStack)yield*r(n)}))()}waitForAll(){var e=this;return(0,o.Z)((function*(){for(var{pendingResult:t}of e.pendingStack)yield t}))()}resolve(e,t,r){var n=this;return(0,o.Z)((function*(){if(!(yield He(e,t)))return!1;var i,c;if("STATE"===n.type&&r&&e.expose){var l=yield r;(0,p.hasOwnProperty)(l,e.name)&&(i=l[e.name])}var u=!1;if(void 0===i){if(e.resolve){var d=(0,a.Z)({transform:"value"},e.resolve);if(yield He(e.resolve,t))c=function(){var e=(0,o.Z)((function*(e){return(yield De(d,t,e)).value}));return function(t){return e.apply(this,arguments)}}(),(u=e.resolve.lazy)||(i=yield c());else if(!(0,p.hasOwnProperty)(e,"value"))return!1}c&&!u||void 0===e.value||(i=yield eo(e.value,t))}var f={value:i,eventTarget:new EventTarget,load:c,loaded:!u};if(e.onChange&&f.eventTarget.addEventListener(n.changeEventType,Ht(e.onChange,t)),e.track&&"FORM_STATE"!==n.type){var v=(0,s.strictCollectMemberUsage)(c?e.resolve:e.value,n.type);for(var h of v)n.onChange(h,(()=>{c?n.updateValue(e.name,{cache:"default"},"refresh"):n.updateValue(e.name,ro(e.value,t),"replace")}))}if(n.data.has(e.name))throw new Error("".concat(n.type," '").concat(e.name,"' has already been declared"));return n.data.set(e.name,f),!0}))()}}function lr(e,t,r){var n,{reversedProxies:a,asyncHostProperties:o,externalSlots:s,tplStateStoreId:c,hostBrick:l}=e;if(t&&a){var u=a.properties.get(t);u&&(n=o.then((e=>{var t={};for(var{from:r,to:n}of u){var a=e[r];void 0!==a&&n.refProperty&&(t[n.refProperty]=a)}return t})));var d=a.slots.get(t);if(d&&s){var f=new Map;for(var{from:v,to:h}of d){var m,g,y,b,w=null!==(m=null===(g=s[v])||void 0===g?void 0:g.bricks)&&void 0!==m?m:[];if(w.length){var E=null!==(y=h.refSlot)&&void 0!==y?y:v,S=f.get(E);if(!S){S=[];for(var k=(0,p.hasOwnProperty)(r,E)?r[E].bricks.length+1:1,Z=0;Z<k;Z+=1)S.push([]);f.set(E,S)}var I=null!==(b=h.refPosition)&&void 0!==b?b:-1;S[(0,i.clamp)(I<0?S.length+I:I,0,S.length-1)].push(...(0,p.hasOwnProperty)(l.runtimeContext,"forEachItem")?ur(w,l.runtimeContext.forEachItem):w)}}var O=function(){(0,p.hasOwnProperty)(r,P)||(r[P]={type:"bricks",bricks:[]});var e=r[P];e.bricks=_.flatMap(((t,r)=>r<e.bricks.length?t.concat(e.bricks[r]):t)),0===e.bricks.length&&delete r[P]};for(var[P,_]of f.entries())O()}}return{[St]:n,[kt]:c}}function ur(e,t){return e.map((e=>{var r;return(0,a.Z)((0,a.Z)({},e),{},{[Zt]:t,slots:Object.fromEntries(Object.entries(null!==(r=e.slots)&&void 0!==r?r:{}).map((e=>{var r,[n,a]=e;return[n,"routes"===a.type?{type:"routes",routes:pr(a.routes,t)}:{type:"bricks",bricks:ur(null!==(r=a.bricks)&&void 0!==r?r:[],t)}]})))})}))}function pr(e,t){return e.map((e=>e.type&&"bricks"!==e.type?e:(0,a.Z)((0,a.Z)({},e),{},{bricks:ur(e.bricks,t)})))}var dr=["properties","slots","children"];function fr(e,t){function r(e){return(0,p.isObject)(e)?Array.isArray(e)?e.map(r):Object.fromEntries(Object.entries(e).map((e=>{var[t,a]=e;return(0,p.isObject)(a)&&"useBrick"===t?Array.isArray(a)?[t,a.map(n)]:[t,n(a)]:[t,r(a)]})).concat(Object.getOwnPropertySymbols(e).map((t=>[t,e[t]])))):e}function n(e){var{properties:o,slots:i,children:s}=e,c=(0,f.Z)(e,dr),l=Ar(s,i),u=Object.fromEntries(Object.entries(null!=l?l:{}).map((e=>{var t,[r,a]=e;return[r,{type:"bricks",bricks:(null!==(t=a.bricks)&&void 0!==t?t:[]).map(n)}]})));return(0,a.Z)((0,a.Z)({},c),{},{properties:r(o),slots:u},lr(t,c.ref,u))}return r(e)}var vr=["slots","children"],hr=["properties","slots","children"];function mr(e,t,r,n){var o=(0,i.uniqueId)("tpl-state-"),s=(0,a.Z)((0,a.Z)({},r.runtimeContext),{},{tplStateStoreId:o});delete s.forEachItem;var c=new cr("STATE",r);s.tplStateStoreMap.set(o,c),s.tplStateStoreScope&&s.tplStateStoreScope.push(c);var{bricks:l,proxy:u,state:p,contracts:d}=lt.get(e);!function(e){_e(e,Pe)}(d),c.define(p,s,n);var{slots:v,children:h}=t,m=(0,f.Z)(t,vr),g=(0,a.Z)((0,a.Z)({},m),{},{brick:e});r.tplHostMetadata={internalBricksByRef:new Map,tplStateStoreId:o,proxy:u};var y={properties:new Map,slots:new Map};if(null!=u&&u.properties)for(var[b,w]of Object.entries(u.properties)){var E=y.properties.get(w.ref);E||(E=[],y.properties.set(w.ref,E)),E.push({from:b,to:w})}if(null!=u&&u.slots)for(var[S,k]of Object.entries(u.slots)){var Z=y.slots.get(k.ref);Z||(Z=[],y.slots.set(k.ref,Z)),Z.push({from:S,to:k})}var I={reversedProxies:y,asyncHostProperties:n,externalSlots:Ar(h,v),tplStateStoreId:o,hostBrick:r};return g.slots={"":{type:"bricks",bricks:l.map((e=>gr(e,I)))}},g}function gr(e,t){null===e.if&&delete e.if;var{properties:r,slots:n,children:o}=e,i=(0,f.Z)(e,hr),s=Ar(o,n),c=Object.fromEntries(Object.entries(null!=s?s:{}).map((e=>{var r,[n,a]=e;return[n,{type:"bricks",bricks:(null!==(r=a.bricks)&&void 0!==r?r:[]).map((e=>gr(e,t)))}]})));return(0,a.Z)((0,a.Z)({},i),{},{properties:fr(r,t),slots:c},lr(t,i.ref,c))}var yr=function(e){return e[e.ROOT=1]="ROOT",e[e.BRICK=2]="BRICK",e}({}),br=["blockingList","node","menuRequests","hasTrackingControls"];function wr(e,t,r,n,a){return Er.apply(this,arguments)}function Er(){return Er=(0,o.Z)((function*(e,t,r,n,o){var i=yield function(e,t){return wt.apply(this,arguments)}(t,r),s={blockingList:[],menuRequests:[]};switch(i){case"missed":break;case"unauthenticated":s.unauthenticated=!0;break;default:var c=s.route=i.route,l=(0,a.Z)((0,a.Z)({},r),{},{match:i.match});switch(l.ctxStore.define(c.context,l),l.pendingPermissionsPreCheck.push(co(c,l)),c.type){case"redirect":var u;if("string"!=typeof(u="string"==typeof c.redirect?yield eo(c.redirect,l):(yield De((0,a.Z)({transform:"redirect"},c.redirect),l)).redirect))throw console.error("Unexpected redirect result:",u),new Error("Unexpected type of redirect result: ".concat(typeof u));s.redirect={path:u};break;case"routes":s.menuRequests.push(Pr(c.menu,l)),_r(s,yield wr(e,c.routes,l,n,o));break;default:s.menuRequests.push(Pr(c.menu,l)),_r(s,yield Sr(e,c.bricks,l,n,o))}}return s})),Er.apply(this,arguments)}function Sr(e,t,r,n,a,o,i){return kr.apply(this,arguments)}function kr(){return(kr=(0,o.Z)((function*(e,t,r,n,a,o,i){var s={blockingList:[],menuRequests:[]};return(yield Promise.all(t.map(((t,i)=>Zr(e,t,r,n,a,i,o&&new Map(o)))))).forEach(((t,r)=>{!i&&t.hasTrackingControls&&n.memoizeControlNode(a,r,t.node,e),_r(s,t)})),s}))).apply(this,arguments)}function Zr(e,t,r,n,a,o){return Ir.apply(this,arguments)}function Ir(){return Ir=(0,o.Z)((function*(e,t,r,n,s,c){var l,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Map,d={blockingList:[],menuRequests:[]};if(!t.brick)return t.template?console.error("Legacy templates are dropped in v3:",t):console.error("Invalid brick:",t),d;var f=t[kt],h=(0,a.Z)((0,a.Z)({},r),{},{tplStateStoreId:f});(0,p.hasOwnProperty)(t,Zt)&&(h.forEachItem=t[Zt]);var{context:m}=t;if(Array.isArray(m)&&m.length>0){var g=ot(h);it(g,"Defining context on bricks","check your brick:",t),g||h.ctxStore.define(m,h)}if(h.pendingPermissionsPreCheck.push(co(t,h)),!(yield function(e,t){return Je.apply(this,arguments)}(t,h)))return d;var y=t.brick;if(y.startsWith(":")){!function(e){if(":forEach"!==e&&":if"!==e&&":switch"!==e)throw new Error('Unknown storyboard control node: "'.concat(e,'"'))}(y);var{dataSource:b}=t,w=function(){var r=(0,o.Z)((function*(){var r,a=yield eo(b,h),o=":forEach"===y?"":":switch"===y?String(a):a?"":"else",i=Ar(t.children,t.slots),c=i&&(0,p.hasOwnProperty)(i,o)&&(null===(r=i[o])||void 0===r?void 0:r.bricks);if(!Array.isArray(c))return d;switch(y){case":forEach":return Array.isArray(a)?function(e,t,r,n,a,o,i){return Or.apply(this,arguments)}(e,a,c,h,n,s,u):d;case":if":case":switch":return Sr(e,c,h,n,s,u,!0)}}));return function(){return r.apply(this,arguments)}}(),E=yield w(),{contextNames:S,stateNames:k}=tt(b);if(S||k){E.hasTrackingControls=!0;var Z=0,I=function(){var t=(0,o.Z)((function*(){var t=++Z,r=yield w();r.blockingList.push(...[...h.tplStateStoreMap.values()].map((e=>e.waitForAll())),...h.pendingPermissionsPreCheck),yield Promise.all(r.blockingList),Z===t&&n.rerenderControlNode(s,c,r.node,e)}));return function(){return t.apply(this,arguments)}}(),O=(0,i.debounce)(I);if(S)for(var P of S)h.ctxStore.onChange(P,O);if(k)for(var _ of k)ut(h,"STATE",': "'.concat(b,'"')).onChange(_,O)}return E}/\.tpl-/.test(y)&&!lt.get(y)&&(yield(0,v.loadBricksImperatively)([y],ma()));var A=function(e,t){if(!e.includes(".")&&e.startsWith("tpl-")&&t){var r="".concat(t,".").concat(e);if(lt.get(r))return r}return!!lt.get(e)&&e}(y,null===(l=h.app)||void 0===l?void 0:l.id);if(A){var T,C=null!==(T=u.get(A))&&void 0!==T?T:0;if(C>=10)throw new Error('Maximum custom template stack overflowed: "'.concat(A,'"'));u.set(A,C+1)}else y.includes("-")&&!customElements.get(y)&&d.blockingList.push((0,v.enqueueStableLoadBricks)([y],ma()));var R={tag:yr.BRICK,type:A||y,return:e,slotId:s,events:t.events,runtimeContext:h,portal:t.portal,iid:t.iid,ref:t.ref};d.node=R;var M=[],x=[],L=function(){var e=(0,o.Z)((function*(){R.properties=yield function(e,t,r){return rt.apply(this,arguments)}(t.properties,h,x);var e=t[St];if(e){var r;null!==(r=R.properties)&&void 0!==r||(R.properties={});var n=yield e;for(var[a,o]of Object.entries(n))R.properties[a]=o}return function(e,t){var r=function(t){var r=()=>{e.element&&at(e.element,{[t.propName]:t.propValue},e.runtimeContext)};if(t.contextNames)for(var n of t.contextNames)e.runtimeContext.ctxStore.onChange(n,r);if(t.stateNames){var a=ut(e.runtimeContext,"STATE",': "'.concat(t.propValue,'"'));for(var o of t.stateNames)a.onChange(o,r)}};for(var n of t)r(n)}(R,x),R.properties}));return function(){return e.apply(this,arguments)}}(),B=L();M.push(B),n.registerBrickLifeCycle(R,t.lifeCycle);var N,U=t;A&&(U=mr(A,t,R,B)),U.portal&&(R.slotId=void 0),A?delete(N=(0,a.Z)({},h)).forEachItem:N=h;var j=function(){var e=(0,o.Z)((function*(){var e=Ar(U.children,U.slots);if(e){var t=yield Promise.all(Object.entries(e).map((e=>{var[t,r]=e;return"routes"!==r.type?Sr(R,r.bricks,N,n,t,u):wr(R,r.routes,N,n,t)}))),r=(0,a.Z)((0,a.Z)({},d),{},{node:void 0,blockingList:[]});for(var o of t)_r(r,o);r.node&&(R.child=r.node),_r(d,(0,a.Z)((0,a.Z)({},r),{},{node:void 0}))}}));return function(){return e.apply(this,arguments)}}();return M.push(j()),yield Promise.all(M),d})),Ir.apply(this,arguments)}function Or(){return(Or=(0,o.Z)((function*(e,t,r,n,o,i,s){var c={blockingList:[],menuRequests:[]},l=yield Promise.all(t.map(((t,c)=>Promise.all(r.map(((r,l)=>Zr(e,r,(0,a.Z)((0,a.Z)({},n),{},{forEachItem:t}),o,i,c*l,s&&new Map(s))))))));for(var u of l.flat())_r(c,u);return c}))).apply(this,arguments)}function Pr(e,t){if(e){if("brick"===e.type)throw console.error("Set menu with brick is dropped in v3:",e),new Error("Set menu with brick is dropped in v3");if("resolve"!==e.type)return eo(e,t);console.warn("Set menu with resolve is not supported in v3 yet:",e)}}function _r(e,t){var{blockingList:r,node:n,menuRequests:a,hasTrackingControls:o}=t,i=(0,f.Z)(t,br);if(e.blockingList.push(...r),e.menuRequests.push(...a),n)if(e.node){for(var s=e.node;s.sibling;)s=s.sibling;s.sibling=n}else e.node=n;Object.assign(e,i)}function Ar(e,t){var r=t;if(Array.isArray(e)&&!r)for(var n of(r={},e)){var a,o=null!==(a=n.slot)&&void 0!==a?a:"";(0,p.hasOwnProperty)(r,o)||(r[o]={type:"bricks",bricks:[]}),r[o].bricks.push(n)}return r}function Tr(e){var t,{ref:r,runtimeContext:n,element:a}=e;if(r&&n.tplStateStoreId){var{hostBrick:o}=ut(n,"bindTemplateProxy"),i=o.tplHostMetadata;i.internalBricksByRef.set(r,e);var s=null===(t=i.proxy)||void 0===t?void 0:t.events;if(s){var c=function(e){if(u.ref===r){var t,n,i,s=t=>{t.bubbles&&t.stopPropagation(),o.element.dispatchEvent(new CustomEvent(e,{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}))},c=null!==(t=u.refEvent)&&void 0!==t?t:e;a.addEventListener(c,s),null!==(i=(n=a).$$proxyListeners)&&void 0!==i||(n.$$proxyListeners=[]),a.$$proxyListeners.push([c,s])}};for(var[l,u]of Object.entries(s))c(l)}}}function Cr(e){var{ref:t,runtimeContext:r,element:n}=e;if(r.tplStateStoreId&&t){var{hostBrick:a}=ut(r,"unbindTemplateProxy"),o=a.tplHostMetadata;for(var[i,s]of(o.internalBricksByRef.delete(t),null!==(c=n.$$proxyListeners)&&void 0!==c?c:[])){var c;n.removeEventListener(i,s)}delete n.$$proxyListeners}}function Rr(e){e.innerHTML=""}function Mr(e,t){for(var r=e.child,n=[];r;){var a=r.type;a.includes("-")&&!customElements.get(a)&&console.error("Undefined custom element: ".concat(a)),"basic-bricks.script-brick"===a&&console.warn("`basic-bricks.script-brick` is deprecated, please take caution when using it");var o=t&&r===e.child?t:document.createElement(a);if(r.element=o,r.slotId&&o.setAttribute("slot",r.slotId),r.iid&&(o.dataset.iid=r.iid),nt(o,r.properties),Dt(o,r.events,r.runtimeContext),r.tplHostMetadata&&(o.$$tplStateStore=ut({tplStateStoreId:r.tplHostMetadata.tplStateStoreId,tplStateStoreMap:r.runtimeContext.tplStateStoreMap},"mount")),Tr(r),r.portal?n.push(o):r.return&&(r.return.childElements||(r.return.childElements=[]),r.return.childElements.push(o)),r.child)r=r.child;else if(r.sibling)r=r.sibling;else{for(var i,s=r.return;s;){var c;if(s.childElements)s.tag===yr.ROOT?(null===(c=s.container)||void 0===c||c.append(...s.childElements),n.length>0&&("function"==typeof s.createPortal?s.createPortal():s.createPortal).append(...n)):s.element.append(...s.childElements),s.childElements=void 0;if(s.sibling)break;s=s.return}r=null===(i=s)||void 0===i?void 0:i.sibling}}}var xr,Lr=["onMount","onUnmount","onMediaChange","onScrollIntoView"],Br=["onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload"],Nr=new WeakMap,Ur=new WeakMap,jr=new WeakMap,$r=new WeakMap,Fr=new WeakSet,Dr=new WeakSet,Kr=new WeakSet,Wr=new WeakSet;class Vr{constructor(e){(0,we.Z)(this,Wr),(0,we.Z)(this,Kr),(0,we.Z)(this,Dr),(0,we.Z)(this,Fr),(0,It.Z)(this,"scope",void 0),(0,m.Z)(this,Nr,{writable:!0,value:{onBeforePageLoad:[],onPageLoad:[],onPageLeave:[],onBeforePageLeave:[],onAnchorLoad:[],onAnchorUnload:[],onMediaChange:[],onScrollIntoView:[],onMount:[],onUnmount:[]}}),(0,m.Z)(this,Ur,{writable:!0,value:new Map}),(0,m.Z)(this,jr,{writable:!0,value:void 0}),(0,m.Z)(this,$r,{writable:!0,value:void 0}),this.scope=e}registerBrickLifeCycle(e,t){if(t){var r=[...Lr,..."page"===this.scope?Br:[]];for(var n of r){var a=t[n];a&&(0,g.Z)(this,Nr)[n].push({brick:e,handlers:a})}(0,i.isEmpty)(t.useResolves)||console.error("`lifeCycle.useResolves` is dropped in v3:",t)}}memoizeControlNode(e,t,r,n){(0,g.Z)(this,$r)||(0,Se.Z)(this,$r,new WeakMap);var a="".concat(null!=e?e:"",".").concat(t),o=(0,g.Z)(this,$r).get(n);o||(o=new Map,(0,g.Z)(this,$r).set(n,o)),o.set(a,{node:r,last:Jr(r),lastNormal:Qr(r),lastPortal:Yr(r)})}rerenderControlNode(e,t,r,n){var a,o,i,s,c,l="".concat(null!=e?e:"",".").concat(t),u=(0,g.Z)(this,$r).get(n).get(l),{node:p,last:d,lastNormal:f,lastPortal:v}=u,h=null!==(a=null==f||null===(o=f.element)||void 0===o?void 0:o.nextSibling)&&void 0!==a?a:null,m=null!==(i=null==v||null===(s=v.element)||void 0===s?void 0:s.nextSibling)&&void 0!==i?i:null,y=Jr(r);u.node=r,u.last=y,u.lastNormal=Qr(r),u.lastPortal=Yr(r);for(var b=n.child;b&&b!==d;){if(b.sibling===p){c=b;break}b=b.sibling}var w=document.createDocumentFragment(),E=document.createDocumentFragment(),S={tag:yr.ROOT,container:w,createPortal:E,child:r};for(b=r;b;)b.return=S,b=b.sibling;var k,Z,I=Xr(p,d);for((0,Ee.Z)(this,Fr,Hr).call(this,I),Mr(S),c?c.sibling=r:n.child=r,y&&(y.sibling=null==d?void 0:d.sibling),b=r;b;)b.return=n,b=b.sibling;if(n.tag===yr.ROOT?null===(k=n.container)||void 0===k||k.insertBefore(w,h):null===(Z=n.element)||void 0===Z||Z.insertBefore(w,h),E.childNodes.length>0){for(var O,P=r;P&&P.return;)P=P.return;if((null===(O=P)||void 0===O?void 0:O.tag)!==yr.ROOT)throw new Error("Cannot find render root node");("function"==typeof P.createPortal?P.createPortal():P.createPortal).insertBefore(E,m)}var _=Xr(r,y);(0,Ee.Z)(this,Dr,qr).call(this,_)}dispose(){for(var e of Object.values((0,g.Z)(this,Nr)))e.length=0;for(var t of(0,g.Z)(this,Ur).values()){for(var r of t)r.disconnect();t.length=0}(0,g.Z)(this,Ur).clear(),(0,g.Z)(this,jr)&&(ae.removeEventListener("change",(0,g.Z)(this,jr)),(0,Se.Z)(this,jr,void 0)),(0,Se.Z)(this,$r,void 0)}dispatchBeforePageLoad(){(0,Ee.Z)(this,Kr,Gr).call(this,"onBeforePageLoad",new CustomEvent("page.beforeLoad"))}dispatchPageLoad(){var e=new CustomEvent("page.load");(0,Ee.Z)(this,Kr,Gr).call(this,"onPageLoad",e),window.dispatchEvent(e)}dispatchBeforePageLeave(e){(0,Ee.Z)(this,Kr,Gr).call(this,"onBeforePageLeave",new CustomEvent("page.beforeLeave",{detail:e}))}dispatchPageLeave(){(0,Ee.Z)(this,Kr,Gr).call(this,"onPageLeave",new CustomEvent("page.leave"))}dispatchAnchorLoad(){var{hash:e}=be().location;e&&"#"!==e?(0,Ee.Z)(this,Kr,Gr).call(this,"onAnchorLoad",new CustomEvent("anchor.load",{detail:{hash:e,anchor:e.substring(1)}})):(0,Ee.Z)(this,Kr,Gr).call(this,"onAnchorUnload",new CustomEvent("anchor.unload"))}initializeScrollIntoView(){for(var{brick:e,handlers:t}of(0,g.Z)(this,Nr).onScrollIntoView)(0,Ee.Z)(this,Wr,zr).call(this,e,t)}initializeMediaChange(){(0,Se.Z)(this,jr,(e=>{(0,Ee.Z)(this,Kr,Gr).call(this,"onMediaChange",new CustomEvent("media.change",{detail:A(e.detail)}))})),ae.addEventListener("change",(0,g.Z)(this,jr))}dispatchOnMount(){(0,Ee.Z)(this,Kr,Gr).call(this,"onMount",new CustomEvent("mount"))}dispatchOnUnmount(){(0,Ee.Z)(this,Kr,Gr).call(this,"onUnmount",new CustomEvent("unmount"))}}function Hr(e){var t=[...Lr,..."page"===this.scope?Br:[]],r=[];for(var n of t){var a=(0,i.remove)((0,g.Z)(this,Nr)[n],(t=>e.has(t.brick)));"onUnmount"===n&&r.push(...a)}for(var o of e){var s,c,l=(0,g.Z)(this,Ur).get(o);if(null!=l&&l.length){for(var u of l)u.disconnect();l.length=0,(0,g.Z)(this,Ur).delete(o)}Cr(o),null===(s=o.element)||void 0===s||delete s.$$tplStateStore,null===(c=o.element)||void 0===c||c.remove()}var p=new CustomEvent("unmount");for(var{brick:d,handlers:f}of r)Ht(f,d.runtimeContext,d)(p)}function qr(e){var t=new CustomEvent("mount");for(var{brick:r,handlers:n}of(0,g.Z)(this,Nr).onMount)e.has(r)&&Ht(n,r.runtimeContext,r)(t);for(var{brick:a,handlers:o}of(0,g.Z)(this,Nr).onScrollIntoView)e.has(a)&&(0,Ee.Z)(this,Wr,zr).call(this,a,o)}function Gr(e,t){for(var{brick:r,handlers:n}of(0,g.Z)(this,Nr)[e])Ht(n,r.runtimeContext,r)(t)}function zr(e,t){var r,n=null!==(r=t.threshold)&&void 0!==r?r:.1,a=new IntersectionObserver(((r,a)=>{r.forEach((r=>{r.isIntersecting&&r.intersectionRatio>=n&&(Ht(t.handlers,e.runtimeContext,e)(new CustomEvent("scroll.into.view")),a.disconnect())}))}),{threshold:n});a.observe(e.element);var o=(0,g.Z)(this,Ur).get(e);o||(o=[],(0,g.Z)(this,Ur).set(e,o)),o.push(a)}function Jr(e){for(var t=e;null!==(r=t)&&void 0!==r&&r.sibling;){var r;t=t.sibling}return t}function Qr(e){for(var t,r=e;r;)r.portal||(t=r),r=r.sibling;return t}function Yr(e){for(var t,r=e;r;)if(r.portal&&(t=r),r.child)r=r.child;else if(r.sibling)r=r.sibling;else{for(var n,a=r.return;a&&!a.sibling;)a=a.return;r=null===(n=a)||void 0===n?void 0:n.sibling}return t}function Xr(e,t){for(var r=new Set,n=e;n;)if(r.add(n),n.child)n=n.child;else{if(n===t)break;if(n.sibling)n=n.sibling;else{for(var a,o=n.return;o&&o!==t&&!o.sibling;)o=o.return;if(o===t)break;n=null===(a=o)||void 0===a?void 0:a.sibling}}return r}function en(){if(!xr){if(xr={isInIframe:!1,isInIframeOfSameSite:!1,isInIframeOfNext:!1,isInIframeOfVisualBuilder:!1,isInIframeOfLegacyConsole:!1},window!==window.parent){xr.isInIframe=!0;try{if(window.origin===window.parent.origin){xr.isInIframeOfSameSite=!0;var e="/next/"===V(),t=window.parent.location.pathname,r=t.startsWith("/next/");xr.isInIframeOfNext=0==(Number(e)^Number(r)),xr.isInIframeOfVisualBuilder=t.startsWith("".concat(r?"/next":"","/visual-builder/")),xr.isInIframeOfLegacyConsole=e&&!r}}catch(e){}}Object.freeze(xr)}return xr}var tn,rn=new WeakSet;function nn(e){if((0,p.isObject)(e)&&!an(e))if(rn.add(e),Array.isArray(e))e.forEach(nn);else{var t=Object.getPrototypeOf(e);t&&t.constructor!==Object||Object.values(e).forEach(nn)}}function an(e){return rn.has(e)}var on=function(){var e=(0,o.Z)((function*(e,t){return(yield c.http.get("api/auth/v2/bootstrap",(0,a.Z)((0,a.Z)({},t),{},{params:e}))).data}));return function(t,r){return e.apply(this,arguments)}}(),sn=function(){var e=(0,o.Z)((function*(e){return(yield c.http.get("api/v1/runtime_standalone",e)).data}));return function(t){return e.apply(this,arguments)}}(),cn=function(){var e=(0,o.Z)((function*(e,t,r){return(yield c.http.get("api/auth/v2/bootstrap/".concat(e),(0,a.Z)((0,a.Z)({},r),{},{params:t}))).data}));return function(t,r,n){return e.apply(this,arguments)}}(),ln=function(){var e=(0,o.Z)((function*(e,t){return(yield c.http.get("api/gateway/micro_app_standalone.runtime.RuntimeMicroAppStandalone/api/v1/micro_app_standalone/runtime/".concat(e),t)).data}));return function(t,r){return e.apply(this,arguments)}}(),un=["feature_flags"],pn=["featureFlags","misc"];function dn(){return fn.apply(this,arguments)}function fn(){return fn=(0,o.Z)((function*(){var e=yield window.STANDALONE_MICRO_APPS?function(){return vn.apply(this,arguments)}():on({appFields:"defaultConfig,userConfig,locales,name,homepage,id,currentVersion,installStatus,internal,status,icons,standaloneMode",ignoreTemplateFields:"templates",ignoreBrickFields:"bricks,processors,providers,editors"}),t=function*(){if(r.locales){var e="tmp/".concat(r.id);Object.entries(r.locales).forEach((t=>{var[r,n]=t;w.i18n.addResourceBundle(r,e,n)})),r.localeName=w.i18n.getFixedT(null,e)("name",r.name),Object.keys(r.locales).forEach((t=>{w.i18n.removeResourceBundle(t,e)}))}else r.localeName=r.name};for(var{app:r}of e.storyboards)yield*t();return(0,p.isObject)(e.settings)&&(0,p.deepFreeze)(e.settings),e.brickPackages=(0,p.deepFreeze)(e.brickPackages),e})),fn.apply(this,arguments)}function vn(){return vn=(0,o.Z)((function*(){var e=[ke.http.get(window.BOOTSTRAP_FILE),ke.http.get("".concat(window.APP_ROOT,"conf.yaml"),{responseType:"text"}),sn().catch((e=>{console.warn("request runtime api from api-gateway failed: ",e,", something might went wrong running standalone micro app")}))];if(!window.NO_AUTH_GUARD){var t,r=window.APP_ID||(window.APP_ROOT&&(t=window.APP_ROOT.match(/^(?:(?:\/next)?\/)?sa-static\/([^/]+)\/versions\//))?t[1]:null);r&&mn(r)}var[n,o,i]=yield Promise.all(e);return function(e,t){var r;try{r=t?(0,Ze.safeLoad)(t,{schema:Ze.JSON_SCHEMA,json:!0}):void 0}catch(e){throw console.error("Parse conf.yaml failed",e),new Error("Invalid conf.yaml")}if(r){var{sys_settings:n,user_config:o,user_config_by_apps:i}=r;if(n){var{feature_flags:s}=n,c=(0,f.Z)(n,un);e.settings=(0,a.Z)({featureFlags:s},c)}if(o&&1===e.storyboards.length)e.storyboards[0].app.userConfig=o;else if(i)for(var{app:l}of e.storyboards)(0,p.hasOwnProperty)(i,l.id)&&(l.userConfig=i[l.id])}}(n,o),function(e,t){var r;if(t){var{featureFlags:n,misc:o}=t,i=(0,f.Z)(t,pn),s=null!==(r=e.settings)&&void 0!==r?r:e.settings={};s.featureFlags=(0,a.Z)((0,a.Z)({},s.featureFlags),n),s.misc=(0,a.Z)((0,a.Z)({},s.misc),o),Object.assign(s,i)}}(n,null==i?void 0:i.settings),n})),vn.apply(this,arguments)}var hn=new Map;function mn(e){return gn.apply(this,arguments)}function gn(){return(gn=(0,o.Z)((function*(e){if(hn.has(e))return hn.get(e);var t=ln(e).catch((e=>{console.warn("request standalone runtime api from micro-app-standalone failed: ",e,", something might went wrong running standalone micro app")}));return hn.set(e,t),t}))).apply(this,arguments)}function yn(){return yn=(0,o.Z)((function*(e){if(!e.$$fulfilled)return e.$$fulfilling||(e.$$fulfilling=function(e){return bn.apply(this,arguments)}(e)),e.$$fulfilling})),yn.apply(this,arguments)}function bn(){return(bn=(0,o.Z)((function*(e){if(window.STANDALONE_MICRO_APPS){if(Object.assign(e,{$$fulfilled:!0,$$fulfilling:null}),!window.NO_AUTH_GUARD){var t;try{t=yield mn(e.app.id)}catch(e){console.warn("request standalone runtime api from micro-app-standalone failed: ",e,", something might went wrong running standalone micro app")}if(t){var{userConfig:r,injectMenus:n}=t;e.app.userConfig=(0,a.Z)((0,a.Z)({},e.app.userConfig),r),function(e){if(Array.isArray(e))for(var t of e)t.overrideApp&&wn(t.overrideApp)}(n),e.meta=(0,a.Z)((0,a.Z)({},e.meta),{},{injectMenus:n})}}}else{var{routes:o,meta:i,app:s}=yield cn(e.app.id,{});Object.assign(e,{routes:o,meta:i,app:(0,a.Z)((0,a.Z)({},e.app),s),$$fulfilled:!0,$$fulfilling:null})}E(e),wn(e.app)}))).apply(this,arguments)}function wn(e){e.config=(0,p.deepFreeze)((0,i.merge)({},e.defaultConfig,e.userConfig))}var En=function(){var e=(0,o.Z)((function*(e,t){return(yield c.http.post("api/gateway/micro_app_standalone.runtime.SearchMicroAppStandalone/api/v1/micro_app_standalone/search",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}();const Sn=(e,t,r)=>{Cn(r);const n=((e,t)=>{const r=Zn(e),n=Zn(t),a=r.pop(),o=n.pop(),i=_n(r,n);return 0!==i?i:a&&o?_n(a.split("."),o.split(".")):a||o?a?-1:1:0})(e,t);return An[r].includes(n)},kn=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Zn=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const t=e.match(kn);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},In=e=>"*"===e||"x"===e||"X"===e,On=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},Pn=(e,t)=>{if(In(e)||In(t))return 0;const[r,n]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(On(e),On(t));return r>n?1:r<n?-1:0},_n=(e,t)=>{for(let r=0;r<Math.max(e.length,t.length);r++){const n=Pn(e[r]||"0",t[r]||"0");if(0!==n)return n}return 0},An={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Tn=Object.keys(An),Cn=e=>{if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===Tn.indexOf(e))throw new Error(`Invalid operator, expected one of ${Tn.join("|")}`)};function Rn(e,t){return function(r,n,a){if(n.name===e){var o=a[a.length-1],i=a[a.length-2];if("CallExpression"===(null==i?void 0:i.node.type)&&"callee"===(null==i?void 0:i.key)&&"MemberExpression"===(null==o?void 0:o.node.type)&&"object"===o.key&&(o.node.computed?"Literal"===o.node.property.type&&o.node.property.value===t:"Identifier"===o.node.property.type&&o.node.property.name===t)){var s=i.node.arguments;if(s.length>0){var c=s[0];"Literal"===c.type&&"string"==typeof c.value?r.usedArgs.add(c.value):r.hasNonStaticUsage=!0}}}}}var Mn=Rn("APP","getMenu"),xn=Rn("INSTALLED_APPS","has"),Ln=new Map,Bn=new Map;function Nn(e,t){var r=Ea(e);if(!r&&window.STANDALONE_MICRO_APPS&&(r=Bn.get(e)),!r||"running"===r.installStatus)return!1;if(!t||!r.currentVersion)return!0;var n=t.match(/^([><]=?|=)(.*)$/);try{if(!n)throw new TypeError("Invalid match version: ".concat(t));return Sn(r.currentVersion,n[2],n[1])}catch(e){console.error(e)}return!1}var Un=new WeakMap,jn=new WeakMap,$n=new WeakMap,Fn=new WeakMap,Dn=new WeakMap,Kn=new WeakMap,Wn=new WeakMap,Vn=new WeakMap,Hn=new WeakMap,qn=new WeakMap,Gn=new WeakMap,zn=new WeakMap,Jn=new WeakSet,Qn=new WeakSet,Yn=new WeakSet,Xn=new WeakSet;class ea{constructor(e){(0,we.Z)(this,Xn),(0,we.Z)(this,Yn),(0,we.Z)(this,Qn),(0,we.Z)(this,Jn),(0,m.Z)(this,Un,{writable:!0,value:void 0}),(0,m.Z)(this,jn,{writable:!0,value:!1}),(0,m.Z)(this,$n,{writable:!0,value:void 0}),(0,m.Z)(this,Fn,{writable:!0,value:void 0}),(0,m.Z)(this,Dn,{writable:!0,value:void 0}),(0,m.Z)(this,Kn,{writable:!0,value:void 0}),(0,m.Z)(this,Wn,{writable:!0,value:new Set}),(0,m.Z)(this,Vn,{writable:!0,value:0}),(0,m.Z)(this,Hn,{writable:!0,value:void 0}),(0,m.Z)(this,qn,{writable:!0,value:void 0}),(0,m.Z)(this,Gn,{writable:!0,value:void 0}),(0,m.Z)(this,zn,{writable:!0,value:void 0}),(0,Se.Z)(this,Un,e);var t=be();window.addEventListener("beforeunload",(e=>{(0,Ee.Z)(this,Jn,ta).call(this,{})?(e.preventDefault(),e.returnValue=""):delete e.returnValue})),t.block(((e,t)=>(0,Ee.Z)(this,Jn,ta).call(this,{location:e,action:t})))}getRenderId(){return(0,g.Z)(this,Hn)}getRuntimeContext(){return(0,g.Z)(this,Dn)}getRecentApps(){return{currentApp:(0,g.Z)(this,qn),previousApp:(0,g.Z)(this,Gn)}}getNavConfig(){return(0,g.Z)(this,zn)}bootstrap(){window.AbortController&&(tn=new AbortController,ke.http.interceptors.request.use((e=>{var t;return(0,a.Z)((0,a.Z)({},e),{},{options:(0,a.Z)((0,a.Z)({},e.options),{},{signal:null!==(t=e.options)&&void 0!==t&&t.noAbortOnRouteChange?null:tn.signal})})})));var e=be();return(0,Se.Z)(this,$n,e.location),e.listen(((e,t)=>{var r,n,o,i=!1,s={hash:void 0,state:void 0};if(void 0!==e.key&&("POP"!==t||void 0!==(0,g.Z)(this,$n).key&&!1!==(null===(r=(0,g.Z)(this,$n).state)||void 0===r?void 0:r.notify))||(s.key=void 0),((0,pe.locationsAreEqual)((0,a.Z)((0,a.Z)({},(0,g.Z)(this,$n)),s),(0,a.Z)((0,a.Z)({},e),s))||"POP"!==t&&!1===(null===(n=e.state)||void 0===n?void 0:n.notify))&&(i=!0),i)(0,Se.Z)(this,$n,e);else{if(tn&&(tn.abort(),tn=new AbortController),(0,Se.Z)(this,$n,e),null===(o=(0,g.Z)(this,Kn))||void 0===o||o.dispatchPageLeave(),"POP"===t&&fe(de((0,g.Z)(this,Un),e.pathname)))return void window.location.reload();(0,g.Z)(this,jn)?(0,Se.Z)(this,Fn,e):(0,Ee.Z)(this,Yn,na).call(this,e).catch(jt)}})),(0,Ee.Z)(this,Yn,na).call(this,e.location)}}function ta(e){var t,r=be(),n=r.getBlockMessage();null===(t=(0,g.Z)(this,Kn))||void 0===t||t.dispatchBeforePageLeave(e);var a=r.getBlockMessage();return!n&&a&&r.unblock(),a}function ra(e,t,r){var n,a;if((0,Se.Z)(this,Vn,(n=(0,g.Z)(this,Vn),a=n++,n)),a>10){var o='Infinite redirect detected: from "'.concat(r.pathname).concat(r.search).concat(r.hash,'" to "').concat(e,'"');throw new Error(o)}be().replace(e,t)}function na(e){return aa.apply(this,arguments)}function aa(){return(aa=(0,o.Z)((function*(e){(0,Se.Z)(this,jn,!0);try{yield(0,Ee.Z)(this,Xn,oa).call(this,e)}finally{if((0,Se.Z)(this,jn,!1),(0,g.Z)(this,Fn)){var t=(0,g.Z)(this,Fn);(0,Se.Z)(this,Fn,void 0),yield(0,Ee.Z)(this,Yn,na).call(this,t)}}}))).apply(this,arguments)}function oa(e){return ia.apply(this,arguments)}function ia(){return ia=(0,o.Z)((function*(e){var t;(0,Se.Z)(this,Hn,(0,i.uniqueId)("render-id-1")),rn=new WeakSet,Fe.clear(),Pe.clear(),be().unblock();var r=de((0,g.Z)(this,Un),e.pathname),n=null===(t=(0,g.Z)(this,Dn))||void 0===t?void 0:t.app;null!=r&&r.app&&(yield function(e){return yn.apply(this,arguments)}(r));var o,c=(0,Se.Z)(this,qn,null==r?void 0:r.app),l=n&&c?n.id!==c.id:n!==c,u=va().getFeatureFlags(),p=(0,g.Z)(this,Kn),d=(t,r)=>{(0,g.Z)(this,Wn).add(p),(0,Ee.Z)(this,Qn,ra).call(this,t,r,e)},f=()=>{var t=u["sso-enabled"]?"/sso-auth/login":"/auth/login";d(t,{from:e})},h=document.querySelector("#main-mount-point"),m=document.querySelector("#portal-mount-point"),y={tag:yr.ROOT,container:h,createPortal:m},b=()=>{for(var e of(Rr(h),Rr(m),(0,g.Z)(this,Wn).add(p),(0,g.Z)(this,Wn)))e&&(e.dispatchOnUnmount(),e.dispose());(0,g.Z)(this,Wn).clear(),x(c&&(j()[c.id]||c.theme)||"light"),F("default"),l&&((0,Se.Z)(this,Gn,n),window.dispatchEvent(new CustomEvent("app.change",{detail:{previousApp:n,currentApp:c}})))};if(c){var w,E;!function(e){if(window.STANDALONE_MICRO_APPS&&!window.NO_AUTH_GUARD){var t=function(e){var t,r={usedArgs:new Set},{customTemplates:n,menus:a}=null!==(t=e.meta)&&void 0!==t?t:{};return(0,s.traverseStoryboardExpressions)([e.routes,n,a],((e,t)=>{xn(r,e,t)}),"INSTALLED_APPS"),[...r.usedArgs]}(e),r=[];for(var n of t)Ln.has(n)||Ea(n)||r.push(n);if(0===r.length)return;var o=En({query:{appId:{$in:r}},fields:["appId","currentVersion","installStatus"]}).catch((e=>{console.error("Get off site standalone micro-apps failed",e)})),i=function(e){Ln.set(e,o.then((t=>{var r,n=null==t||null===(r=t.list)||void 0===r?void 0:r.find((t=>t.appId===e)),o=n?(0,a.Z)((0,a.Z)({},n),{},{id:e}):void 0;return Bn.set(e,o),o})))};for(var c of r)i(c)}}(r);var S=(0,Se.Z)(this,Dn,{app:c,location:e,query:new URLSearchParams(e.search),flags:u,sys:(0,a.Z)((0,a.Z)({},go()),en()),ctxStore:new cr("CTX"),pendingPermissionsPreCheck:[so(r)],tplStateStoreMap:new Map}),k=(0,Se.Z)(this,Kn,new Vr("page"));(0,Se.Z)(this,zn,void 0),function(e){var t;if(!e.$$registerCustomTemplateProcessed){e.$$registerCustomTemplateProcessed=!0;var r=null===(t=e.meta)||void 0===t?void 0:t.customTemplates;if(Array.isArray(r))for(var n of r){var a=n.name.includes(".")?n.name:"".concat(e.app.id,".").concat(n.name);lt.define(a,n)}}}(r),Y(null===(w=r.meta)||void 0===w?void 0:w.functions,c),o=null===(E=r.meta)||void 0===E?void 0:E.contracts,_e(o,Oe);var Z,I=!1;try{if((Z=yield wr(y,function(e){if(window.parent===window)return e;var t=e,r=(0,i.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/template-preview/")));t=[...t.slice(0,r+1),{path:"${APP.homepage}/_dev_only_/template-preview/:templateId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(r+1)];var n=(0,i.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/snippet-preview/")));return[...t.slice(0,n+1),{path:"${APP.homepage}/_dev_only_/snippet-preview/:snippetId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(n+1)]}(r.routes),S,k)).unauthenticated)return void f();if(Z.redirect)return void d(Z.redirect.path,Z.redirect.state);(0,Se.Z)(this,Vn,0),(0,v.flushStableLoadBricks)(),yield Promise.all([...Z.blockingList,S.ctxStore.waitForAll(),...[...S.tplStateStoreMap.values()].map((e=>e.waitForAll())),...S.pendingPermissionsPreCheck]);var O=yield Promise.all(Z.menuRequests);(0,Se.Z)(this,zn,function(e){var t={breadcrumb:[]};for(var r of e)if(r){var{breadcrumb:n}=r;n&&(n.overwrite?t.breadcrumb=n.items:t.breadcrumb.push(...n.items))}return t}(O))}catch(e){if(console.error("Router failed:",e),Lt(e)&&!window.NO_AUTH_GUARD)return void f();if(e instanceof ke.HttpAbortError)return void(0,g.Z)(this,Wn).add(p);I=!0,Z={node:{tag:yr.BRICK,type:"div",properties:{textContent:xt(e)},runtimeContext:null,return:y},blockingList:[],menuRequests:[]}}if(y.child=Z.node,b(),Z.route&&"routes"!==Z.route.type||I)return I||k.dispatchBeforePageLoad(),N(),K(),Mr(y),window.scrollTo(0,0),void(I||(k.dispatchPageLoad(),k.dispatchAnchorLoad(),k.dispatchOnMount(),k.initializeScrollIntoView(),k.initializeMediaChange()))}else{if(!window.NO_AUTH_GUARD&&!bo())return void f();b()}N(),K();var P={tag:yr.BRICK,type:"div",properties:{textContent:"Page not found"},runtimeContext:null,return:y};y.child=P,Mr(y),window.scrollTo(0,0)})),ia.apply(this,arguments)}var sa=function(){var e=(0,o.Z)((function*(e){return(yield c.http.get("api/auth/login",e)).data}));return function(t){return e.apply(this,arguments)}}();function ca(){return la.apply(this,arguments)}function la(){return la=(0,o.Z)((function*(){if(!window.NO_AUTH_GUARD){var e=yield sa();e.loggedIn&&mo(e)}})),la.apply(this,arguments)}var ua,pa,da=void 0!=={brickPackages:[{id:"bricks/basic",bricks:["basic.http-request","basic.general-button","basic.general-link","basic.general-text","basic.general-image","basic.dropdown-button","basic.general-dropdown","basic.general-menu","basic.general-menu-item","basic.general-tag","basic.general-tag-list"],elements:[],processors:[],dependencies:{"basic.general-button":["icons.general-icon"],"basic.general-link":["icons.general-icon"],"basic.general-image":["icons.general-icon"],"basic.dropdown-button":["basic.general-button","basic.general-dropdown","basic.general-menu","basic.general-menu-item"],"basic.general-menu-item":["icons.general-icon"],"basic.general-tag":["icons.general-icon"],"basic.general-tag-list":["basic.general-tag","icons.general-icon"]},filePath:"bricks/basic/dist/index.bb7d735c.js"},{id:"bricks/shoelace",bricks:["shoelace.show-dialog","shoelace.show-notification"],elements:["sl-alert","sl-icon","sl-icon-button","sl-dialog","sl-button","sl-avatar","sl-badge","sl-breadcrumb","sl-breadcrumb-item","sl-button-group","sl-card","sl-carousel","sl-carousel-item","sl-checkbox","sl-color-picker","sl-details","sl-divider","sl-drawer","sl-dropdown","sl-image-comparer","sl-input","sl-menu-label","sl-menu","sl-menu-item","sl-option","sl-progress-bar","sl-progress-ring","sl-qr-code","sl-radio-button","sl-radio-group","sl-radio","sl-range","sl-rating","sl-select","sl-skeleton","sl-spinner","sl-split-panel","sl-switch","sl-tab-group","sl-tab","sl-tab-panel","sl-tag","sl-textarea","sl-tooltip","sl-tree","sl-tree-item"],processors:[],dependencies:{},filePath:"bricks/shoelace/dist/index.5def118b.js"}]}?{brickPackages:[{id:"bricks/basic",bricks:["basic.http-request","basic.general-button","basic.general-link","basic.general-text","basic.general-image","basic.dropdown-button","basic.general-dropdown","basic.general-menu","basic.general-menu-item","basic.general-tag","basic.general-tag-list"],elements:[],processors:[],dependencies:{"basic.general-button":["icons.general-icon"],"basic.general-link":["icons.general-icon"],"basic.general-image":["icons.general-icon"],"basic.dropdown-button":["basic.general-button","basic.general-dropdown","basic.general-menu","basic.general-menu-item"],"basic.general-menu-item":["icons.general-icon"],"basic.general-tag":["icons.general-icon"],"basic.general-tag-list":["basic.general-tag","icons.general-icon"]},filePath:"bricks/basic/dist/index.bb7d735c.js"},{id:"bricks/shoelace",bricks:["shoelace.show-dialog","shoelace.show-notification"],elements:["sl-alert","sl-icon","sl-icon-button","sl-dialog","sl-button","sl-avatar","sl-badge","sl-breadcrumb","sl-breadcrumb-item","sl-button-group","sl-card","sl-carousel","sl-carousel-item","sl-checkbox","sl-color-picker","sl-details","sl-divider","sl-drawer","sl-dropdown","sl-image-comparer","sl-input","sl-menu-label","sl-menu","sl-menu-item","sl-option","sl-progress-bar","sl-progress-ring","sl-qr-code","sl-radio-button","sl-radio-group","sl-radio","sl-range","sl-rating","sl-select","sl-skeleton","sl-spinner","sl-split-panel","sl-switch","sl-tab-group","sl-tab","sl-tab-panel","sl-tag","sl-textarea","sl-tooltip","sl-tree","sl-tree-item"],processors:[],dependencies:{},filePath:"bricks/shoelace/dist/index.5def118b.js"}]}:void 0;function fa(){if(ua)throw new Error("Cannot create multiple runtimes");return(0,w.initializeI18n)(Tt,Ct),ue.locale(w.i18n.language),w.i18n.on("languageChanged",(()=>{ue.locale(w.i18n.language)})),ye(),ua=new ha}function va(){return ua}class ha{bootstrap(){return(0,o.Z)((function*(){var[,e]=yield Promise.all([ca(),dn()]);da=e,$t("shoelace.show-notification"),Rt("shoelace.show-dialog"),pa=new ea(e.storyboards),yield pa.bootstrap()}))()}getRecentApps(){var e,t;return null!==(e=null===(t=pa)||void 0===t?void 0:t.getRecentApps())&&void 0!==e?e:{}}getCurrentApp(){var e;return null===(e=pa)||void 0===e?void 0:e.getRecentApps().currentApp}getFeatureFlags(){var e,t,r,n,o,i;return(0,a.Z)((0,a.Z)((0,a.Z)({},null===(e=da)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.featureFlags),null===(r=pa)||void 0===r||null===(n=r.getRecentApps().currentApp)||void 0===n||null===(o=n.config)||void 0===o||null===(i=o.settings)||void 0===i?void 0:i.featureFlags),{},{"migrate-to-brick-next-v3":!0})}getMiscSettings(){var e,t,r,n,o,i;return(0,a.Z)((0,a.Z)({},null===(e=da)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.misc),null===(r=pa)||void 0===r||null===(n=r.getRecentApps().currentApp)||void 0===n||null===(o=n.config)||void 0===o||null===(i=o.settings)||void 0===i?void 0:i.misc)}getBrandSettings(){var e,t;return(0,a.Z)({base_title:"DevOps 管理专家"},null===(e=da)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.brand)}getLaunchpadSettings(){var e,t;return(0,a.Z)({columns:7,rows:4},null===(e=da)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.launchpad)}getDesktops(){var e,t;return null!==(e=null===(t=da)||void 0===t?void 0:t.desktops)&&void 0!==e?e:[]}getLaunchpadSiteMap(){var e,t;return null!==(e=null===(t=da)||void 0===t?void 0:t.siteSort)&&void 0!==e?e:[]}toggleLaunchpadEffect(e){document.body.classList.toggle("launchpad-open",e)}applyPageTitle(e){var t=this.getBrandSettings().base_title;document.title=e?"".concat(e," - ").concat(t):t}getNavConfig(){var e;return null===(e=pa)||void 0===e?void 0:e.getNavConfig()}}function ma(){var e,t;return null!==(e=null===(t=da)||void 0===t?void 0:t.brickPackages)&&void 0!==e?e:[]}function ga(e){return(0,v.loadBricksImperatively)(e,ma())}function ya(){var e;return null===(e=pa)||void 0===e?void 0:e.getRenderId()}function ba(){var e;return null===(e=pa)||void 0===e?void 0:e.getRuntimeContext()}function wa(e){var t,r;return null===(t=da)||void 0===t||null===(r=t.storyboards)||void 0===r?void 0:r.find((t=>t.app.id===e))}function Ea(e){var t;return null===(t=wa(e))||void 0===t?void 0:t.app}var Sa=new Map,ka=new Proxy(Object.freeze({}),{get:(e,t)=>Sa.get(t)});function Za(e,t,r){if(Sa.has(e))throw new Error('Widget functions of "'.concat(e,'" already registered'));var{storyboardFunctions:n,registerStoryboardFunctions:a}=J({widgetId:e,widgetVersion:r});Sa.set(e,n),a(t)}var Ia=function(){var e=(0,o.Z)((function*(e,t,r){return(yield c.http.post("api/gateway/cmdb.instance.PostSearch/object/".concat(e,"/instance/_search"),t,r)).data}));return function(t,r,n){return e.apply(this,arguments)}}(),Oa=Symbol("appId"),Pa=Symbol("menuI18nNamespace"),_a=Symbol("overrideApp");function Aa(){return(Aa=(0,o.Z)((function*(e,t,r){if(e.dynamicItems&&e.itemsResolve){var n=e.app[0].appId,o=t;if(n!==t.app.id){var i=window.STANDALONE_MICRO_APPS?e.overrideApp:Ea(n);o=(0,a.Z)((0,a.Z)({},t),{},{overrideApp:i,appendI18nNamespace:r.get(e)})}var s=yield De((0,a.Z)({transform:"items"},e.itemsResolve),o);e.items=s.items}}))).apply(this,arguments)}function Ta(){return Ta=(0,o.Z)((function*(e,t){var r=e.find((e=>"inject"!==e.type));if(r){var n=[],o=new Map,i=new WeakMap,s=function*(){if(c.i18n){var e=S("menu","".concat(c.menuId,"~").concat(c.app[0].appId,"+").concat(c.instanceId));Object.entries(c.i18n).forEach((t=>{var[r,n]=t;w.i18n.addResourceBundle(r,e,n)})),i.set(c,e)}};for(var c of e)yield*s();for(var l of(yield Promise.all(e.map((e=>function(e,t,r){return Aa.apply(this,arguments)}(e,t,i)))),e)){var u;if(null!==(u=l.items)&&void 0!==u&&u.length)if("inject"===l.type&&l.injectMenuGroupId){var p=o.get(l.injectMenuGroupId);p||(p=[],o.set(l.injectMenuGroupId,p)),p.push(l)}else n.push(l)}return(0,a.Z)((0,a.Z)({},r),{},{items:n.flatMap((e=>Ca(e.items,e,o,i))),[Pa]:i.get(r),[_a]:r.overrideApp})}})),Ta.apply(this,arguments)}function Ca(e,t,r,n){return null==e?void 0:e.map((e=>{var o,i=e.groupId&&r.get(e.groupId);return i&&r.delete(e.groupId),(0,a.Z)((0,a.Z)({},e),{},{children:(null!==(o=Ca(e.children,t,r,n))&&void 0!==o?o:[]).concat(i?i.flatMap((e=>Ca(e.items,e,r,n))):[]),[Oa]:t.app[0].appId,[Pa]:n.get(t),[_a]:t.overrideApp})}))}function Ra(e){return(0,i.sortBy)(e,(e=>{var t;return null!==(t=e.sort)&&void 0!==t?t:-1/0}))}var Ma=["children"];function xa(e,t,r){var n=r;if(t!==r.app.id){var o=window.STANDALONE_MICRO_APPS?e[_a]:Ea(t);n=(0,a.Z)((0,a.Z)({},r),{},{overrideApp:o,appendI18nNamespace:e[Pa]})}return eo(e,n,{ignoreSymbols:!0})}function La(e,t){return Promise.all(e.map(function(){var e=(0,o.Z)((function*(e){var{children:r}=e,n=(0,f.Z)(e,Ma),[o,i]=yield Promise.all([xa(n,n[Oa],t),r&&(yield La(r,t))]);return(0,a.Z)((0,a.Z)({},o),{},{children:i})}));return function(t){return e.apply(this,arguments)}}()))}var Ba=function(){var e=(0,o.Z)((function*(e,t,r,n){return(yield c.http.get("api/gateway/cmdb.instance.GetDetail/object/".concat(e,"/instance/").concat(t),(0,a.Z)((0,a.Z)({},n),{},{params:r}))).data}));return function(t,r,n,a){return e.apply(this,arguments)}}(),Na=new Map;function Ua(e){return ja.apply(this,arguments)}function ja(){return(ja=(0,o.Z)((function*(e){if(e.title||(0,i.isEmpty)(e.titleDataSource))return e.title;var t=JSON.stringify(e.titleDataSource);if(Na.has(t))return Na.get(t);var r,{objectId:n,instanceId:a,attributeId:o}=e.titleDataSource,s=null!=o?o:"name",c=yield Ba(n,a,{fields:s});if("#showKey"===o&&Array.isArray(c[s])){var[l,...u]=c[s];r=u.length>0?"".concat(l,"(").concat(u.join(","),")"):String(l)}else r=String(c[s]);return Na.set(t,r),r}))).apply(this,arguments)}var $a=["items","app"],Fa=new Map,Da=new Map;function Ka(e){return Da.get(e)}function Wa(){return Wa=(0,o.Z)((function*(e,t){var r=window.STANDALONE_MICRO_APPS?function(e,t){var r,n,o,i,s=wa(t);return(null!==(r=null!==(n=null===(o=s.meta)||void 0===o?void 0:o.injectMenus)&&void 0!==n?n:null===(i=s.meta)||void 0===i?void 0:i.menus)&&void 0!==r?r:[]).filter((t=>t.menuId===e)).map((e=>{var r,n;return(0,a.Z)((0,a.Z)({},e),null!==(r=e.app)&&void 0!==r&&null!==(n=r[0])&&void 0!==n&&n.appId?{}:{app:[{appId:t}]})}))}(e,t.app.id):(yield Ia("EASYOPS_STORYBOARD_MENU",{page:1,page_size:200,fields:{menuId:!0,title:!0,icon:!0,link:!0,titleDataSource:!0,defaultCollapsed:!0,defaultCollapsedBreakpoint:!0,type:!0,injectMenuGroupId:!0,dynamicItems:!0,itemsResolve:!0,items:!0,i18n:!0,"items.children":!0,"app.appId":!0},query:{menuId:{$eq:e},app:{$size:{$gt:0}}}})).list,n=yield function(e,t){return Ta.apply(this,arguments)}(r,t);if(!n)throw new Error("Menu not found: ".concat(e));!function(e){e.items=Ra(e.items).map((e=>(0,a.Z)((0,a.Z)({},e),{},{children:Ra(e.children)})))}(n);var{items:o,app:s}=n,c=(0,f.Z)(n,$a),l=(0,a.Z)((0,a.Z)({},t),{},{pendingPermissionsPreCheck:[...t.pendingPermissionsPreCheck,uo([o,c])]});delete l.tplStateStoreId,delete l.forEachItem;var u=s[0].appId,[p,d]=yield Promise.all([xa(c,u,l),La(o,l)]),v=(0,a.Z)((0,a.Z)({title:yield Ua(p)},(0,i.pick)(p,["icon","link","defaultCollapsed","defaultCollapsedBreakpoint"])),{},{menuItems:d.filter(ze).map((e=>{var t,r=null===(t=e.children)||void 0===t?void 0:t.filter(ze);return"group"===e.type?{type:"group",title:e.text,items:r}:null!=r&&r.length?{type:"subMenu",title:e.text,icon:e.icon,items:r,defaultExpanded:e.defaultExpanded}:e}))});Da.set(e,v)})),Wa.apply(this,arguments)}var Va=["pendingPermissionsPreCheck","tplStateStoreMap","tplStateStoreScope"],Ha=Symbol.for("pre.evaluated.raw"),qa=Symbol.for("pre.evaluated.context");function Ga(e){return!(null==e||!e[Ha])}function za(e){return"string"==typeof e?(0,u.shouldAllowRecursiveEvaluations)(e):(0,u.shouldAllowRecursiveEvaluations)(e[Ha])}var Ja=new WeakSet([SyntaxError,TypeError,ReferenceError]);function Qa(e){return Ja.has(e.constructor)?e.constructor:TypeError}function Ya(){return(Ya=(0,o.Z)((function*(e,t,r){var{blockingList:n,run:a}=Xa(e,t,r,!0);return yield Promise.all(n),a()}))).apply(this,arguments)}function Xa(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,o=[];if("string"!=typeof e){var{pendingPermissionsPreCheck:c,tplStateStoreMap:l,tplStateStoreScope:d}=t,m=(0,f.Z)(t,Va);t=(0,a.Z)((0,a.Z)({},e[qa]),m),e=e[Ha]}var g,y={usedArgs:new Set},w={usedArgs:new Set};try{g=(0,u.preevaluate)(e,{withParent:!0,hooks:{beforeVisitGlobal(e,t){Mn(y,e,t),xn(w,e,t)}}})}catch(t){var E="".concat(t.message,', in "').concat(e,'"');throw new(Qa(t))(E)}if(y.hasNonStaticUsage)throw new Error('Non-static usage of "APP.getMenu" is prohibited in v3, check your expression: "'.concat(e,'"'));if(w.hasNonStaticUsage)throw new Error('Non-static usage of "INSTALLED_APPS.has" is prohibited in v3, check your expression: "'.concat(e,'"'));var S,k,P,_,C={},{attemptToVisitGlobals:R}=g;if(r.lazy||R.has("EVENT")&&!(0,p.hasOwnProperty)(t,"event")||R.has("DATA")&&!(0,p.hasOwnProperty)(t,"data"))return{blockingList:o,run:()=>Object.keys(t).length>0?{[Ha]:e,[qa]:t}:e};var M=ot(t);(R.has("STATE")||!M&&R.has("TPL"))&&(_=ut(t,"STATE",': "'.concat(e,'"')));var x,L=O();if(n||L){if(R.has("CTX")&&(S=(0,s.strictCollectMemberUsage)(e,"CTX"),n&&o.push(t.ctxStore.waitFor(S))),_){if(P=(0,s.strictCollectMemberUsage)(e,"STATE"),!M){var B=(0,s.strictCollectMemberUsage)(e,"TPL");for(var N of B)P.add(N)}n&&o.push(_.waitFor(P))}R.has("PROCESSORS")&&(k=(0,s.strictCollectMemberUsage)(e,"PROCESSORS",2),n&&o.push((0,v.loadProcessorsImperatively)(k,ma())))}if(n){var U=R.has("PERMISSIONS");if(!U&&R.has("FN")){var j=[...(0,s.strictCollectMemberUsage)(e,"FN")];U=X(j)}if(U&&o.push(...t.pendingPermissionsPreCheck),y.usedArgs.size>0){var $=[...y.usedArgs];o.push(Promise.all($.map((e=>function(e,t){var r=Fa.get(e);return r||(r=function(e,t){return Wa.apply(this,arguments)}(e,t)),r}(e,t)))))}w.usedArgs.size>0&&o.push((x=[...w.usedArgs],Promise.all(x.map((e=>Ln.get(e))))))}return{blockingList:o,run(){var r,n,{app:o,location:s,query:c,match:l,flags:d,sys:f,ctxStore:v,data:m,event:y}=t,w=null!==(r=t.overrideApp)&&void 0!==r?r:o;for(var E of R)switch(E){case"ANCHOR":C[E]=s.hash?s.hash.substring(1):null;break;case"APP":C[E]=(0,a.Z)((0,a.Z)({},(0,i.cloneDeep)(w)),{},{getMenu:Ka});break;case"CTX":C[E]=T({get:(e,t)=>v.getValue(t),ownKeys:()=>Array.from(S)});break;case"DATA":C[E]=m;break;case"EVENT":C[E]=y;break;case"FLAGS":C[E]=A(d);break;case"HASH":C[E]=s.hash;break;case"INSTALLED_APPS":C[E]=A({has:Nn});break;case"ITEM":(0,p.hasOwnProperty)(t,"forEachItem")?C[E]=t.forEachItem:console.error('Using `ITEM` but no `:forEach` is found, check your expression: "'.concat(e,'"'));break;case"LOCAL_STORAGE":C[E]=A({getItem:le("local")});break;case"MEDIA":C[E]=A(ce());break;case"MISC":C[E]=va().getMiscSettings();break;case"PARAMS":C[E]=new URLSearchParams(c);break;case"PATH":C[E]=A(null!==(n=null==l?void 0:l.params)&&void 0!==n?n:{});break;case"PATH_NAME":C[E]=s.pathname;break;case"PROCESSORS":C[E]=T({get(e,t){var r=b.get(t);if(!r)throw new Error("'PROCESSORS.".concat(t,"' is not registered! Have you installed the relevant brick package?"));return T({get:(e,t)=>r.get(t),ownKeys:()=>Array.from(r.keys())})},ownKeys:()=>Array.from(k)});break;case"QUERY":C[E]=Object.fromEntries(Array.from(c.keys()).map((e=>[e,c.get(e)])));break;case"QUERY_ARRAY":C[E]=Object.fromEntries(Array.from(c.keys()).map((e=>[e,c.getAll(e)])));break;case"SESSION_STORAGE":C[E]=A({getItem:le("session")});break;case"TPL":if(it(M,'Using "TPL" in expression','check your expression: "'.concat(e,'"')),M)break;case"STATE":C[E]=T({get:(e,t)=>_.getValue(t),ownKeys:()=>Array.from(P)});break;case"SYS":C[E]=A(null!=f?f:{});break;case"__WIDGET_FN__":C[E]=ka;break;case"__WIDGET_IMG__":C[E]=I;break;case"__WIDGET_I18N__":C[E]=Z}Object.assign(C,H(g.attemptToVisitGlobals,{storyboardFunctions:Q,app:t.app,appendI18nNamespace:t.appendI18nNamespace}));try{return(0,u.cook)(g.expression,g.source,{globalVariables:(0,h.supply)(g.attemptToVisitGlobals,C)})}catch(t){var O="".concat(t.message,', in "').concat(e,'"');throw new(Qa(t))(O)}}}}function eo(e,t){return to.apply(this,arguments)}function to(){return to=(0,o.Z)((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Ga(e);if(n||"string"==typeof e){var a,o=r.$$lazyForUseBrick&&Xe(r.$$stateOfUseBrick),i=o;return n||(0,u.isEvaluable)(e)?(a=yield function(e,t,r){return Ya.apply(this,arguments)}(e,t,{lazy:o}),i=za(e)):a=o?e:((0,p.hasOwnProperty)(t,"data")?r.noInject?d.transform:d.transformAndInject:r.noInject?ao:d.inject)(e,t),i||nn(a),a}if(!(0,p.isObject)(e)||an(e))return e;if(Array.isArray(e)){var s=no(r,!0);return Promise.all(e.map((e=>eo(e,t,s))))}return Object.fromEntries((yield Promise.all(Object.entries(e).map((e=>{var[n,a]=e;return Promise.all([eo(n,t),eo(a,t,no(r,!1,n))])})))).concat(r.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))})),to.apply(this,arguments)}function ro(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Ga(e);if(n||"string"==typeof e){var a,o=r.$$lazyForUseBrick&&Xe(r.$$stateOfUseBrick),i=o;return n||(0,u.isEvaluable)(e)?(a=function(e,t,r){var{run:n}=Xa(e,t,void 0,!1);return n()}(e,t),i=za(e)):a=o?e:((0,p.hasOwnProperty)(t,"data")?r.noInject?d.transform:d.transformAndInject:r.noInject?ao:d.inject)(e,t),i||nn(a),a}if(!(0,p.isObject)(e)||an(e))return e;if(Array.isArray(e)){var s=no(r,!0);return e.map((e=>ro(e,t,s)))}return Object.fromEntries(Object.entries(e).map((e=>{var[n,a]=e;return[ro(n,t),ro(a,t,no(r,!1,n))]})).concat(r.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))}function no(e,t,r){return e.$$lazyForUseBrick?(0,a.Z)((0,a.Z)({},e),{},{$$stateOfUseBrick:et(e.$$stateOfUseBrick,t,r)}):e}function ao(e){return e}var oo=[],io=new Map;function so(e){if(bo()&&!go().isAdmin)return po((0,s.scanPermissionActionsInStoryboard)(e))}function co(e,t){return lo.apply(this,arguments)}function lo(){return(lo=(0,o.Z)((function*(e,t){if(bo()&&!go().isAdmin&&Array.isArray(e.permissionsPreCheck))return po(yield eo(e.permissionsPreCheck,t))}))).apply(this,arguments)}function uo(e){if(bo()&&!go().isAdmin)return po((0,s.scanPermissionActionsInAny)(e))}function po(e){return fo.apply(this,arguments)}function fo(){return(fo=(0,o.Z)((function*(e){var t=(0,i.difference)(e,[...oo]);if(0!==t.length){oo.push(...t);try{var r=yield l({actions:t});for(var n of r.actions)io.set(n.action,n.authorizationStatus),"undefined"===n.authorizationStatus&&console.error('Undefined permission action: "'.concat(n.action,'"'))}catch(e){console.error("Pre-check permissions failed",e)}}}))).apply(this,arguments)}function vo(){if(!bo())return!1;if(go().isAdmin)return!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n of t)switch(io.get(n)){case"unauthorized":case"undefined":return!1;case void 0:return console.error('Un-checked permission action: "'.concat(n,'", please make sure the permission to check is defined in permissionsPreCheck.')),!1}return!0}var ho={};function mo(e){Object.assign(ho,{org:e.org,username:e.username,userInstanceId:e.userInstanceId,loginFrom:e.loginFrom,accessRule:e.accessRule,isAdmin:e.isAdmin,csrfToken:e.csrfToken,license:e.license,userShowValue:e.userShowValue})}function go(){return(0,a.Z)({},ho)}function yo(){for(var e of Object.keys(ho))ho[e]=void 0;oo.length=0,io.clear()}function bo(){return void 0!==ho.username}function wo(e,t,r){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,o.Z)((function*(e,t,r){return We(yield je(e),e,"resolve",t,r)}))).apply(this,arguments)}function So(e){var t,{portal:r,scope:n="fragment"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r;t=r||(()=>((a=document.createElement("div")).style.position="absolute",a.style.width=a.style.height="0",document.body.append(a),a));var i,s=!1;return{render(r){var c=arguments;return(0,o.Z)((function*(){var{theme:o}=c.length>1&&void 0!==c[1]?c[1]:{};if(s)throw new Error("The root is unmounted and cannot be rendered any more");var l=[].concat(r),u={pendingPermissionsPreCheck:[],tplStateStoreMap:new Map},p=i;i=new Vr(n);var d,f={tag:yr.ROOT,container:e,createPortal:t},h=!1;try{(d=yield Sr(f,l,u,i)).blockingList.push(...[...u.tplStateStoreMap.values()].map((e=>e.waitForAll())),...u.pendingPermissionsPreCheck),(0,v.flushStableLoadBricks)(),yield Promise.all(d.blockingList)}catch(e){h=!0,d={node:{tag:yr.BRICK,type:"div",properties:{textContent:xt(e)},return:f,runtimeContext:null},blockingList:[],menuRequests:[]}}f.child=d.node,null==p||p.dispose(),Rr(e),a&&Rr(a),"page"===n&&(x(null!=o?o:"light"),F("default"),h||i.dispatchBeforePageLoad(),N(),K()),Mr(f),"page"===n&&window.scrollTo(0,0),h||("page"===n&&i.dispatchPageLoad(),i.dispatchOnMount(),i.initializeScrollIntoView(),i.initializeMediaChange())}))()},unmount(){s||(s=!0,Rr(e),a&&(Rr(a),r||a.remove()))}}}function ko(e,t){return Zo.apply(this,arguments)}function Zo(){return(Zo=(0,o.Z)((function*(e,t){var r,n,o=[],i=(0,a.Z)((0,a.Z)({},ba()),{},{data:t,pendingPermissionsPreCheck:[],tplStateStoreScope:o});null!==(r=i.tplStateStoreMap)&&void 0!==r||(i.tplStateStoreMap=new Map);var s=new Vr("fragment"),c={tag:yr.ROOT,createPortal:null},l=e.transform,u=ot();l&&it(u,"`useBrick.transform`",'please use "properties" instead, check your useBrick:',e);var p=yield Zr(c,u?e:(0,a.Z)((0,a.Z)({},e),{},{properties:(0,a.Z)((0,a.Z)({},e.properties),l)}),i,s);if((0,v.flushStableLoadBricks)(),yield Promise.all([...p.blockingList,...o.map((e=>e.waitForAll())),...i.pendingPermissionsPreCheck]),null!==(n=p.node)&&void 0!==n&&n.portal)throw new Error("The root brick of useBrick cannot be a portal brick");return c.child=p.node,{tagName:p.node?p.node.type:null,renderRoot:c,rendererContext:s}}))).apply(this,arguments)}function Io(e,t){var r,{renderRoot:n,rendererContext:a}=e;return n.createPortal=()=>{var e=document.querySelector("#portal-mount-point");return r=document.createElement("div"),e.appendChild(r),r},Mr(n,t),a.dispatchOnMount(),a.initializeScrollIntoView(),a.initializeMediaChange(),{portal:r}}function Oo(e,t){var{rendererContext:r}=e;t.portal&&(Rr(t.portal),t.portal.remove()),r.dispatchOnUnmount(),r.dispose()}function Po(e){!function(e){da=e}(e),$t("shoelace.show-notification"),Rt("shoelace.show-dialog")}function _o(e,t,r){if(r)throw new Error("Legacy doTransform does not support options in v3");return ro(t,(0,a.Z)((0,a.Z)({},ba()),{},{data:e}),{noInject:!0})}var Ao=ga;function To(e,t){var r=wa(e);Object.assign(r,(0,a.Z)((0,a.Z)({},t),{},{$$fulfilling:null,$$fulfilled:!0,$$registerCustomTemplateProcessed:!1})),E(r)}function Co(e,t){var r=wa(e),n=!1,a=e=>"".concat(e.path,".").concat(e.exact),o=(e,r)=>e.map((e=>{var i=a(e);return"routes"===e.type?(e.routes=o(e.routes,r),e):i===r?(n=!0,t):e}));r.routes=o(r.routes,a(t)),n||r.routes.unshift(t)}function Ro(e,t,r){var n="".concat(e,".").concat(t.name);lt.define(n,{bricks:t.bricks,proxy:t.proxy,state:t.state}),Mo(e,t.name,r)}function Mo(e,t,r){Bo(e,"${APP.homepage}/_dev_only_/template-preview/".concat(t),[(0,a.Z)({brick:t},(0,i.pick)(r,"properties","events","lifeCycle","context"))])}function xo(e,t){var r;Bo(e,"${APP.homepage}/_dev_only_/snippet-preview/".concat(t.snippetId),null!==(r=t.bricks)&&void 0!==r&&r.length?t.bricks:[{brick:"span"}])}var Lo=xo;function Bo(e,t,r){var{routes:n}=wa(e),a=n.findIndex((e=>e.path===t)),o={path:t,bricks:r,menu:!1,exact:!0};-1===a?n.unshift(o):n.splice(a,1,o)}}}]);