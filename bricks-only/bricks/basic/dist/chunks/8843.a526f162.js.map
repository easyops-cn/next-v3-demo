{"version":3,"file":"chunks/8843.a526f162.js","mappings":"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","sources":["webpack:///../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../node_modules/@next-api-sdk/micro-app-sdk/dist/esm/api/micro_app/permission/validatePermissions.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomProcessors.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerAppI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/images.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/devtools.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/proxyFactories.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/themeAndMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getBasePath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getGeneralGlobals.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/StoryboardFunctionRegistry.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/StoryboardFunctions.js","webpack:///../../node_modules/@ungap/event-target/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mediaQuery.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getStorageItem.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/historyExtended.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/history.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Runtime.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/contract/searchSingleContract.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/CollectContracts.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/FlowApi.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/FlowApiProvider.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/getProviderBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveData.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/checkIf.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getNextStateOfUseBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getTracks.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/evaluate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/isStrictMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/utils.js","webpack:///../../node_modules/@next-core/runtime/node_modules/path-to-regexp/dist.es2015/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchPath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Dialog.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/poll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/i18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/handleHttpError.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Notification.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/bindListeners.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/DataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveDataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupUseBrickInTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/expandCustomTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/enums.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Renderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/listenOnTrackingContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/bindTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mount.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/RendererContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getPageInfo.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/markAsComputed.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/abortController.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/bootstrap_v2/bootstrapV2.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/bootstrap_standalone/runtimeStandalone.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/bootstrap_v2/getAppStoryboardV2.js","webpack:///../../node_modules/@next-api-sdk/micro-app-standalone-sdk/dist/esm/api/micro_app_standalone/runtime/runtimeMicroAppStandalone.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/loadBootstrapData.js","webpack:///../../node_modules/@next-api-sdk/micro-app-standalone-sdk/dist/esm/api/micro_app_standalone/runtime/searchMicroAppStandalone.js","webpack:///../../node_modules/compare-versions/lib/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/collectMemberCallUsage.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/checkInstalledApps.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Router.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerCustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/insertPreviewRoutes.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/auth/checkLogin.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/loadCheckLogin.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/bootstrapData.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetFunctions.js","webpack:///../../node_modules/@next-api-sdk/cmdb-sdk/dist/esm/api/cmdb/instance/postSearch.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/loadDynamicMenuItems.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/mergeMenu.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/reorderMenuItems.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/computeMenuData.js","webpack:///../../node_modules/@next-api-sdk/cmdb-sdk/dist/esm/api/cmdb/instance/getDetail.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/fetchMenuTitle.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/fetchMenuById.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/menu/getMenusOfStandaloneApp.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealValue.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/checkPermissions.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/auth.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/fetchByProvider.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/createRoot.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/secret_internals.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","export default function _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n  return fn;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateMethodInitSpec(obj, privateSet) {\n  checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 校验系统权限\n * @endpoint POST /api/micro_app/v1/permission/validate\n */\nexport var PermissionApi_validatePermissions = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.micro_app.permission.ValidatePermissions@1.0.0 */(yield http.post(\"api/gateway/micro_app.permission.ValidatePermissions/api/micro_app/v1/permission/validate\", data, options)).data\n    );\n  });\n  return function PermissionApi_validatePermissions(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=validatePermissions.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomProcessorRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(processorFullName, processorFunc) {\n    // `namespace` should be the camelCase of the package name.\n    var [namespace, processorName] = processorFullName.split(\".\");\n    var pkg = _classPrivateFieldGet(this, _registry).get(namespace);\n    if (!pkg) {\n      pkg = new Map();\n      _classPrivateFieldGet(this, _registry).set(namespace, pkg);\n    }\n    if (pkg.has(processorName)) {\n      // eslint-disable-next-line no-console\n      throw new Error(\"Custom processor of \\\"\".concat(processorFullName, \"\\\" already registered\"));\n    }\n    pkg.set(processorName, processorFunc);\n  }\n  get(namespace) {\n    return _classPrivateFieldGet(this, _registry).get(namespace);\n  }\n}\nexport var customProcessors = new CustomProcessorRegistry();\n//# sourceMappingURL=CustomProcessors.js.map","import { i18n } from \"@next-core/i18n\";\nexport function registerAppI18n(_ref) {\n  var {\n    app,\n    meta\n  } = _ref;\n  if (meta !== null && meta !== void 0 && meta.i18n) {\n    // Prefix to avoid conflict between brick package's i18n namespace.\n    var i18nNamespace = getI18nNamespace(\"app\", app.id);\n    // Support any language in `meta.i18n`.\n    Object.entries(meta.i18n).forEach(_ref2 => {\n      var [lang, resources] = _ref2;\n      i18n.addResourceBundle(lang, i18nNamespace, resources);\n    });\n  }\n}\nexport function getI18nNamespace(type, id) {\n  return \"\".concat(type, \"/\").concat(id);\n}\n//# sourceMappingURL=registerAppI18n.js.map","// import i18next, { getFixedT, TFunction } from \"i18next\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nexport function registerWidgetI18n(widgetId, i18nData) {\n  var ns = getI18nNamespace(\"widget\", widgetId);\n  Object.entries(i18nData).forEach(_ref => {\n    var [lang, resources] = _ref;\n    i18n.addResourceBundle(lang, ns, resources);\n  });\n}\nexport function widgetI18nFactory(widgetId) {\n  return i18n.getFixedT(null, getI18nNamespace(\"widget\", widgetId));\n}\n//# sourceMappingURL=WidgetI18n.js.map","export function imagesFactory(appId, isBuildPush) {\n  return {\n    get(name) {\n      return isBuildPush ? \"api/gateway/object_store.object_store.GetObject/api/v1/objectStore/bucket/next-builder/object/\".concat(name) : \"\".concat(window.APP_ROOT ? \"\".concat(window.APP_ROOT, \"-/\") : \"\", \"micro-apps/\").concat(appId, \"/images/\").concat(name);\n    }\n  };\n}\nexport function widgetImagesFactory(widgetId, widgetVersion) {\n  return {\n    get(name) {\n      var _window$PUBLIC_ROOT;\n      return \"\".concat((_window$PUBLIC_ROOT = window.PUBLIC_ROOT) !== null && _window$PUBLIC_ROOT !== void 0 ? _window$PUBLIC_ROOT : \"\", \"bricks/\").concat(widgetId, \"/\").concat(window.PUBLIC_ROOT_WITH_VERSION && widgetVersion ? \"\".concat(widgetVersion, \"/\") : \"\", \"dist/assets/\").concat(name);\n    }\n  };\n}\n//# sourceMappingURL=images.js.map","export function getDevHook() {\n  return window.__BRICK_NEXT_DEVTOOLS_HOOK__;\n}\n//# sourceMappingURL=devtools.js.map","import { getDevHook } from \"./devtools.js\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar THROW = () => {\n  throw new Error(\"Can't modify read-only proxy object\");\n};\nvar readOnlyHandler = {\n  set: THROW,\n  defineProperty: THROW,\n  deleteProperty: THROW,\n  setPrototypeOf: THROW\n};\nexport function getReadOnlyProxy(object) {\n  return new Proxy(object, readOnlyHandler);\n}\n\n// First, we want to make accessing property of globals lazy,\n// So we use *Proxy* to make a dynamic accessor for each of these globals.\n// But we also want to keep them working in devtools.\nexport function getDynamicReadOnlyProxy(_ref) {\n  var {\n    get,\n    ownKeys\n  } = _ref;\n  if (getDevHook()) {\n    // In devtools, we extract them at beginning.\n    var target = Object.fromEntries(ownKeys(null).map(key => [key, get(null, key, null)]));\n    return getReadOnlyProxy(target);\n  }\n  return new Proxy(Object.freeze({}), {\n    get\n  });\n}\n//# sourceMappingURL=proxyFactories.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { JsonStorage } from \"@next-core/utils/general\";\n// Themes.\nvar theme = \"light\";\nvar storage = new JsonStorage(localStorage);\nvar LOCAL_STORAGE_APPS_THEME_KEY = \"apps-theme\";\nexport function setTheme(value) {\n  if (value !== \"dark\" && value !== \"light\" && value !== \"dark-v2\") {\n    throw new Error(\"Unsupported theme: \".concat(value));\n  }\n  theme = value;\n}\nexport function getTheme() {\n  return theme;\n}\nexport function getCurrentTheme() {\n  return document.documentElement.dataset.theme;\n}\nexport function applyTheme(value) {\n  if (value) {\n    setTheme(value);\n  } else {\n    value = getTheme();\n  }\n  if (value !== getCurrentTheme()) {\n    document.documentElement.dataset.theme = value;\n    window.dispatchEvent(new CustomEvent(\"theme.change\", {\n      detail: value\n    }));\n  }\n}\nexport function batchSetAppsLocalTheme(appsTheme) {\n  storage.setItem(LOCAL_STORAGE_APPS_THEME_KEY, _objectSpread(_objectSpread({}, getLocalAppsTheme()), appsTheme));\n}\nexport function getLocalAppsTheme() {\n  var _result;\n  var result;\n  try {\n    result = storage.getItem(LOCAL_STORAGE_APPS_THEME_KEY);\n  } catch (_unused) {\n    // eslint-disable-next-line no-console\n    console.error(\"JSON parse error inside `getLocalAppsTheme()`\");\n  }\n  return (_result = result) !== null && _result !== void 0 ? _result : {};\n}\n\n// Modes.\nvar mode = \"default\";\nexport function setMode(value) {\n  if (value !== \"dashboard\" && value !== \"default\") {\n    throw new Error(\"Unsupported mode: \".concat(value));\n  }\n  mode = value;\n}\nexport function getMode() {\n  return mode;\n}\nexport function getCurrentMode() {\n  return document.documentElement.dataset.mode;\n}\nexport function applyMode(value) {\n  if (value) {\n    setMode(value);\n  } else {\n    value = getMode();\n  }\n  if (value !== getCurrentMode()) {\n    document.documentElement.dataset.mode = value;\n    window.dispatchEvent(new CustomEvent(\"mode.change\", {\n      detail: value\n    }));\n  }\n}\nexport function getCssPropertyValue(name) {\n  var _window$getComputedSt;\n  var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.documentElement;\n  if (!el) return \"\";\n  return ((_window$getComputedSt = window.getComputedStyle(el)) === null || _window$getComputedSt === void 0 ? void 0 : _window$getComputedSt.getPropertyValue(name)) || \"\";\n}\n//# sourceMappingURL=themeAndMode.js.map","/**\n * Get site's base path, generally will be `/next/` or `/`.\n */\nexport function getBasePath() {\n  var base = document.querySelector(\"base\");\n  var basePath = base ? base.getAttribute(\"href\") : \"/\";\n  return basePath;\n}\n//# sourceMappingURL=getBasePath.js.map","import { identity } from \"lodash\";\nimport { i18n, i18nText } from \"@next-core/i18n\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { imagesFactory, widgetImagesFactory } from \"./images.js\";\nimport { checkPermissions } from \"../checkPermissions.js\";\nimport { getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getTheme } from \"../../themeAndMode.js\";\nimport { getBasePath } from \"../../getBasePath.js\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\n// `GeneralGlobals` are globals which are page-state-agnostic,\n// thus they can be used both in storyboard expressions and functions.\nexport function getGeneralGlobals(attemptToVisitGlobals, options) {\n  var globalVariables = {};\n  for (var variableName of attemptToVisitGlobals) {\n    var variable = getIndividualGlobal(variableName, options);\n    if (variable !== undefined) {\n      globalVariables[variableName] = variable;\n    }\n  }\n  return globalVariables;\n}\nfunction getIndividualGlobal(variableName, _ref) {\n  var {\n    collectCoverage,\n    widgetId,\n    widgetVersion,\n    app,\n    appendI18nNamespace,\n    storyboardFunctions,\n    isStoryboardFunction\n  } = _ref;\n  switch (variableName) {\n    case \"BASE_URL\":\n      return collectCoverage ? \"/next\" : getBasePath().replace(/\\/$/, \"\");\n    case \"FN\":\n      return storyboardFunctions;\n    case \"IMG\":\n      return collectCoverage ? fakeImageFactory() : widgetId ? widgetImagesFactory(widgetId, widgetVersion) : imagesFactory(app.id, app.isBuildPush);\n    case \"I18N\":\n      return collectCoverage ? identity : widgetId ? widgetI18nFactory(widgetId) : i18n.getFixedT(null, [appendI18nNamespace, getI18nNamespace(\"app\", app.id)].filter(Boolean));\n    case \"I18N_TEXT\":\n      return collectCoverage ? fakeI18nText : i18nText;\n    case \"PERMISSIONS\":\n      return getReadOnlyProxy({\n        check: collectCoverage ? fakeCheckPermissions : checkPermissions\n      });\n    case \"THEME\":\n      return getReadOnlyProxy({\n        getTheme: collectCoverage ? () => \"light\" : getTheme\n        // getCssPropertyValue: collectCoverage ? () => \"\" : getCssPropertyValue,\n      });\n\n    case \"console\":\n      return isStoryboardFunction ? getReadOnlyProxy(console) : undefined;\n    case \"location\":\n      return collectCoverage ? {\n        href: \"http://localhost:3000/functions/test\",\n        origin: \"http://localhost:3000\",\n        host: \"localhost:3000\",\n        hostname: \"localhost\"\n      } : {\n        href: location.href,\n        origin: location.origin,\n        host: location.host,\n        hostname: location.hostname\n      };\n  }\n}\nfunction fakeI18nText(data) {\n  return data === null || data === void 0 ? void 0 : data.en;\n}\nfunction fakeImageFactory() {\n  return {\n    get(name) {\n      return \"mock/images/\".concat(name);\n    }\n  };\n}\nfunction fakeCheckPermissions() {\n  return true;\n}\n//# sourceMappingURL=getGeneralGlobals.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { cook, precookFunction } from \"@next-core/cook\";\nimport { supply } from \"@next-core/supply\";\nimport { strictCollectMemberUsageInFunction } from \"@next-core/utils/storyboard\";\nimport { getGeneralGlobals } from \"./internal/compute/getGeneralGlobals.js\";\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\nexport function StoryboardFunctionRegistryFactory() {\n  var {\n    widgetId,\n    widgetVersion,\n    collectCoverage\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var registeredFunctions = new Map();\n\n  // Use `Proxy` with a frozen target, to make a readonly function registry.\n  var storyboardFunctions = new Proxy(Object.freeze({}), {\n    get(target, key) {\n      return getStoryboardFunction(key);\n    }\n  });\n  var currentApp;\n  function registerStoryboardFunctions(functions, app) {\n    if (app) {\n      currentApp = app;\n    }\n    registeredFunctions.clear();\n    if (Array.isArray(functions)) {\n      for (var fn of functions) {\n        var deps = strictCollectMemberUsageInFunction(fn, \"FN\");\n        var hasPermissionsCheck = strictCollectMemberUsageInFunction(fn, \"PERMISSIONS\").has(\"check\");\n        registeredFunctions.set(fn.name, {\n          source: fn.source,\n          typescript: fn.typescript,\n          deps,\n          hasPermissionsCheck\n        });\n      }\n    }\n  }\n  function getStoryboardFunction(name) {\n    var fn = registeredFunctions.get(name);\n    if (!fn) {\n      return undefined;\n    }\n    if (fn.processed) {\n      return fn.cooked;\n    }\n    var collector;\n    if (collectCoverage) {\n      collector = collectCoverage.createCollector(name);\n    }\n    var precooked = precookFunction(fn.source, {\n      typescript: fn.typescript,\n      hooks: collector && {\n        beforeVisit: collector.beforeVisit\n      }\n    });\n    fn.cooked = cook(precooked.function, fn.source, {\n      rules: {\n        noVar: true\n      },\n      globalVariables: supply(precooked.attemptToVisitGlobals, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        collectCoverage,\n        widgetId,\n        widgetVersion,\n        app: currentApp,\n        storyboardFunctions,\n        isStoryboardFunction: true\n      }), !!collectCoverage),\n      hooks: collector && {\n        beforeEvaluate: collector.beforeEvaluate,\n        beforeCall: collector.beforeCall,\n        beforeBranch: collector.beforeBranch\n      }\n    });\n    fn.processed = true;\n    return fn.cooked;\n  }\n  return {\n    storyboardFunctions,\n    registerStoryboardFunctions,\n    updateStoryboardFunction(name, data) {\n      var newFn = _objectSpread(_objectSpread({}, data), {}, {\n        name\n      });\n      var deps = strictCollectMemberUsageInFunction(newFn, \"FN\");\n      var hasPermissionsCheck = strictCollectMemberUsageInFunction(newFn, \"PERMISSIONS\").has(\"check\");\n      registeredFunctions.set(name, {\n        source: data.source,\n        typescript: data.typescript,\n        deps,\n        hasPermissionsCheck\n      });\n    },\n    /**\n     * Check whether listed functions attempt to call `PERMISSIONS.check()`,\n     * includes in nested `FN.*()` calls.\n     */\n    checkPermissionsUsage(functionNames) {\n      var checkedFunctions = new Set();\n      var hasPermissionsCheck = name => {\n        if (!checkedFunctions.has(name)) {\n          checkedFunctions.add(name);\n          var fn = registeredFunctions.get(name);\n          return !!fn && (fn.hasPermissionsCheck || [...fn.deps].some(hasPermissionsCheck));\n        }\n        return false;\n      };\n      return functionNames.some(hasPermissionsCheck);\n    }\n  };\n}\n//# sourceMappingURL=StoryboardFunctionRegistry.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nexport var {\n  storyboardFunctions,\n  registerStoryboardFunctions,\n  checkPermissionsUsage\n} = StoryboardFunctionRegistryFactory();\n//# sourceMappingURL=StoryboardFunctions.js.map","/*! (c) Andrea Giammarchi - ISC */\nvar self = {};\ntry {\n  self.EventTarget = (new EventTarget).constructor;\n} catch(EventTarget) {\n  (function (Object, wm) {\n    var create = Object.create;\n    var defineProperty = Object.defineProperty;\n    var proto = EventTarget.prototype;\n    define(proto, 'addEventListener', function (type, listener, options) {\n      for (var\n        secret = wm.get(this),\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener)\n          return;\n      }\n      listeners.push({target: this, listener: listener, options: options});\n    });\n    define(proto, 'dispatchEvent', function (event) {\n      var secret = wm.get(this);\n      var listeners = secret[event.type];\n      if (listeners) {\n        define(event, 'target', this);\n        define(event, 'currentTarget', this);\n        listeners.slice(0).some(dispatch, event);\n        delete event.currentTarget;\n        delete event.target;\n      }\n      return true;\n    });\n    define(proto, 'removeEventListener', function (type, listener) {\n      for (var\n        secret = wm.get(this),\n        /* istanbul ignore next */\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener) {\n          listeners.splice(i, 1);\n          return;\n        }\n      }\n    });\n    self.EventTarget = EventTarget;\n    function EventTarget() {'use strict';\n      wm.set(this, create(null));\n    }\n    function define(target, name, value) {\n      defineProperty(\n        target,\n        name,\n        {\n          configurable: true,\n          writable: true,\n          value: value\n        }\n      );\n    }\n    function dispatch(info) {\n      var options = info.options;\n      if (options && options.once)\n        info.target.removeEventListener(this.type, info.listener);\n      if (typeof info.listener === 'function')\n        info.listener.call(info.target, this);\n      else\n        info.listener.handleEvent(this);\n      return this._stopImmediatePropagationFlag;\n    }\n  }(Object, new WeakMap));\n}\nexport default self.EventTarget;\n","import EventTarget from \"@ungap/event-target\";\nexport var MediaBreakpoint = /*#__PURE__*/function (MediaBreakpoint) {\n  MediaBreakpoint[\"xLarge\"] = \"xLarge\";\n  MediaBreakpoint[\"large\"] = \"large\";\n  MediaBreakpoint[\"medium\"] = \"medium\";\n  MediaBreakpoint[\"small\"] = \"small\";\n  MediaBreakpoint[\"xSmall\"] = \"xSmall\";\n  return MediaBreakpoint;\n}({});\nexport var mediaBreakpointMinWidthMap = new Map([[MediaBreakpoint.xLarge, \"1920px\"], [MediaBreakpoint.large, \"1600px\"], [MediaBreakpoint.medium, \"1280px\"], [MediaBreakpoint.small, \"1024px\"], [MediaBreakpoint.xSmall, 0]]);\nexport var mediaEventTarget = new EventTarget();\nvar breakpointMatchesMap = {};\nvar MEDIA = {};\nfunction handleMatchesChange(data, breakpoint) {\n  var changed = false;\n  breakpointMatchesMap[breakpoint] = data.matches;\n  for (var [_breakpoint] of mediaBreakpointMinWidthMap) {\n    if (breakpointMatchesMap[_breakpoint] && MEDIA.breakpoint !== _breakpoint) {\n      MEDIA.breakpoint = _breakpoint;\n      changed = true;\n      break;\n    }\n  }\n  if (changed) {\n    mediaEventTarget.dispatchEvent(new CustomEvent(\"change\", {\n      detail: MEDIA\n    }));\n  }\n}\nmediaBreakpointMinWidthMap.forEach((minWidth, breakpoint) => {\n  var mediaQueryList = window.matchMedia(\"(min-width: \".concat(minWidth, \")\"));\n  handleMatchesChange(mediaQueryList, breakpoint);\n  if (mediaQueryList.addEventListener) {\n    mediaQueryList.addEventListener(\"change\", event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  } else {\n    mediaQueryList.addListener(event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  }\n});\nexport var getMedia = () => MEDIA;\n//# sourceMappingURL=mediaQuery.js.map","export function getStorageItem(storageType) {\n  return function (name) {\n    var _storage$getItem;\n    var storage = storageType === \"local\" ? localStorage : sessionStorage;\n    return JSON.parse((_storage$getItem = storage.getItem(name)) !== null && _storage$getItem !== void 0 ? _storage$getItem : \"null\");\n  };\n}\n//# sourceMappingURL=getStorageItem.js.map","import { orderBy } from \"lodash\";\nimport { getRuntime } from \"./Runtime.js\";\nexport function matchStoryboard(storyboards, pathname) {\n  // Put apps with longer homepage before shorter ones.\n  // E.g., `/legacy/tool` will match first before `/legacy`.\n  // This enables two apps with relationship of parent-child of homepage.\n  var sortedStoryboards = orderBy(storyboards, storyboard => {\n    var _storyboard$app$homep, _storyboard$app, _storyboard$app$homep2;\n    return (_storyboard$app$homep = (_storyboard$app = storyboard.app) === null || _storyboard$app === void 0 ? void 0 : (_storyboard$app$homep2 = _storyboard$app.homepage) === null || _storyboard$app$homep2 === void 0 ? void 0 : _storyboard$app$homep2.length) !== null && _storyboard$app$homep !== void 0 ? _storyboard$app$homep : 0;\n  }, \"desc\");\n  for (var storyboard of sortedStoryboards) {\n    var homepage = storyboard.app.homepage;\n    if (typeof homepage === \"string\" && homepage[0] === \"/\") {\n      if (homepage === \"/\" ? pathname === homepage : \"\".concat(pathname.replace(/\\/+$/, \"\"), \"/\").startsWith(\"\".concat(homepage.replace(/\\/+$/, \"\"), \"/\"))) {\n        return storyboard;\n      }\n    }\n  }\n}\n\n/**\n * We say it's an outside app when at least one of the below conditions are true:\n *   - target app is not found.\n *   - target app is not the current app.\n *   - current app is non-standalone mode and target app is standalone mode.\n *\n * Note: when current app is standalone mode, other apps will not be found.\n */\nexport function isOutsideApp(storyboard) {\n  var _getRuntime$getCurren;\n  if (process.env.NODE_ENV === \"test\") {\n    return false;\n  }\n  return !storyboard ||\n  // Sometimes `storyboard.app.standaloneMode` is incorrect.\n  ((_getRuntime$getCurren = getRuntime().getCurrentApp()) === null || _getRuntime$getCurren === void 0 ? void 0 : _getRuntime$getCurren.id) !== storyboard.app.id && !window.STANDALONE_MICRO_APPS && storyboard.app.standaloneMode;\n}\n//# sourceMappingURL=matchStoryboard.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"extraQuery\", \"clear\", \"keepHash\"];\nimport { parsePath } from \"history\";\nimport { getBasePath } from \"../getBasePath.js\";\nimport { _internalApiMatchStoryboard } from \"./Runtime.js\";\nimport { isOutsideApp } from \"./matchStoryboard.js\";\nvar blocked = false;\nexport function getUserConfirmation(message, callback) {\n  blocked = !confirm(message);\n  callback(!blocked);\n}\nexport function historyExtended(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function push(location, state, callback) {\n    blocked = false;\n    originalPush(location, state);\n    callback === null || callback === void 0 ? void 0 : callback(blocked);\n  }\n  function replace(location, state, callback) {\n    blocked = false;\n    originalReplace(location, state);\n    callback === null || callback === void 0 ? void 0 : callback(blocked);\n  }\n  function updateQueryFactory(method) {\n    return function updateQuery(query) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var {\n          extraQuery,\n          clear,\n          keepHash\n        } = options,\n        state = _objectWithoutProperties(options, _excluded);\n      var urlSearchParams = new URLSearchParams(clear ? \"\" : browserHistory.location.search);\n      var params = {};\n      Object.assign(params, query, extraQuery);\n      for (var [key, value] of Object.entries(params)) {\n        if (Array.isArray(value)) {\n          urlSearchParams.delete(key);\n          for (var item of value) {\n            urlSearchParams.append(key, item);\n          }\n        } else if (value === undefined || value === null || value === \"\") {\n          urlSearchParams.delete(key);\n        } else {\n          urlSearchParams.set(key, value);\n        }\n      }\n      (method === \"push\" ? push : replace)(\"?\".concat(urlSearchParams.toString()).concat(keepHash ? browserHistory.location.hash : \"\"), state, callback);\n    };\n  }\n  function pushAnchor(hash, state, callback) {\n    push(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      key: undefined,\n      hash,\n      state: _objectSpread({\n        // The default notify is false\n        notify: false\n      }, state)\n    }), undefined, callback);\n  }\n  function reload(callback) {\n    replace(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      state: _objectSpread(_objectSpread({}, browserHistory.location.state), {}, {\n        // Always notify\n        notify: true\n      })\n    }), undefined, callback);\n  }\n  var blockMessage;\n  function setBlockMessage(message) {\n    blockMessage = message;\n  }\n  function getBlockMessage() {\n    return blockMessage;\n  }\n  function unblock() {\n    blockMessage = undefined;\n  }\n  return _objectSpread({\n    pushQuery: updateQueryFactory(\"push\"),\n    replaceQuery: updateQueryFactory(\"replace\"),\n    pushAnchor: pushAnchor,\n    reload,\n    setBlockMessage,\n    getBlockMessage,\n    unblock\n  }, historyOverridden(_objectSpread(_objectSpread({}, browserHistory), {}, {\n    push,\n    replace\n  })));\n}\n\n/**\n * Override history for standalone micro apps.\n *\n * when `push` or `replace` to other apps, force page refresh.\n */\nfunction historyOverridden(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function updateFactory(method) {\n    return function update(path, state, callback) {\n      var pathname;\n      var pathIsString = typeof path === \"string\";\n      if (pathIsString) {\n        pathname = parsePath(path).pathname;\n      } else {\n        pathname = path.pathname;\n      }\n\n      // When history.push or history.replace is performing with an absolute pathname,\n      // force load the target page when it is a page of an outside app.\n      if (typeof pathname === \"string\" && pathname.startsWith(\"/\") && isOutsideApp(_internalApiMatchStoryboard(pathname))) {\n        // Going to outside apps.\n        return location[method === \"push\" ? \"assign\" : \"replace\"](pathIsString ? getBasePath() + path.substring(1) : browserHistory.createHref(path));\n      }\n      return (method === \"push\" ? originalPush : originalReplace)(path, state, callback);\n    };\n  }\n  return {\n    push: updateFactory(\"push\"),\n    replace: updateFactory(\"replace\")\n  };\n}\n\n/**\n * 扩展的系统会话对象。\n */\n\n/**\n * 更新指定的 query 参数。\n *\n * @param query - 要更新的 query 参数。\n * @param options - 选项。\n */\n\n/** 更新 query 参数时的选项 */\n\n/**\n * 设置指定的 anchor （URL hash）地址，此方法默认不会触发页面重新渲染。\n * 往浏览器会话历史栈中推入一条新记录。\n *\n * @param hash - Hash 地址。\n * @param state - 会话状态设置。\n */\n//# sourceMappingURL=historyExtended.js.map","import { createBrowserHistory } from \"history\";\nimport { getBasePath } from \"./getBasePath.js\";\nimport { getUserConfirmation, historyExtended } from \"./internal/historyExtended.js\";\nvar history;\nexport function createHistory() {\n  if (!history) {\n    // https://github.com/remix-run/history/issues/810\n    var browserHistory = createBrowserHistory({\n      basename: getBasePath().replace(/\\/$/, \"\"),\n      getUserConfirmation\n    });\n    Object.assign(browserHistory, historyExtended(browserHistory));\n    history = browserHistory;\n  }\n  return history;\n}\nexport function getHistory() {\n  return history;\n}\n//# sourceMappingURL=history.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { i18n, initializeI18n } from \"@next-core/i18n\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport moment from \"moment\";\nimport \"moment/locale/zh-cn.js\";\nimport { createHistory } from \"../history.js\";\nimport { matchStoryboard } from \"./matchStoryboard.js\";\nimport { Router } from \"./Router.js\";\nimport { loadCheckLogin } from \"./loadCheckLogin.js\";\nimport { loadBootstrapData } from \"./loadBootstrapData.js\";\nimport { NS, locales } from \"./i18n.js\";\nimport { loadNotificationService } from \"../Notification.js\";\nimport { loadDialogService } from \"../Dialog.js\";\nimport { injectedBootstrapData } from \"./bootstrapData.js\";\nvar runtime;\n\n// Allow inject bootstrap data in a runtime other than Brick Next.\nvar bootstrapData = injectedBootstrapData;\nvar router;\nexport function createRuntime() {\n  if (runtime) {\n    throw new Error(\"Cannot create multiple runtimes\");\n  }\n  initializeI18n(NS, locales);\n  moment.locale(i18n.language);\n  i18n.on(\"languageChanged\", () => {\n    moment.locale(i18n.language);\n  });\n  createHistory();\n  runtime = new Runtime();\n  return runtime;\n}\nexport function getRuntime() {\n  return runtime;\n}\nexport class Runtime {\n  bootstrap() {\n    return _asyncToGenerator(function* () {\n      var [, _bootstrapData] = yield Promise.all([loadCheckLogin(), loadBootstrapData()]);\n      bootstrapData = _bootstrapData;\n      // Todo: allow configuration of notification bricks.\n      loadNotificationService(\"shoelace.show-notification\");\n      loadDialogService(\"shoelace.show-dialog\");\n      router = new Router(_bootstrapData.storyboards);\n      yield router.bootstrap();\n    })();\n  }\n  getRecentApps() {\n    var _router$getRecentApps, _router;\n    return (_router$getRecentApps = (_router = router) === null || _router === void 0 ? void 0 : _router.getRecentApps()) !== null && _router$getRecentApps !== void 0 ? _router$getRecentApps : {};\n  }\n  getCurrentApp() {\n    var _router2;\n    return (_router2 = router) === null || _router2 === void 0 ? void 0 : _router2.getRecentApps().currentApp;\n  }\n  getFeatureFlags() {\n    var _bootstrapData2, _bootstrapData2$setti, _router3, _router3$getRecentApp, _router3$getRecentApp2, _router3$getRecentApp3;\n    return _objectSpread(_objectSpread(_objectSpread({}, (_bootstrapData2 = bootstrapData) === null || _bootstrapData2 === void 0 ? void 0 : (_bootstrapData2$setti = _bootstrapData2.settings) === null || _bootstrapData2$setti === void 0 ? void 0 : _bootstrapData2$setti.featureFlags), (_router3 = router) === null || _router3 === void 0 ? void 0 : (_router3$getRecentApp = _router3.getRecentApps().currentApp) === null || _router3$getRecentApp === void 0 ? void 0 : (_router3$getRecentApp2 = _router3$getRecentApp.config) === null || _router3$getRecentApp2 === void 0 ? void 0 : (_router3$getRecentApp3 = _router3$getRecentApp2.settings) === null || _router3$getRecentApp3 === void 0 ? void 0 : _router3$getRecentApp3.featureFlags), {}, {\n      \"migrate-to-brick-next-v3\": true\n    });\n  }\n  getMiscSettings() {\n    var _bootstrapData3, _bootstrapData3$setti, _router4, _router4$getRecentApp, _router4$getRecentApp2, _router4$getRecentApp3;\n    return _objectSpread(_objectSpread({}, (_bootstrapData3 = bootstrapData) === null || _bootstrapData3 === void 0 ? void 0 : (_bootstrapData3$setti = _bootstrapData3.settings) === null || _bootstrapData3$setti === void 0 ? void 0 : _bootstrapData3$setti.misc), (_router4 = router) === null || _router4 === void 0 ? void 0 : (_router4$getRecentApp = _router4.getRecentApps().currentApp) === null || _router4$getRecentApp === void 0 ? void 0 : (_router4$getRecentApp2 = _router4$getRecentApp.config) === null || _router4$getRecentApp2 === void 0 ? void 0 : (_router4$getRecentApp3 = _router4$getRecentApp2.settings) === null || _router4$getRecentApp3 === void 0 ? void 0 : _router4$getRecentApp3.misc);\n  }\n  getBrandSettings() {\n    var _bootstrapData4, _bootstrapData4$setti;\n    return _objectSpread({\n      base_title: \"DevOps 管理专家\"\n    }, (_bootstrapData4 = bootstrapData) === null || _bootstrapData4 === void 0 ? void 0 : (_bootstrapData4$setti = _bootstrapData4.settings) === null || _bootstrapData4$setti === void 0 ? void 0 : _bootstrapData4$setti.brand);\n  }\n  getLaunchpadSettings() {\n    var _bootstrapData5, _bootstrapData5$setti;\n    return _objectSpread({\n      columns: 7,\n      rows: 4\n    }, (_bootstrapData5 = bootstrapData) === null || _bootstrapData5 === void 0 ? void 0 : (_bootstrapData5$setti = _bootstrapData5.settings) === null || _bootstrapData5$setti === void 0 ? void 0 : _bootstrapData5$setti.launchpad);\n  }\n  getDesktops() {\n    var _bootstrapData$deskto, _bootstrapData6;\n    return (_bootstrapData$deskto = (_bootstrapData6 = bootstrapData) === null || _bootstrapData6 === void 0 ? void 0 : _bootstrapData6.desktops) !== null && _bootstrapData$deskto !== void 0 ? _bootstrapData$deskto : [];\n  }\n  getLaunchpadSiteMap() {\n    var _bootstrapData$siteSo, _bootstrapData7;\n    return (_bootstrapData$siteSo = (_bootstrapData7 = bootstrapData) === null || _bootstrapData7 === void 0 ? void 0 : _bootstrapData7.siteSort) !== null && _bootstrapData$siteSo !== void 0 ? _bootstrapData$siteSo : [];\n  }\n  toggleLaunchpadEffect(open) {\n    document.body.classList.toggle(\"launchpad-open\", open);\n  }\n  applyPageTitle(pageTitle) {\n    var baseTitle = this.getBrandSettings().base_title;\n    document.title = pageTitle ? \"\".concat(pageTitle, \" - \").concat(baseTitle) : baseTitle;\n  }\n  getNavConfig() {\n    var _router5;\n    return (_router5 = router) === null || _router5 === void 0 ? void 0 : _router5.getNavConfig();\n  }\n}\nexport function _internalApiSetBootstrapData(data) {\n  bootstrapData = data;\n}\nexport function getBrickPackages() {\n  var _bootstrapData$brickP, _bootstrapData8;\n  return (_bootstrapData$brickP = (_bootstrapData8 = bootstrapData) === null || _bootstrapData8 === void 0 ? void 0 : _bootstrapData8.brickPackages) !== null && _bootstrapData$brickP !== void 0 ? _bootstrapData$brickP : [];\n}\nexport function _internalApiLoadBricks(bricks) {\n  return loadBricksImperatively(bricks, getBrickPackages());\n}\nexport function _internalApiGetRenderId() {\n  var _router6;\n  return (_router6 = router) === null || _router6 === void 0 ? void 0 : _router6.getRenderId();\n}\nexport function _internalApiMatchStoryboard(pathname) {\n  var _bootstrapData$storyb, _bootstrapData9;\n  return matchStoryboard((_bootstrapData$storyb = (_bootstrapData9 = bootstrapData) === null || _bootstrapData9 === void 0 ? void 0 : _bootstrapData9.storyboards) !== null && _bootstrapData$storyb !== void 0 ? _bootstrapData$storyb : [], pathname);\n}\nexport function _internalApiGetRuntimeContext() {\n  var _router7;\n  return (_router7 = router) === null || _router7 === void 0 ? void 0 : _router7.getRuntimeContext();\n}\nexport function _internalApiGetStoryboardInBootstrapData(appId) {\n  var _bootstrapData10, _bootstrapData10$stor;\n  return (_bootstrapData10 = bootstrapData) === null || _bootstrapData10 === void 0 ? void 0 : (_bootstrapData10$stor = _bootstrapData10.storyboards) === null || _bootstrapData10$stor === void 0 ? void 0 : _bootstrapData10$stor.find(storyboard => storyboard.app.id === appId);\n}\nexport function _internalApiGetAppInBootstrapData(appId) {\n  var _internalApiGetStoryb;\n  return (_internalApiGetStoryb = _internalApiGetStoryboardInBootstrapData(appId)) === null || _internalApiGetStoryb === void 0 ? void 0 : _internalApiGetStoryb.app;\n}\n//# sourceMappingURL=Runtime.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 通过defaultOrg查找单个契约信息\n * @endpoint POST /api/contract/single_search\n */\nexport var ContractApi_searchSingleContract = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.api_gateway.contract.SearchSingleContract@1.0.0 */(yield http.post(\"api/contract/single_search\", data, options)).data\n    );\n  });\n  return function ContractApi_searchSingleContract(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=searchSingleContract.js.map","var contractsMap = new Map();\nvar widgetContractMap = new Map();\nvar addContract = (contracts, map) => {\n  contracts === null || contracts === void 0 ? void 0 : contracts.forEach(contract => {\n    map.set(\"\".concat(contract.namespaceId, \".\").concat(contract.name), contract);\n  });\n};\nexport function collectContract(contracts) {\n  addContract(contracts, contractsMap);\n}\nexport function collectWidgetContract(contracts) {\n  addContract(contracts, widgetContractMap);\n}\nexport function clearCollectWidgetContract() {\n  widgetContractMap.clear();\n}\nexport function getContract(name) {\n  return contractsMap.get(name) || widgetContractMap.get(name);\n}\n//# sourceMappingURL=CollectContracts.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport yaml from \"js-yaml\";\nimport { ContractApi_searchSingleContract } from \"@next-api-sdk/api-gateway-sdk\";\nimport { getContract } from \"./CollectContracts.js\";\nvar flowApiDefinitionPromiseMap = new Map();\n\n// Legacy Custom API: `${namespace}@${name}`\n// Flow API: `${namespace}@${name}:${version}`\nexport function isFlowApiProvider(provider) {\n  return provider.includes(\"@\");\n}\nexport function getArgsOfFlowApi(_x, _x2, _x3) {\n  return _getArgsOfFlowApi.apply(this, arguments);\n}\nfunction _getArgsOfFlowApi() {\n  _getArgsOfFlowApi = _asyncToGenerator(function* (provider, originalArgs, method) {\n    if (!isFlowApiProvider(provider)) {\n      return originalArgs;\n    }\n    if (!provider.includes(\":\")) {\n      throw new Error(\"You're using legacy Custom API \\\"\".concat(provider, \"\\\" which is dropped in v3, please use Flow API instead\"));\n    }\n    var apiDefinition = yield fetchFlowApiDefinition(provider);\n    if (!apiDefinition) {\n      throw new Error(\"Flow API not found: \\\"\".concat(provider, \"\\\"\"));\n    }\n    var apiProfile = getApiProfileFromApiDefinition(provider, apiDefinition);\n    return getApiArgsFromApiProfile(apiProfile, originalArgs, method);\n  });\n  return _getArgsOfFlowApi.apply(this, arguments);\n}\nfunction getApiArgsFromApiProfile(_ref, originalArgs, method) {\n  var {\n    uri,\n    method: apiMethod,\n    ext_fields,\n    name,\n    namespace,\n    serviceName,\n    responseWrapper,\n    version,\n    isFileType,\n    request\n  } = _ref;\n  var isDownload = isFileType && method === \"saveAs\";\n  var fileName;\n  if (isDownload) {\n    fileName = originalArgs.shift();\n  }\n  var {\n    url,\n    args\n  } = getTransformedUriAndRestArgs(uri, originalArgs, name, namespace, serviceName, version);\n  return [...(isDownload ? [fileName] : []), {\n    url,\n    originalUri: uri,\n    method: apiMethod,\n    ext_fields,\n    responseWrapper,\n    request,\n    isFileType\n  }, ...args];\n}\nfunction getTransformedUriAndRestArgs(uri, originalArgs, name, namespace, serviceName, version) {\n  var prefix = version ? serviceName ? \"api/gateway/\".concat(serviceName) : \"api/gateway/\".concat(namespace, \".\").concat(name, \"@\").concat(version) : \"api/gateway/api_service.\".concat(namespace, \".\").concat(name);\n  var restArgs = originalArgs.slice();\n  var transformedUri = uri.replace(/:([^/]+)/g, () => restArgs.shift());\n  return {\n    url: prefix + transformedUri,\n    args: restArgs\n  };\n}\nfunction getApiProfileFromApiDefinition(provider, api) {\n  var _contract$endpoint, _contract$response;\n  var contract = typeof api.contract === \"string\" ? yaml.safeLoad(api.contract, {\n    schema: yaml.JSON_SCHEMA,\n    json: true\n  }) : api.contract;\n  var {\n    uri,\n    method = \"GET\",\n    ext_fields\n  } = (_contract$endpoint = contract === null || contract === void 0 ? void 0 : contract.endpoint) !== null && _contract$endpoint !== void 0 ? _contract$endpoint : {};\n  var responseWrapper = contract !== null && contract !== void 0 && contract.response ? contract.response.wrapper !== false : false;\n  if (!uri) {\n    throw new Error(\"Missing endpoint.uri in contract of provider \\\"\".concat(provider, \"\\\"\"));\n  }\n  return {\n    uri,\n    method: method.toLowerCase() === \"list\" ? \"get\" : method,\n    ext_fields,\n    name: api.name,\n    namespace: api.namespace,\n    serviceName: api.serviceName,\n    version: api.version,\n    isFileType: (contract === null || contract === void 0 ? void 0 : (_contract$response = contract.response) === null || _contract$response === void 0 ? void 0 : _contract$response.type) === \"file\",\n    responseWrapper,\n    request: contract === null || contract === void 0 ? void 0 : contract.request\n  };\n}\nfunction fetchFlowApiDefinition(provider) {\n  var promise = flowApiDefinitionPromiseMap.get(provider);\n  if (!promise) {\n    promise = _fetchFlowApiDefinition(provider);\n    flowApiDefinitionPromiseMap.set(provider, promise);\n  }\n  return promise;\n}\nfunction _fetchFlowApiDefinition(_x4) {\n  return _fetchFlowApiDefinition2.apply(this, arguments);\n}\nfunction _fetchFlowApiDefinition2() {\n  _fetchFlowApiDefinition2 = _asyncToGenerator(function* (provider) {\n    var [namespaceName, nameWithVersion] = provider.split(\"@\");\n    var [name, version] = nameWithVersion.split(\":\");\n    var contract = getContract(\"\".concat(namespaceName, \".\").concat(name));\n    if (contract) {\n      return {\n        name: contract.name,\n        namespace: contract.namespaceId,\n        serviceName: contract.serviceName,\n        version: contract.version,\n        contract: {\n          endpoint: contract.endpoint,\n          response: contract.response,\n          request: contract.request\n        }\n      };\n    } else {\n      var {\n        contractData\n      } = yield ContractApi_searchSingleContract({\n        contractName: \"\".concat(namespaceName, \".\").concat(name),\n        version\n      });\n\n      // return undefined if don't found contract\n      if (contractData) {\n        var _contractData$namespa, _contractData$namespa2;\n        return {\n          name: contractData.name,\n          namespace: (_contractData$namespa = contractData.namespace) === null || _contractData$namespa === void 0 ? void 0 : (_contractData$namespa2 = _contractData$namespa[0]) === null || _contractData$namespa2 === void 0 ? void 0 : _contractData$namespa2.name,\n          serviceName: contractData.serviceName,\n          version: contractData.version,\n          contract: {\n            endpoint: contractData.endpoint,\n            response: contractData.response,\n            request: contractData.request\n          }\n        };\n      }\n    }\n  });\n  return _fetchFlowApiDefinition2.apply(this, arguments);\n}\n//# sourceMappingURL=FlowApi.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { createProviderClass } from \"@next-core/utils/storyboard\";\nimport { http } from \"@next-core/http\";\nimport { isEmpty, isObject } from \"lodash\";\nexport var FLOW_API_PROVIDER = \"core.provider-flow-api\";\nfunction hasFields(ext_fields, type) {\n  return ext_fields.some(item => item.source === type);\n}\nexport function processExtFields(ext_fields) {\n  var hasQueryParams = hasFields(ext_fields, \"query\");\n  var hasBodyParams = hasFields(ext_fields, \"body\");\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  if (hasQueryParams) {\n    if (hasBodyParams) {\n      var [_data, _params, _options] = args;\n      return {\n        data: _data,\n        options: _objectSpread({\n          params: _params\n        }, _options)\n      };\n    }\n    var [params, _options2] = args;\n    return {\n      data: {},\n      options: _objectSpread({\n        params: params\n      }, _options2)\n    };\n  }\n\n  // only hasBodyParams or default\n  var [data, options] = args;\n  return {\n    data,\n    options: options\n  };\n}\nexport function hasFileType(request) {\n  if (!request || request.type !== \"object\") {\n    return false;\n  }\n  var processFields = fields => {\n    return !isEmpty(fields) && fields.some(field => [\"file\", \"file[]\"].includes(field.type) || processFields(field.fields));\n  };\n  return processFields(request.fields);\n}\nexport function transformFormData(data) {\n  if (data instanceof FormData) {\n    return data;\n  }\n  var formData = new FormData();\n  var _loop = function (key) {\n    if (Array.isArray(value)) {\n      value.forEach(v => {\n        formData.append(key, v);\n      });\n    } else if (isObject(value) && !(value instanceof Blob) && !(value instanceof Date)) {\n      Object.entries(value).forEach(_ref => {\n        var [k, v] = _ref;\n        formData.append(\"\".concat(key, \"[\").concat(k, \"]\"), v);\n      });\n    } else {\n      formData.append(key, value);\n    }\n  };\n  for (var [key, value] of Object.entries(data)) {\n    _loop(key);\n  }\n  return formData;\n}\nexport function callFlowApi(_x) {\n  return _callFlowApi.apply(this, arguments);\n}\nfunction _callFlowApi() {\n  _callFlowApi = _asyncToGenerator(function* (_ref2) {\n    var {\n      url,\n      originalUri,\n      method = \"GET\",\n      responseWrapper = true,\n      ext_fields = [],\n      request,\n      isFileType\n    } = _ref2;\n    var isSimpleRequest = [\"get\", \"delete\", \"head\"].includes(method.toLowerCase());\n    var defaultOptions = isFileType ? {\n      responseType: \"blob\"\n    } : {};\n    var response;\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n    if (isSimpleRequest) {\n      var _originalUri$match$le, _originalUri$match, _request$fields$lengt, _request$fields;\n      var noParams = originalUri && (request === null || request === void 0 ? void 0 : request.type) === \"object\" ? ((_originalUri$match$le = (_originalUri$match = originalUri.match(/:([^/]+)/g)) === null || _originalUri$match === void 0 ? void 0 : _originalUri$match.length) !== null && _originalUri$match$le !== void 0 ? _originalUri$match$le : 0) === ((_request$fields$lengt = (_request$fields = request.fields) === null || _request$fields === void 0 ? void 0 : _request$fields.length) !== null && _request$fields$lengt !== void 0 ? _request$fields$lengt : 0) : false;\n      var params;\n      var options;\n      if (noParams) {\n        [options] = args;\n      } else {\n        [params, options] = args;\n      }\n      response = yield http.simpleRequest(method, url, _objectSpread(_objectSpread({\n        params\n      }, defaultOptions), options));\n    } else {\n      var isUploadType = hasFileType(request);\n      var result = processExtFields(ext_fields, ...args);\n      response = yield http.requestWithBody(method, url, isUploadType ? transformFormData(result.data) : result.data, _objectSpread(_objectSpread({}, defaultOptions), result.options));\n    }\n    return (isFileType ? false : responseWrapper) ? response.data : response;\n  });\n  return _callFlowApi.apply(this, arguments);\n}\nexport function registerFlowApiProvider() {\n  customElements.define(FLOW_API_PROVIDER, createProviderClass(callFlowApi));\n}\n//# sourceMappingURL=FlowApiProvider.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { isFlowApiProvider } from \"./FlowApi.js\";\nimport { FLOW_API_PROVIDER, registerFlowApiProvider } from \"./FlowApiProvider.js\";\nimport { getBrickPackages } from \"../Runtime.js\";\nvar pool = new Map();\nexport function getProviderBrick(_x) {\n  return _getProviderBrick.apply(this, arguments);\n}\nfunction _getProviderBrick() {\n  _getProviderBrick = _asyncToGenerator(function* (provider) {\n    if (isFlowApiProvider(provider)) {\n      provider = FLOW_API_PROVIDER;\n    }\n    var brick = pool.get(provider);\n    if (brick) {\n      return brick;\n    }\n    if (provider.includes(\"-\") && !customElements.get(provider)) {\n      if (provider === FLOW_API_PROVIDER) {\n        registerFlowApiProvider();\n      } else {\n        yield loadBricksImperatively([provider], getBrickPackages());\n        if (!customElements.get(provider)) {\n          throw new Error(\"Provider not defined: \\\"\".concat(provider, \"\\\".\"));\n        }\n      }\n    }\n    brick = document.createElement(provider);\n    pool.set(provider, brick);\n    return brick;\n  });\n  return _getProviderBrick.apply(this, arguments);\n}\n//# sourceMappingURL=getProviderBrick.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { asyncComputeRealValue } from \"../compute/computeRealValue.js\";\nimport { getProviderBrick } from \"./getProviderBrick.js\";\nimport { getArgsOfFlowApi } from \"./FlowApi.js\";\nvar cache = new Map();\nexport function resolveData(_x, _x2, _x3) {\n  return _resolveData.apply(this, arguments);\n}\nfunction _resolveData() {\n  _resolveData = _asyncToGenerator(function* (resolveConf, runtimeContext, options) {\n    var {\n      useProvider,\n      method = \"resolve\",\n      args = [],\n      onReject\n    } = resolveConf;\n    var legacyProvider = resolveConf.provider;\n    if (legacyProvider && !useProvider) {\n      throw new Error(\"You're using \\\"provider: \".concat(legacyProvider, \"\\\" which is dropped in v3, please use \\\"useProvider\\\" instead\"));\n    }\n    var [providerBrick, actualArgs] = yield Promise.all([getProviderBrick(useProvider), asyncComputeRealValue(args, runtimeContext)]);\n    var promise = resolveByProvider(providerBrick, useProvider, method, actualArgs, options, args);\n    var {\n      transform\n    } = resolveConf;\n    var data;\n    try {\n      data = yield promise;\n      // The fetched data and its inner objects should never be *injected* again.\n      // recursiveMarkAsInjected(data);\n    } catch (error) {\n      if (isHandleRejectByTransform(onReject)) {\n        transform = onReject.transform;\n        data = error;\n      } else {\n        throw error;\n      }\n    }\n    if (!transform) {\n      return data;\n    }\n\n    // Keep backward compatibility of string transform.\n    if (typeof transform === \"string\") {\n      return {\n        [transform]: data\n      };\n    }\n    return asyncComputeRealValue(transform, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      data\n    }));\n  });\n  return _resolveData.apply(this, arguments);\n}\nexport function clearResolveCache() {\n  cache.clear();\n}\nexport function resolveByProvider(_x4, _x5, _x6, _x7, _x8, _x9) {\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction _resolveByProvider() {\n  _resolveByProvider = _asyncToGenerator(function* (brick, useProvider, method, args, options, originalArgs) {\n    var cacheKey;\n    try {\n      // `args` may contain circular references, which makes\n      // JSON stringify failed, thus we fallback to original args.\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        args\n      });\n    } catch (e) {\n      if (!originalArgs) {\n        throw e;\n      }\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        originalArgs\n      });\n    }\n    var promise;\n    if ((options === null || options === void 0 ? void 0 : options.cache) !== \"reload\") {\n      promise = cache.get(cacheKey);\n    }\n    if (!promise) {\n      promise = _asyncToGenerator(function* () {\n        var finalArgs = yield getArgsOfFlowApi(useProvider, args, method);\n        return brick.resolve(...finalArgs);\n      })();\n      cache.set(cacheKey, promise);\n    }\n    return promise;\n  });\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction isHandleRejectByTransform(onReject) {\n  return !!(onReject !== null && onReject !== void 0 && onReject.transform);\n}\n//# sourceMappingURL=resolveData.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { isPreEvaluated } from \"./evaluate.js\";\nimport { resolveData } from \"../data/resolveData.js\";\n\n/**\n * 包含 `if` 条件判断的对象。\n */\n\nexport function asyncCheckIf(_x, _x2) {\n  return _asyncCheckIf.apply(this, arguments);\n}\nfunction _asyncCheckIf() {\n  _asyncCheckIf = _asyncToGenerator(function* (ifContainer, runtimeContext) {\n    return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? yield asyncComputeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n  });\n  return _asyncCheckIf.apply(this, arguments);\n}\nexport function checkIf(ifContainer, runtimeContext) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? computeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n}\nexport function checkIfOfComputed(ifContainer) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!ifContainer.if;\n}\nexport function asyncCheckBrickIf(_x3, _x4) {\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nfunction _asyncCheckBrickIf() {\n  _asyncCheckBrickIf = _asyncToGenerator(function* (brickConf, runtimeContext) {\n    if (isObject(brickConf.if) && !isPreEvaluated(brickConf.if)) {\n      var resolved = yield resolveData(brickConf.if, runtimeContext);\n      return checkIfOfComputed(resolved);\n    }\n    return asyncCheckIf(brickConf, runtimeContext);\n  });\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nexport function checkIfByTransform(ifContainer, data) {\n  return checkIf(ifContainer, {\n    data\n  });\n}\n//# sourceMappingURL=checkIf.js.map","export var StateOfUseBrick = /*#__PURE__*/function (StateOfUseBrick) {\n  StateOfUseBrick[StateOfUseBrick[\"INITIAL\"] = 0] = \"INITIAL\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK\"] = 1] = \"USE_BRICK\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_ITEM\"] = 2] = \"USE_BRICK_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_PROPERTIES\"] = 3] = \"USE_BRICK_PROPERTIES\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_TRANSFORM\"] = 4] = \"USE_BRICK_TRANSFORM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_EVENTS\"] = 5] = \"USE_BRICK_EVENTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_IF\"] = 6] = \"USE_BRICK_IF\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS\"] = 7] = \"USE_BRICK_SLOTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM\"] = 8] = \"USE_BRICK_SLOTS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS\"] = 9] = \"USE_BRICK_SLOTS_ITEM_BRICKS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\"] = 10] = \"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_LIFECYCLE\"] = 11] = \"USE_BRICK_LIFECYCLE\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_DATA_SOURCE\"] = 12] = \"USE_BRICK_DATA_SOURCE\";\n  return StateOfUseBrick;\n}({});\nexport function isLazyContentInUseBrick(state) {\n  switch (state) {\n    case StateOfUseBrick.USE_BRICK_PROPERTIES:\n    case StateOfUseBrick.USE_BRICK_TRANSFORM:\n    case StateOfUseBrick.USE_BRICK_EVENTS:\n    case StateOfUseBrick.USE_BRICK_IF:\n    case StateOfUseBrick.USE_BRICK_LIFECYCLE:\n    case StateOfUseBrick.USE_BRICK_DATA_SOURCE:\n      return true;\n  }\n  return false;\n}\nexport function getNextStateOfUseBrick(state, isArray, key) {\n  if (isLazyContentInUseBrick(state)) {\n    return state;\n  }\n  if (isArray) {\n    switch (state) {\n      case StateOfUseBrick.USE_BRICK:\n        return StateOfUseBrick.USE_BRICK_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM;\n    }\n  } else {\n    switch (state) {\n      case StateOfUseBrick.INITIAL:\n        if (key === \"useBrick\") {\n          return StateOfUseBrick.USE_BRICK;\n        }\n        break;\n      case StateOfUseBrick.USE_BRICK:\n      case StateOfUseBrick.USE_BRICK_ITEM:\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:\n        {\n          switch (key) {\n            case \"properties\":\n              return StateOfUseBrick.USE_BRICK_PROPERTIES;\n            case \"transform\":\n              return StateOfUseBrick.USE_BRICK_TRANSFORM;\n            case \"dataSource\":\n              return StateOfUseBrick.USE_BRICK_DATA_SOURCE;\n            case \"events\":\n              return StateOfUseBrick.USE_BRICK_EVENTS;\n            case \"slots\":\n              return StateOfUseBrick.USE_BRICK_SLOTS;\n            case \"children\":\n              return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n            case \"if\":\n              return StateOfUseBrick.USE_BRICK_IF;\n            case \"lifeCycle\":\n              return StateOfUseBrick.USE_BRICK_LIFECYCLE;\n          }\n          break;\n        }\n      case StateOfUseBrick.USE_BRICK_SLOTS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM:\n        if (key === \"bricks\") {\n          return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n        }\n        break;\n    }\n  }\n  return StateOfUseBrick.INITIAL;\n}\n//# sourceMappingURL=getNextStateOfUseBrick.js.map","import { isEvaluable } from \"@next-core/cook\";\nimport { track } from \"@next-core/utils/storyboard\";\nimport { getPreEvaluatedRaw, isPreEvaluated } from \"./evaluate.js\";\nexport function getTracks(value) {\n  var contextNames = false;\n  var stateNames = false;\n  var formStateNames = false;\n  if (typeof value === \"string\" ? isEvaluable(value) : isPreEvaluated(value)) {\n    var raw = typeof value === \"string\" ? value : getPreEvaluatedRaw(value);\n    contextNames = track(raw, \"track context\", \"CTX\");\n    stateNames = track(raw, \"track state\", \"STATE\");\n    formStateNames = track(raw, \"track formstate\", \"FORM_STATE\");\n  }\n  return {\n    contextNames,\n    stateNames,\n    formStateNames\n  };\n}\n//# sourceMappingURL=getTracks.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"pendingPermissionsPreCheck\", \"tplStateStoreMap\", \"tplStateStoreScope\"];\nimport { cook, preevaluate, shouldAllowRecursiveEvaluations } from \"@next-core/cook\";\nimport { loadProcessorsImperatively } from \"@next-core/loader\";\nimport { supply } from \"@next-core/supply\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport { cloneDeep } from \"lodash\";\nimport { customProcessors } from \"../../CustomProcessors.js\";\nimport { checkPermissionsUsage, storyboardFunctions } from \"./StoryboardFunctions.js\";\nimport { getGeneralGlobals } from \"./getGeneralGlobals.js\";\nimport { getDynamicReadOnlyProxy, getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getDevHook } from \"../devtools.js\";\nimport { getMedia } from \"../mediaQuery.js\";\nimport { getStorageItem } from \"./getStorageItem.js\";\nimport { getBrickPackages, getRuntime } from \"../Runtime.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { widgetFunctions } from \"./WidgetFunctions.js\";\nimport { collectAppGetMenuUsage, collectInstalledAppsHasUsage } from \"./collectMemberCallUsage.js\";\nimport { fetchMenuById, getMenuById } from \"../menu/fetchMenuById.js\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { widgetImagesFactory } from \"./images.js\";\nimport { hasInstalledApp, waitForCheckingApps } from \"../checkInstalledApps.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nvar symbolForRaw = Symbol.for(\"pre.evaluated.raw\");\nvar symbolForContext = Symbol.for(\"pre.evaluated.context\");\nexport function isPreEvaluated(raw) {\n  return !!(raw !== null && raw !== void 0 && raw[symbolForRaw]);\n}\nexport function getPreEvaluatedRaw(pre) {\n  return pre[symbolForRaw];\n}\nexport function shouldDismissMarkingComputed(raw) {\n  if (typeof raw === \"string\") {\n    return shouldAllowRecursiveEvaluations(raw);\n  }\n  return shouldAllowRecursiveEvaluations(raw[symbolForRaw]);\n}\nvar possibleErrorConstructs = new WeakSet([SyntaxError, TypeError, ReferenceError]);\nexport function getCookErrorConstructor(error) {\n  return possibleErrorConstructs.has(error.constructor) ? error.constructor : TypeError;\n}\nexport function asyncEvaluate(_x, _x2, _x3) {\n  return _asyncEvaluate.apply(this, arguments);\n}\nfunction _asyncEvaluate() {\n  _asyncEvaluate = _asyncToGenerator(function* (raw,\n  // string or pre-evaluated object.\n  runtimeContext, options) {\n    var {\n      blockingList,\n      run\n    } = lowLevelEvaluate(raw, runtimeContext, options, true);\n    yield Promise.all(blockingList);\n    return run();\n  });\n  return _asyncEvaluate.apply(this, arguments);\n}\nexport function evaluate(raw,\n// string or pre-evaluated object.\nruntimeContext, options) {\n  var {\n    run\n  } = lowLevelEvaluate(raw, runtimeContext, options, false);\n  return run();\n}\nfunction lowLevelEvaluate(raw,\n// string or pre-evaluated object.\nruntimeContext) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var isAsync = arguments.length > 3 ? arguments[3] : undefined;\n  var blockingList = [];\n  if (typeof raw !== \"string\") {\n    // If the `raw` is not a string, it must be a pre-evaluated object.\n    // Then fulfil the context, and restore the original `raw`.\n\n    var {\n        pendingPermissionsPreCheck: _1,\n        tplStateStoreMap: _2,\n        tplStateStoreScope: _3\n      } = runtimeContext,\n      passByRuntimeContext = _objectWithoutProperties(runtimeContext, _excluded);\n    runtimeContext = _objectSpread(_objectSpread({}, raw[symbolForContext]), passByRuntimeContext);\n    raw = raw[symbolForRaw];\n  }\n\n  // Collect `APP.getMenu(...)` usage before evaluating.\n  var menuUsage = {\n    usedArgs: new Set()\n  };\n  var hasAppUsage = {\n    usedArgs: new Set()\n  };\n\n  // A `SyntaxError` maybe thrown.\n  var precooked;\n  try {\n    precooked = preevaluate(raw, {\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal(node, parent) {\n          collectAppGetMenuUsage(menuUsage, node, parent);\n          collectInstalledAppsHasUsage(hasAppUsage, node, parent);\n        }\n      }\n    });\n  } catch (error) {\n    var message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n    // if (options.isReEvaluation) {\n    //   devtoolsHookEmit(\"re-evaluation\", {\n    //     id: options.evaluationId,\n    //     detail: { raw, context: {} },\n    //     error: message,\n    //   });\n    //   return;\n    // } else {\n    var errorConstructor = getCookErrorConstructor(error);\n    throw new errorConstructor(message);\n    // }\n  }\n\n  if (menuUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"APP.getMenu\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  if (hasAppUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"INSTALLED_APPS.has\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  var globalVariables = {};\n  var {\n    attemptToVisitGlobals\n  } = precooked;\n\n  // Ignore evaluating if required `event/DATA` is missing in\n  // context. Since they are are provided in different context, whenever\n  // missing one of them, memorize the current context for later consuming.\n  if (options.lazy || attemptToVisitGlobals.has(\"EVENT\") && !hasOwnProperty(runtimeContext, \"event\") || attemptToVisitGlobals.has(\"DATA\") && !hasOwnProperty(runtimeContext, \"data\")) {\n    return {\n      blockingList,\n      run() {\n        return Object.keys(runtimeContext).length > 0 ? {\n          [symbolForRaw]: raw,\n          [symbolForContext]: runtimeContext\n        } : raw;\n      }\n    };\n  }\n  var usedCtx;\n  var usedProcessors;\n  var usedStates;\n  var tplStateStore;\n  var strict = isStrictMode(runtimeContext);\n\n  // For existed TPL usage, treat it as a STATE.\n  if (attemptToVisitGlobals.has(\"STATE\") || !strict && attemptToVisitGlobals.has(\"TPL\")) {\n    tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(raw, \"\\\"\"));\n  }\n  var devHook = getDevHook();\n  if (isAsync || devHook) {\n    if (attemptToVisitGlobals.has(\"CTX\")) {\n      usedCtx = strictCollectMemberUsage(raw, \"CTX\");\n      isAsync && blockingList.push(runtimeContext.ctxStore.waitFor(usedCtx));\n    }\n    if (tplStateStore) {\n      usedStates = strictCollectMemberUsage(raw, \"STATE\");\n      // istanbul ignore if\n      if (!strict) {\n        var usedTpls = strictCollectMemberUsage(raw, \"TPL\");\n        for (var tpl of usedTpls) {\n          usedStates.add(tpl);\n        }\n      }\n      isAsync && blockingList.push(tplStateStore.waitFor(usedStates));\n    }\n    if (attemptToVisitGlobals.has(\"PROCESSORS\")) {\n      usedProcessors = strictCollectMemberUsage(raw, \"PROCESSORS\", 2);\n      isAsync && blockingList.push(loadProcessorsImperatively(usedProcessors, getBrickPackages()));\n    }\n  }\n  if (isAsync) {\n    var attemptToCheckPermissions = attemptToVisitGlobals.has(\"PERMISSIONS\");\n    // There maybe `PERMISSIONS.check()` usage in functions\n    if (!attemptToCheckPermissions && attemptToVisitGlobals.has(\"FN\")) {\n      var usedFunctions = [...strictCollectMemberUsage(raw, \"FN\")];\n      attemptToCheckPermissions = checkPermissionsUsage(usedFunctions);\n    }\n    if (attemptToCheckPermissions) {\n      blockingList.push(...runtimeContext.pendingPermissionsPreCheck);\n    }\n    if (menuUsage.usedArgs.size > 0) {\n      // Block evaluating if has `APP.getMenu(...)` usage.\n      var usedMenuIds = [...menuUsage.usedArgs];\n      blockingList.push(Promise.all(usedMenuIds.map(menuId => fetchMenuById(menuId, runtimeContext))));\n    }\n    if (hasAppUsage.usedArgs.size > 0) {\n      // Only wait for specific apps\n      blockingList.push(waitForCheckingApps([...hasAppUsage.usedArgs]));\n    }\n  }\n  return {\n    blockingList,\n    run() {\n      var _runtimeContext$overr, _match$params;\n      var {\n        app: currentApp,\n        location,\n        query,\n        match,\n        flags,\n        sys,\n        ctxStore,\n        data,\n        event\n      } = runtimeContext;\n      var app = (_runtimeContext$overr = runtimeContext.overrideApp) !== null && _runtimeContext$overr !== void 0 ? _runtimeContext$overr : currentApp;\n      for (var variableName of attemptToVisitGlobals) {\n        switch (variableName) {\n          // case \"ALIAS\":\n          case \"ANCHOR\":\n            globalVariables[variableName] = location.hash ? location.hash.substring(1) : null;\n            break;\n          case \"APP\":\n            globalVariables[variableName] = _objectSpread(_objectSpread({}, cloneDeep(app)), {}, {\n              getMenu: getMenuById\n            });\n            break;\n          case \"CTX\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return ctxStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedCtx);\n              }\n            });\n            break;\n          case \"DATA\":\n            globalVariables[variableName] = data;\n            break;\n          case \"EVENT\":\n            globalVariables[variableName] = event;\n            break;\n          case \"FLAGS\":\n            globalVariables[variableName] = getReadOnlyProxy(flags);\n            break;\n          case \"HASH\":\n            globalVariables[variableName] = location.hash;\n            break;\n          case \"INSTALLED_APPS\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              has: hasInstalledApp\n            });\n            break;\n          case \"ITEM\":\n            if (!hasOwnProperty(runtimeContext, \"forEachItem\")) {\n              // eslint-disable-next-line no-console\n              console.error(\"Using `ITEM` but no `:forEach` is found, check your expression: \\\"\".concat(raw, \"\\\"\"));\n            } else {\n              globalVariables[variableName] = runtimeContext.forEachItem;\n            }\n            break;\n          case \"LOCAL_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"local\")\n            });\n            break;\n          case \"MEDIA\":\n            globalVariables[variableName] = getReadOnlyProxy(getMedia());\n            break;\n          case \"MISC\":\n            globalVariables[variableName] = getRuntime().getMiscSettings();\n            break;\n          case \"PARAMS\":\n            globalVariables[variableName] = new URLSearchParams(query);\n            break;\n          case \"PATH\":\n            globalVariables[variableName] = getReadOnlyProxy((_match$params = match === null || match === void 0 ? void 0 : match.params) !== null && _match$params !== void 0 ? _match$params : {});\n            break;\n          case \"PATH_NAME\":\n            globalVariables[variableName] = location.pathname;\n            break;\n          case \"PROCESSORS\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                var pkg = customProcessors.get(key);\n                if (!pkg) {\n                  throw new Error(\"'PROCESSORS.\".concat(key, \"' is not registered! Have you installed the relevant brick package?\"));\n                }\n                return getDynamicReadOnlyProxy({\n                  get(t, k) {\n                    return pkg.get(k);\n                  },\n                  ownKeys() {\n                    return Array.from(pkg.keys());\n                  }\n                });\n              },\n              ownKeys() {\n                return Array.from(usedProcessors);\n              }\n            });\n            break;\n          case \"QUERY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.get(key)]));\n            break;\n          case \"QUERY_ARRAY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.getAll(key)]));\n            // case \"SEGUE\":\n            break;\n          case \"SESSION_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"session\")\n            });\n            break;\n          // istanbul ignore next\n          case \"TPL\":\n            warnAboutStrictMode(strict, 'Using \"TPL\" in expression', \"check your expression: \\\"\".concat(raw, \"\\\"\"));\n            if (strict) {\n              break;\n            }\n          // eslint-disable-next-line no-fallthrough\n          case \"STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return tplStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedStates);\n              }\n            });\n            break;\n          case \"SYS\":\n            globalVariables[variableName] = getReadOnlyProxy(sys !== null && sys !== void 0 ? sys : {});\n            break;\n          case \"__WIDGET_FN__\":\n            globalVariables[variableName] = widgetFunctions;\n            break;\n          case \"__WIDGET_IMG__\":\n            globalVariables[variableName] = widgetImagesFactory;\n            break;\n          case \"__WIDGET_I18N__\":\n            globalVariables[variableName] = widgetI18nFactory;\n            break;\n        }\n      }\n      Object.assign(globalVariables, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        storyboardFunctions,\n        app: runtimeContext.app,\n        appendI18nNamespace: runtimeContext.appendI18nNamespace\n      }));\n      try {\n        var result = cook(precooked.expression, precooked.source, {\n          globalVariables: supply(precooked.attemptToVisitGlobals, globalVariables)\n        });\n        // const detail = { raw, context: globalVariables, result };\n        // if (options.isReEvaluation) {\n        //   devtoolsHookEmit(\"re-evaluation\", {\n        //     id: options.evaluationId,\n        //     detail,\n        //   });\n        // } else {\n        //   devtoolsHookEmit(\"evaluation\", detail);\n        // }\n        return result;\n      } catch (error) {\n        var _message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n        // if (options.isReEvaluation) {\n        //   devtoolsHookEmit(\"re-evaluation\", {\n        //     id: options.evaluationId,\n        //     detail: { raw, context: globalVariables },\n        //     error: message,\n        //   });\n        // } else {\n        var _errorConstructor = getCookErrorConstructor(error);\n        throw new _errorConstructor(_message);\n        // }\n      }\n    }\n  };\n}\n//# sourceMappingURL=evaluate.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { StateOfUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { getTracks } from \"./getTracks.js\";\nexport function asyncComputeRealProperties(_x, _x2, _x3) {\n  return _asyncComputeRealProperties.apply(this, arguments);\n}\nfunction _asyncComputeRealProperties() {\n  _asyncComputeRealProperties = _asyncToGenerator(function* (properties, runtimeContext, trackingContextList) {\n    if (isObject(properties)) {\n      return Object.fromEntries((yield Promise.all(Object.entries(properties).map( /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (_ref2) {\n          var [propName, propValue] = _ref2;\n          if (Array.isArray(trackingContextList)) {\n            var {\n              contextNames,\n              stateNames,\n              formStateNames\n            } = getTracks(propValue);\n            if (contextNames || stateNames || formStateNames) {\n              trackingContextList.push({\n                contextNames,\n                stateNames,\n                formStateNames,\n                propName,\n                propValue\n              });\n            }\n          }\n          // Related: https://github.com/facebook/react/issues/11347\n          var realValue = yield asyncComputeRealValue(propValue, runtimeContext, {\n            $$lazyForUseBrick: true,\n            $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n          });\n          if (realValue !== undefined) {\n            // For `style` and `dataset`, only object is acceptable.\n            if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n              return [propName, realValue];\n            }\n          }\n        });\n        return function (_x4) {\n          return _ref3.apply(this, arguments);\n        };\n      }()))).filter(Boolean));\n    }\n    return {};\n  });\n  return _asyncComputeRealProperties.apply(this, arguments);\n}\nexport function computeRealProperties(properties, runtimeContext, trackingContextList) {\n  if (isObject(properties)) {\n    return Object.fromEntries(Object.entries(properties).map(_ref => {\n      var [propName, propValue] = _ref;\n      if (Array.isArray(trackingContextList)) {\n        var {\n          contextNames,\n          stateNames,\n          formStateNames\n        } = getTracks(propValue);\n        if (contextNames || stateNames || formStateNames) {\n          trackingContextList.push({\n            contextNames,\n            stateNames,\n            formStateNames,\n            propName,\n            propValue\n          });\n        }\n      }\n      // Related: https://github.com/facebook/react/issues/11347\n      var realValue = computeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      if (realValue !== undefined) {\n        // For `style` and `dataset`, only object is acceptable.\n        if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n          return [propName, realValue];\n        }\n      }\n    }).filter(Boolean));\n  }\n  return {};\n}\n//# sourceMappingURL=computeRealProperties.js.map","export function setRealProperties(brick, realProps) {\n  if (!realProps) {\n    return;\n  }\n  for (var [propName, propValue] of Object.entries(realProps)) {\n    switch (propName) {\n      case \"style\":\n      case \"dataset\":\n        for (var [k, v] of Object.entries(propValue)) {\n          brick[propName][k] = v;\n        }\n        break;\n      case \"constructor\":\n      case \"__proto__\":\n      case \"innerHTML\":\n        // `innerHTML` is dangerous, use `textContent` instead.\n        throw new Error(\"set `\".concat(propName, \"` is prohibited\"));\n      default:\n        brick[propName] = propValue;\n    }\n  }\n}\n//# sourceMappingURL=setRealProperties.js.map","import { computeRealProperties } from \"./computeRealProperties.js\";\nimport { setRealProperties } from \"./setRealProperties.js\";\nexport function setProperties(bricks, properties, runtimeContext) {\n  var realProps = computeRealProperties(properties, runtimeContext);\n  if (!Array.isArray(bricks)) {\n    bricks = [bricks];\n  }\n  bricks.forEach(brick => {\n    setRealProperties(brick, realProps);\n  });\n}\n//# sourceMappingURL=setProperties.js.map","import { getRuntime } from \"./index.js\";\nexport function isStrictMode(runtimeContext) {\n  var _ref, _getRuntime;\n  return !!((_ref = runtimeContext ? runtimeContext.flags : (_getRuntime = getRuntime()) === null || _getRuntime === void 0 ? void 0 : _getRuntime.getFeatureFlags()) !== null && _ref !== void 0 && _ref[\"brick-next-v3-strict-mode\"]);\n}\nexport function warnAboutStrictMode(strict, message) {\n  for (var _len = arguments.length, extraLogs = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    extraLogs[_key - 2] = arguments[_key];\n  }\n  var punctuation = extraLogs.length === 0 ? \"\" : \",\";\n  if (strict) {\n    // eslint-disable-next-line no-console\n    console.error(\"\".concat(message, \" is dropped in v3 strict mode\").concat(punctuation), ...extraLogs);\n  } else {\n    // eslint-disable-next-line no-console\n    console.warn(\"\".concat(message, \" is deprecated in v3 and will be dropped in strict mode\").concat(punctuation), ...extraLogs);\n  }\n}\n//# sourceMappingURL=isStrictMode.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { uniq } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"./isStrictMode.js\";\n\n// Note: `prefix` is a native prop on Element, but it's only used in XML documents.\nvar allowedNativeProps = new Set([\"prefix\"]);\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomTemplateRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(tagName, constructor) {\n    var _constructor$proxy$pr, _constructor$proxy, _compatibleConstructo, _compatibleConstructo2;\n    var registered = _classPrivateFieldGet(this, _registry).has(tagName);\n    if (registered) {\n      // When open launchpad, the storyboard will be updated.\n      // However, we can't *undefine* a custom element.\n      // Just ignore re-registering custom templates.\n      // eslint-disable-next-line no-console\n      console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already registered.\"));\n    } else {\n      registered = !!customElements.get(tagName);\n      if (registered) {\n        // eslint-disable-next-line no-console\n        console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already defined by customElements.\"));\n      }\n    }\n\n    // Transform legacy `proxy.properties[].asVariable` as states.\n    var strict = isStrictMode();\n    var proxyProperties = (_constructor$proxy$pr = (_constructor$proxy = constructor.proxy) === null || _constructor$proxy === void 0 ? void 0 : _constructor$proxy.properties) !== null && _constructor$proxy$pr !== void 0 ? _constructor$proxy$pr : {};\n    var validProxyProps = [];\n    var legacyTplVariables = [];\n    for (var [key, value] of Object.entries(proxyProperties)) {\n      if (value.asVariable) {\n        warnAboutStrictMode(strict, \"Template `asVariable`\", tagName, key);\n        // istanbul ignore next\n        if (!strict) {\n          // For existed TPL usage, treat it as a STATE.\n          legacyTplVariables.push(key);\n        }\n      } else if (value.mergeProperty || value.refTransform) {\n        // eslint-disable-next-line no-console\n        console.error(\"Template `mergeProperty` and `refTransform` are dropped in v3:\", tagName, key);\n      } else if (value.ref) {\n        validProxyProps.push([key, value]);\n      }\n      // Else: documentation only, for exposed states.\n    }\n\n    var compatibleConstructor = _objectSpread(_objectSpread({}, constructor), {}, {\n      proxy: _objectSpread(_objectSpread({}, constructor.proxy), {}, {\n        properties: Object.fromEntries(validProxyProps)\n      }),\n      state: (constructor.state ? strict ? constructor.state : constructor.state.map(item => _objectSpread({\n        // Make `expose` defaults to true in non-strict mode.\n        expose: true\n      }, item)) : []).concat(legacyTplVariables.map(tpl => ({\n        name: tpl,\n        expose: true\n      })))\n    });\n\n    // Now we allow re-register custom template\n    _classPrivateFieldGet(this, _registry).set(tagName, _objectSpread(_objectSpread({}, compatibleConstructor), {}, {\n      name: tagName\n    }));\n    var exposedStates = getExposedStates(compatibleConstructor.state);\n    var proxyMethods = Object.entries((_compatibleConstructo = (_compatibleConstructo2 = compatibleConstructor.proxy) === null || _compatibleConstructo2 === void 0 ? void 0 : _compatibleConstructo2.methods) !== null && _compatibleConstructo !== void 0 ? _compatibleConstructo : {});\n    var props = exposedStates.concat(validProxyProps.map(entry => entry[0]));\n    var methods = proxyMethods.map(entry => entry[0]);\n    var nativeProps = props.concat(methods).filter(prop => prop in HTMLElement.prototype && !allowedNativeProps.has(prop));\n    if (nativeProps.length > 0) {\n      warnAboutStrictMode(strict, \"Using native HTMLElement properties as template properties or methods\", tagName, ...nativeProps);\n      // istanbul ignore next\n      if (strict) {\n        throw new Error(\"In custom template \\\"\".concat(tagName, \"\\\", \").concat(nativeProps.map(p => \"\\\"\".concat(p, \"\\\"\")).join(\", \"), \" are native HTMLElement properties, and should be avoid to be used as brick properties or methods.\"));\n      }\n    }\n    if (registered) {\n      return;\n    }\n    class TplElement extends HTMLElement {\n      get $$typeof() {\n        return \"custom-template\";\n      }\n      static get _dev_only_definedProperties() {\n        return props;\n      }\n      static get _dev_only_definedMethods() {\n        return methods;\n      }\n      $$getElementByRef(ref) {\n        var _this$$$tplStateStore, _this$$$tplStateStore2, _this$$$tplStateStore3, _this$$$tplStateStore4;\n        return (_this$$$tplStateStore = this.$$tplStateStore) === null || _this$$$tplStateStore === void 0 ? void 0 : (_this$$$tplStateStore2 = _this$$$tplStateStore.hostBrick) === null || _this$$$tplStateStore2 === void 0 ? void 0 : (_this$$$tplStateStore3 = _this$$$tplStateStore2.tplHostMetadata) === null || _this$$$tplStateStore3 === void 0 ? void 0 : (_this$$$tplStateStore4 = _this$$$tplStateStore3.internalBricksByRef.get(ref)) === null || _this$$$tplStateStore4 === void 0 ? void 0 : _this$$$tplStateStore4.element;\n      }\n      connectedCallback() {\n        var shadowRoot = this.shadowRoot;\n        if (!shadowRoot) {\n          shadowRoot = this.attachShadow({\n            mode: \"open\"\n          });\n        }\n        var fragment = document.createDocumentFragment();\n        var style = document.createElement(\"style\");\n        style.textContent = \":host{display:block}:host([hidden]){display:none}\";\n        var slot = document.createElement(\"slot\");\n        fragment.appendChild(style);\n        fragment.appendChild(slot);\n        shadowRoot.appendChild(fragment);\n      }\n      disconnectedCallback() {\n        if (this.shadowRoot) {\n          this.shadowRoot.textContent = \"\";\n        }\n      }\n    }\n    var _loop = function (propName) {\n      if (validProxyProps.some(entry => entry[0] === propName)) {\n        // eslint-disable-next-line no-console\n        console.error(\"Cannot define an exposed state that is also a proxy property: \\\"\".concat(propName, \"\\\" in \").concat(tagName));\n        return \"continue\";\n      }\n      Object.defineProperty(TplElement.prototype, propName, {\n        get() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          return this.$$tplStateStore.getValue(propName);\n        },\n        set(value) {\n          var _this$$$tplStateStore5;\n          // 在 mount 过程中，先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n          // 避免初始化的一次 state update 操作及其 onChange 事件。\n          (_this$$$tplStateStore5 = this.$$tplStateStore) === null || _this$$$tplStateStore5 === void 0 ? void 0 : _this$$$tplStateStore5.updateValue(propName, value, \"replace\");\n        },\n        enumerable: true\n      });\n    };\n    for (var propName of exposedStates) {\n      var _ret = _loop(propName);\n      if (_ret === \"continue\") continue;\n    }\n    var _loop2 = function (from, to) {\n      Object.defineProperty(TplElement.prototype, from, {\n        get() {\n          var _to$refProperty;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(to.ref);\n          return element[(_to$refProperty = to.refProperty) !== null && _to$refProperty !== void 0 ? _to$refProperty : from];\n        },\n        set(value) {\n          var _this$$$getElementByR;\n          // 同上 exposedState.set\n          var element = (_this$$$getElementByR = this.$$getElementByRef) === null || _this$$$getElementByR === void 0 ? void 0 : _this$$$getElementByR.call(this, to.ref);\n          if (element) {\n            var _to$refProperty2;\n            element[(_to$refProperty2 = to.refProperty) !== null && _to$refProperty2 !== void 0 ? _to$refProperty2 : from] = value;\n          }\n        },\n        enumerable: true\n      });\n    };\n    for (var [from, to] of validProxyProps) {\n      _loop2(from, to);\n    }\n    var _loop3 = function (_from, _to) {\n      Object.defineProperty(TplElement.prototype, _from, {\n        value() {\n          var _to$refMethod;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(_to.ref);\n          element[(_to$refMethod = _to.refMethod) !== null && _to$refMethod !== void 0 ? _to$refMethod : _from](...arguments);\n        },\n        enumerable: true\n      });\n    };\n    for (var [_from, _to] of proxyMethods) {\n      _loop3(_from, _to);\n    }\n    customElements.define(tagName, TplElement);\n  }\n  get(tagName) {\n    return _classPrivateFieldGet(this, _registry).get(tagName);\n  }\n}\nexport var customTemplates = new CustomTemplateRegistry();\nfunction getExposedStates(state) {\n  var _state$filter$map;\n  // Allow duplicated state names which maybe mutually exclusive.\n  return uniq((_state$filter$map = state === null || state === void 0 ? void 0 : state.filter(item => item.expose).map(item => item.name)) !== null && _state$filter$map !== void 0 ? _state$filter$map : []);\n}\n//# sourceMappingURL=CustomTemplates.js.map","import { customTemplates } from \"../../CustomTemplates.js\";\nexport function getTplStateStore(_ref, using, extraInfo) {\n  var {\n    tplStateStoreId,\n    tplStateStoreMap\n  } = _ref;\n  if (!tplStateStoreId) {\n    throw new Error(\"Using \\\"\".concat(using, \"\\\" outside of a custom template\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\"));\n  }\n  var store = tplStateStoreMap.get(tplStateStoreId);\n  if (!store) {\n    throw new Error(\"Template state store is not found when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return store;\n}\nexport function getTplHostElement(runtimeContext, using, extraInfo) {\n  var store = getTplStateStore(runtimeContext, using, extraInfo);\n  var hostElement = store.hostBrick.element;\n  if (!hostElement) {\n    throw new Error(\"Template host element is gone when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return hostElement;\n}\nexport function getTagNameOfCustomTemplate(brick, appId) {\n  // When a template is registered by an app, it's namespace maybe missed.\n  if (!brick.includes(\".\") && brick.startsWith(\"tpl-\") && appId) {\n    var tagName = \"\".concat(appId, \".\").concat(brick);\n    if (customTemplates.get(tagName)) {\n      return tagName;\n    }\n  }\n  if (customTemplates.get(brick)) {\n    return brick;\n  }\n  return false;\n}\n//# sourceMappingURL=utils.js.map","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \".concat(i));\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \".concat(j));\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \".concat(j));\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \".concat(i));\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \".concat(i));\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a;\n    var defaultPattern = \"[^\".concat(escapeString(options.delimiter || \"/#?\"), \"]+?\");\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \".concat(nextType, \" at \").concat(index, \", expected \").concat(type));\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || defaultPattern,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? defaultPattern : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\".concat(token.pattern, \")$\"), reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not repeat, but got an array\"));\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not be empty\"));\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to be \").concat(typeOfMessage));\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    var groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n    var index = 0;\n    var execResult = groupsRegex.exec(path.source);\n    while (execResult) {\n        keys.push({\n            // Use parenthesized substring match if available, index otherwise\n            name: execResult[1] || index++,\n            prefix: \"\",\n            suffix: \"\",\n            modifier: \"\",\n            pattern: \"\",\n        });\n        execResult = groupsRegex.exec(path.source);\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\".concat(parts.join(\"|\"), \")\"), flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d, _e = options.delimiter, delimiter = _e === void 0 ? \"/#?\" : _e, _f = options.endsWith, endsWith = _f === void 0 ? \"\" : _f;\n    var endsWithRe = \"[\".concat(escapeString(endsWith), \"]|$\");\n    var delimiterRe = \"[\".concat(escapeString(delimiter), \"]\");\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\".concat(prefix, \"((?:\").concat(token.pattern, \")(?:\").concat(suffix).concat(prefix, \"(?:\").concat(token.pattern, \"))*)\").concat(suffix, \")\").concat(mod);\n                    }\n                    else {\n                        route += \"(?:\".concat(prefix, \"(\").concat(token.pattern, \")\").concat(suffix, \")\").concat(token.modifier);\n                    }\n                }\n                else {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        route += \"((?:\".concat(token.pattern, \")\").concat(token.modifier, \")\");\n                    }\n                    else {\n                        route += \"(\".concat(token.pattern, \")\").concat(token.modifier);\n                    }\n                }\n            }\n            else {\n                route += \"(?:\".concat(prefix).concat(suffix, \")\").concat(token.modifier);\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += \"\".concat(delimiterRe, \"?\");\n        route += !options.endsWith ? \"$\" : \"(?=\".concat(endsWithRe, \")\");\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n            : endToken === undefined;\n        if (!strict) {\n            route += \"(?:\".concat(delimiterRe, \"(?=\").concat(endsWithRe, \"))?\");\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\".concat(delimiterRe, \"|\").concat(endsWithRe, \")\");\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","// Ref https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/matchPath.js\n\nimport { pathToRegexp, compile } from \"path-to-regexp\";\nvar cache = new Map();\nvar cacheLimit = 10000;\nvar cacheCount = 0;\nfunction compilePath(path, options) {\n  var cacheKey = \"\".concat(options.end).concat(options.strict).concat(options.sensitive);\n  var pathCache = cache.get(cacheKey);\n  if (!pathCache) {\n    cache.set(cacheKey, pathCache = new Map());\n  }\n  var cacheResult = pathCache.get(path);\n  if (cacheResult) {\n    return cacheResult;\n  }\n  var keys = [];\n  var regexp = pathToRegexp(path, keys, options);\n  var result = {\n    regexp,\n    keys\n  };\n  if (cacheCount < cacheLimit) {\n    pathCache.set(path, result);\n    cacheCount++;\n  }\n  return result;\n}\n\n/**\n * Public API for matching a URL pathname to a path.\n */\nexport function matchPath(pathname, options) {\n  var {\n    path: p,\n    exact = false,\n    strict = false,\n    sensitive = true\n  } = options;\n  var paths = Array.isArray(p) ? p : [p];\n  return paths.reduce((matched, path) => {\n    if (matched) {\n      return matched;\n    }\n    var {\n      regexp,\n      keys\n    } = compilePath(path, {\n      end: exact,\n      strict,\n      sensitive\n    });\n    var match = regexp.exec(pathname);\n    if (!match) {\n      return null;\n    }\n    var [url, ...values] = match;\n    var isExact = pathname === url;\n    if (exact && !isExact) {\n      return null;\n    }\n    var initialParams = {};\n    var result = {\n      path,\n      // the path used to match\n      url: path === \"/\" && url === \"\" ? \"/\" : url,\n      // the matched portion of the URL\n      isExact,\n      // whether or not we matched exactly\n      params: keys.reduce((memo, key, index) => {\n        memo[key.name] = values[index];\n        return memo;\n      }, initialParams)\n    };\n    return result;\n  }, null);\n}\nexport function toPath(path, pathParams) {\n  return compile(path)(pathParams);\n}\n//# sourceMappingURL=matchPath.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { matchPath } from \"./matchPath.js\";\nimport { asyncCheckIf } from \"./compute/checkIf.js\";\nimport { isLoggedIn } from \"../auth.js\";\nexport function matchRoutes(_x, _x2) {\n  return _matchRoutes.apply(this, arguments);\n}\nfunction _matchRoutes() {\n  _matchRoutes = _asyncToGenerator(function* (routes, runtimeContext) {\n    for (var route of routes) {\n      if (typeof route.path !== \"string\") {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid route with invalid path:\", route);\n        throw new Error(\"Invalid route with invalid type of path: \".concat(typeof route.path));\n      }\n      var routePath = route.path.replace(/^\\$\\{APP.homepage\\}/, runtimeContext.app.homepage);\n      var match = matchPath(runtimeContext.location.pathname, {\n        path: routePath,\n        exact: route.exact\n      });\n      if (match && (yield asyncCheckIf(route, runtimeContext))) {\n        if (runtimeContext.app.noAuthGuard || route.public || isLoggedIn()) {\n          return {\n            match,\n            route\n          };\n        }\n        return \"unauthenticated\";\n      }\n    }\n    return \"missed\";\n  });\n  return _matchRoutes.apply(this, arguments);\n}\n//# sourceMappingURL=matchRoutes.js.map","export var symbolForAsyncComputedPropsFromHost = Symbol.for(\"tpl.asyncComputedPropsFromHost\");\nexport var symbolForTplStateStoreId = Symbol.for(\"tpl.stateStoreId\");\nexport var symbolForTPlExternalForEachItem = Symbol.for(\"tpl.externalForEachItem\");\n//# sourceMappingURL=constants.js.map","import { _internalApiLoadBricks } from \"./internal/Runtime.js\";\nvar brick;\nfunction show(options) {\n  if (brick) {\n    return brick.resolve(options);\n  } else {\n    if (options.type === \"confirm\") {\n      if (confirm(options.content)) {\n        return new Promise(resolve => setTimeout(() => {\n          resolve();\n        }, 1));\n      } else {\n        return new Promise((resolve, reject) => setTimeout(() => {\n          reject();\n        }, 1));\n      }\n    } else {\n      alert(options.content);\n      return new Promise(resolve => setTimeout(() => {\n        resolve();\n      }, 1000));\n    }\n  }\n}\nexport function loadDialogService(tagName) {\n  _internalApiLoadBricks([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load dialog service failed:\", error);\n  });\n}\nexport var Dialog = Object.freeze({\n  show\n});\n//# sourceMappingURL=Dialog.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { _internalApiGetRenderId } from \"./Runtime.js\";\nvar timeoutIdList = new Set();\nexport function startPoll(task, _ref, _ref2) {\n  var {\n    progress,\n    success,\n    error,\n    finally: finallyCallback\n  } = _ref;\n  var {\n    interval,\n    leadingRequestDelay,\n    continueOnError,\n    delegateLoadingBar,\n    expectPollEnd,\n    expectPollStopImmediately\n  } = _ref2;\n  var currentRenderId = _internalApiGetRenderId();\n  var currentTimeoutId;\n  function poll() {\n    return _poll.apply(this, arguments);\n  }\n  function _poll() {\n    _poll = _asyncToGenerator(function* () {\n      timeoutIdList.delete(currentTimeoutId);\n      var shouldStop;\n      try {\n        shouldStop = expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately();\n        // Stop polling immediately when the expectation is match before task.\n        if (!shouldStop) {\n          var _result = yield task();\n          // Stop polling immediately when the expectation is match or a different router\n          // is rendering after the task processed.\n          shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n          if (!shouldStop) {\n            progress === null || progress === void 0 ? void 0 : progress(_result);\n            if (expectPollEnd !== null && expectPollEnd !== void 0 && expectPollEnd(_result)) {\n              if (delegateLoadingBar) {\n                window.dispatchEvent(new Event(\"request.end\"));\n              }\n              success === null || success === void 0 ? void 0 : success(_result);\n              finallyCallback === null || finallyCallback === void 0 ? void 0 : finallyCallback();\n            } else {\n              delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n            }\n          }\n        }\n      } catch (e) {\n        // Stop polling immediately when the expectation is match or a different router\n        // is rendering after the task processed.\n        shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n        if (!shouldStop) {\n          error === null || error === void 0 ? void 0 : error(e);\n          if (continueOnError) {\n            delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n          } else {\n            finallyCallback === null || finallyCallback === void 0 ? void 0 : finallyCallback();\n          }\n        }\n      } finally {\n        // Manually dispatch an event of `request.end` when the polling is stopped immediately.\n        if (delegateLoadingBar && shouldStop) {\n          window.dispatchEvent(new Event(\"request.end\"));\n        }\n      }\n    });\n    return _poll.apply(this, arguments);\n  }\n  function delayedPoll(delay) {\n    currentTimeoutId = setTimeout(poll, delay);\n    timeoutIdList.add(currentTimeoutId);\n  }\n  delayedPoll(leadingRequestDelay !== null && leadingRequestDelay !== void 0 ? leadingRequestDelay : 0);\n  if (delegateLoadingBar) {\n    window.dispatchEvent(new Event(\"request.start\"));\n  }\n}\nexport function clearPollTimeout() {\n  for (var timeoutId of timeoutIdList) {\n    clearTimeout(timeoutId);\n  }\n  timeoutIdList.clear();\n}\n//# sourceMappingURL=poll.js.map","export var K = /*#__PURE__*/function (K) {\n  K[\"REQUEST_FAILED\"] = \"REQUEST_FAILED\";\n  K[\"SOMETHING_WENT_WRONG\"] = \"SOMETHING_WENT_WRONG\";\n  K[\"LOGIN_TIMEOUT_MESSAGE\"] = \"LOGIN_TIMEOUT_MESSAGE\";\n  K[\"NETWORK_ERROR\"] = \"NETWORK_ERROR\";\n  return K;\n}({});\nvar en = {\n  [K.REQUEST_FAILED]: \"Request Failed\",\n  [K.SOMETHING_WENT_WRONG]: \"Something went wrong!\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"You haven't logged in or your login session has expired. Login right now?\",\n  [K.NETWORK_ERROR]: \"Network error, please check your network.\"\n};\nvar zh = {\n  [K.REQUEST_FAILED]: \"请求失败\",\n  [K.SOMETHING_WENT_WRONG]: \"出现了一些问题！\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"您还未登录或登录信息已过期，现在重新登录？\",\n  [K.NETWORK_ERROR]: \"网络错误，请检查您的网络连接。\"\n};\nexport var NS = \"core/runtime\";\nexport var locales = {\n  en,\n  zh\n};\n//# sourceMappingURL=i18n.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { HttpAbortError, HttpFetchError, HttpResponseError } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getRuntime } from \"./internal/Runtime.js\";\nimport { getHistory } from \"./history.js\";\nimport { K, NS } from \"./internal/i18n.js\";\nimport { Dialog } from \"./Dialog.js\";\n\n/**\n * 将 http 请求错误转换为可读的字符串。\n *\n * @remarks\n *\n * 将依次尝试读取返回的 JSON 格式数据的字符串类型的 `error` 和 `msg` 字段，如果没有找到则返回 `error.toString()` 的结果。\n *\n * @param error - 错误对象。\n *\n * @returns 转换为字符串的错误信息。\n */\nexport function httpErrorToString(error) {\n  if (error instanceof Event && error.target instanceof HTMLScriptElement) {\n    return error.target.src;\n  }\n  if (error instanceof HttpFetchError) {\n    return i18n.t(\"\".concat(NS, \":\").concat(K.NETWORK_ERROR));\n  }\n  if (error instanceof HttpResponseError) {\n    if (error.responseJson) {\n      if (typeof error.responseJson.error === \"string\") {\n        return error.responseJson.error;\n      } else if (typeof error.responseJson.msg === \"string\") {\n        return error.responseJson.msg;\n      }\n    }\n  }\n  if (error == null) {\n    return \"Unknown error\";\n  }\n  return error.toString();\n}\nexport function isUnauthenticatedError(error) {\n  return error instanceof HttpResponseError && error.response.status === 401 && !!error.responseJson && error.responseJson.code === 100003;\n}\nvar unauthenticatedConfirming = false;\nvar lastErrorMessage;\n\n/**\n * 处理 http 请求错误（使用 AntDesign 模态框弹出错误信息）。\n *\n * @param error - 错误对象。\n */\nexport function handleHttpError(error) {\n  // Do nothing if aborted http requests\n  if (error instanceof HttpAbortError) {\n    return;\n  }\n\n  // Redirect to login page if not logged in.\n  if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n    if (unauthenticatedConfirming) {\n      return;\n    }\n    unauthenticatedConfirming = true;\n    Dialog.show({\n      type: \"confirm\",\n      content: i18n.t(\"\".concat(NS, \":\").concat(K.LOGIN_TIMEOUT_MESSAGE))\n    }).then(() => {\n      redirectToLogin();\n      unauthenticatedConfirming = false;\n    }, () => {\n      unauthenticatedConfirming = false;\n    });\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.error(error);\n  var message = httpErrorToString(error);\n  if (message !== lastErrorMessage) {\n    lastErrorMessage = message;\n    Dialog.show({\n      type: \"error\",\n      title: i18n.t(\"\".concat(NS, \":\").concat(K.REQUEST_FAILED)),\n      content: message,\n      contentStyle: {\n        whiteSpace: \"pre-wrap\"\n      }\n    }).then(() => {\n      lastErrorMessage = undefined;\n    });\n  }\n  return;\n}\nfunction redirectToLogin() {\n  var ssoEnabled = getRuntime().getFeatureFlags()[\"sso-enabled\"];\n  var history = getHistory();\n  history.push(ssoEnabled ? \"/sso-auth/login\" : \"/auth/login\", {\n    from: _objectSpread(_objectSpread({}, history.location), {}, {\n      state: undefined\n    })\n  });\n}\n//# sourceMappingURL=handleHttpError.js.map","import { _internalApiLoadBricks } from \"./internal/Runtime.js\";\nvar brick;\nfunction show(options) {\n  if (brick) {\n    brick.resolve(options);\n  } else {\n    alert(options.message);\n  }\n}\nexport function loadNotificationService(tagName) {\n  _internalApiLoadBricks([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load notification service failed:\", error);\n  });\n}\nexport var Notification = Object.freeze({\n  show\n});\n//# sourceMappingURL=Notification.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { checkIf } from \"./compute/checkIf.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { getHistory } from \"../history.js\";\nimport { getProviderBrick } from \"./data/getProviderBrick.js\";\nimport { startPoll } from \"./poll.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { setProperties } from \"./compute/setProperties.js\";\nimport { applyMode, applyTheme } from \"../themeAndMode.js\";\nimport { getTplHostElement, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { handleHttpError, httpErrorToString } from \"../handleHttpError.js\";\nimport { getArgsOfFlowApi } from \"./data/FlowApi.js\";\nimport { Notification } from \"../Notification.js\";\nexport function bindListeners(brick, eventsMap, runtimeContext) {\n  if (!eventsMap) {\n    return;\n  }\n  Object.entries(eventsMap).forEach(_ref => {\n    var [eventType, handlers] = _ref;\n    var listener = listenerFactory(handlers, runtimeContext, {\n      element: brick\n    });\n    brick.addEventListener(eventType, listener);\n\n    // Remember added listeners for unbinding.\n    if (!brick.$$listeners) {\n      brick.$$listeners = [];\n    }\n    brick.$$listeners.push([eventType, listener]);\n\n    // Remember added listeners for devtools.\n    if (!brick.$$eventListeners) {\n      brick.$$eventListeners = [];\n    }\n    for (var handler of [].concat(handlers)) {\n      brick.$$eventListeners.push([eventType, null, handler]);\n    }\n  });\n}\nexport function unbindListeners(brick) {\n  if (brick.$$listeners) {\n    for (var [eventType, listener] of brick.$$listeners) {\n      brick.removeEventListener(eventType, listener);\n    }\n    brick.$$listeners.length = 0;\n  }\n}\nexport function isBuiltinHandler(handler) {\n  return typeof handler.action === \"string\";\n}\nexport function isUseProviderHandler(handler) {\n  return typeof handler.useProvider === \"string\";\n}\nexport function isCustomHandler(handler) {\n  return !!((handler.target || handler.targetRef) && (handler.method || handler.properties));\n}\nexport function isExecuteCustomHandler(handler) {\n  return !!handler.method;\n}\nexport function isSetPropsCustomHandler(handler) {\n  return !!handler.properties;\n}\nexport function listenerFactory(handlers, runtimeContext, runtimeBrick) {\n  return function (event) {\n    for (var handler of [].concat(handlers)) {\n      if (!checkIf(handler, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }))) {\n        continue;\n      }\n      if (isBuiltinHandler(handler)) {\n        var [object, method] = handler.action.split(\".\");\n        switch (handler.action) {\n          case \"history.push\":\n          case \"history.replace\":\n          case \"history.pushQuery\":\n          case \"history.replaceQuery\":\n          case \"history.pushAnchor\":\n          case \"history.block\":\n          case \"history.goBack\":\n          case \"history.goForward\":\n          case \"history.reload\":\n          case \"history.unblock\":\n            handleHistoryAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n\n          // case \"segue.push\":\n          // case \"segue.replace\":\n          // case \"alias.push\":\n          // case \"alias.replace\":\n\n          case \"window.open\":\n            handleWindowAction(event, handler.args, runtimeContext);\n            break;\n          case \"location.reload\":\n          case \"location.assign\":\n            handleLocationAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"localStorage.setItem\":\n          case \"localStorage.removeItem\":\n          case \"sessionStorage.setItem\":\n          case \"sessionStorage.removeItem\":\n            handleStorageAction(event, object, method, handler.args, runtimeContext);\n            break;\n          case \"event.preventDefault\":\n            event.preventDefault();\n            break;\n          case \"console.log\":\n          case \"console.error\":\n          case \"console.warn\":\n          case \"console.info\":\n            handleConsoleAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"message.success\":\n          case \"message.error\":\n          case \"message.info\":\n          case \"message.warn\":\n            handleMessageAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"handleHttpError\":\n            handleHttpError(event.detail);\n            break;\n          case \"context.assign\":\n          case \"context.replace\":\n          case \"context.refresh\":\n          case \"context.load\":\n            handleContextAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n          case \"state.update\":\n          case \"state.refresh\":\n          case \"state.load\":\n            handleTplStateAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n          case \"tpl.dispatchEvent\":\n            {\n              var [type, init] = argsFactory(handler.args, runtimeContext, event);\n              var tplHostElement = getTplHostElement(runtimeContext, handler.action, \": \".concat(type));\n              tplHostElement.dispatchEvent(new CustomEvent(type, init));\n              break;\n            }\n\n          // case \"formstate.update\":\n\n          // case \"message.subscribe\":\n          // case \"message.unsubscribe\":\n\n          case \"theme.setDarkTheme\":\n          case \"theme.setLightTheme\":\n            applyTheme(handler.action === \"theme.setDarkTheme\" ? \"dark\" : \"light\");\n            break;\n          case \"theme.setTheme\":\n            {\n              var [theme] = argsFactory(handler.args, runtimeContext, event);\n              applyTheme(theme);\n              break;\n            }\n          case \"mode.setDashboardMode\":\n          case \"mode.setDefaultMode\":\n            applyMode(handler.action === \"mode.setDashboardMode\" ? \"dashboard\" : \"default\");\n            break;\n\n          // case \"menu.clearMenuTitleCache\":\n          // case \"menu.clearMenuCache\":\n\n          // case \"analytics.event\":\n\n          // case \"preview.debug\":\n\n          default:\n            // eslint-disable-next-line no-console\n            console.error(\"unknown event listener action:\", handler.action);\n        }\n      } else if (isUseProviderHandler(handler)) {\n        handleUseProviderAction(event, handler, runtimeContext, runtimeBrick);\n      } else if (isCustomHandler(handler)) {\n        handleCustomAction(event, handler, runtimeContext, runtimeBrick);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"unknown event handler:\", handler);\n      }\n    }\n  };\n}\nfunction handleUseProviderAction(_x, _x2, _x3, _x4) {\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction _handleUseProviderAction() {\n  _handleUseProviderAction = _asyncToGenerator(function* (event, handler, runtimeContext, runtimeBrick) {\n    try {\n      var providerBrick = yield getProviderBrick(handler.useProvider);\n      var method = handler.method !== \"saveAs\" ? \"resolve\" : \"saveAs\";\n      brickCallback(event, providerBrick, handler, method, runtimeContext, runtimeBrick);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(httpErrorToString(error));\n    }\n  });\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction handleCustomAction(event, handler, runtimeContext, runtimeBrick) {\n  var targets = [];\n  var rawTarget = handler.target;\n  var rawTargetRef = handler.targetRef;\n  var computedTarget = rawTarget;\n  // Allow `target` to be set as evaluable string.\n  if (typeof rawTarget === \"string\" ? isEvaluable(rawTarget) : isPreEvaluated(rawTarget)) {\n    computedTarget = computeRealValue(rawTarget, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n  if (typeof computedTarget === \"string\") {\n    if (computedTarget === \"_self\") {\n      targets.push(runtimeBrick.element);\n    } else if (handler.multiple) {\n      targets = Array.from(document.querySelectorAll(computedTarget));\n    } else {\n      var found = document.querySelector(computedTarget);\n      if (found !== null) {\n        targets.push(found);\n      }\n    }\n  } else if (computedTarget) {\n    if (computedTarget instanceof HTMLElement) {\n      targets.push(computedTarget);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(\"unexpected target:\", computedTarget);\n    }\n  } else if (rawTargetRef) {\n    var computedTargetRef = rawTargetRef;\n    // Allow `targetRef` to be set as evaluable string.\n    if (typeof rawTargetRef === \"string\" ? isEvaluable(rawTargetRef) : isPreEvaluated(rawTargetRef)) {\n      computedTargetRef = computeRealValue(rawTargetRef, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    var targetRefs = [].concat(computedTargetRef);\n    var tplHostElement = getTplHostElement(runtimeContext, \"targetRef\", \": \".concat(targetRefs.join(\", \")));\n    targets.push(...targetRefs.map(ref => {\n      var _tplHostElement$$$get;\n      return (_tplHostElement$$$get = tplHostElement.$$getElementByRef) === null || _tplHostElement$$$get === void 0 ? void 0 : _tplHostElement$$$get.call(tplHostElement, ref);\n    }).filter(Boolean));\n  }\n  if (targets.length === 0) {\n    // eslint-disable-next-line no-console\n    console.error(\"target not found:\", rawTarget || rawTargetRef);\n    return;\n  }\n  if (isExecuteCustomHandler(handler)) {\n    targets.forEach(target => {\n      brickCallback(event, target, handler, handler.method, runtimeContext, runtimeBrick, {\n        useEventAsDefault: true\n      });\n    });\n  } else if (isSetPropsCustomHandler(handler)) {\n    setProperties(targets, handler.properties, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n}\nfunction brickCallback(_x5, _x6, _x7, _x8, _x9, _x10, _x11) {\n  return _brickCallback.apply(this, arguments);\n}\nfunction _brickCallback() {\n  _brickCallback = _asyncToGenerator(function* (event, target, handler, method, runtimeContext, runtimeBrick, options) {\n    var _poll;\n    if (typeof target[method] !== \"function\") {\n      // eslint-disable-next-line no-console\n      console.error(\"target has no method:\", {\n        target,\n        method: method\n      });\n      return;\n    }\n    var task = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var computedArgs = argsFactory(handler.args, runtimeContext, event, options);\n        if (isUseProviderHandler(handler)) {\n          computedArgs = yield getArgsOfFlowApi(handler.useProvider, computedArgs, method);\n        }\n        return target[method](...computedArgs);\n      });\n      return function task() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    if (!handler.callback) {\n      task();\n      return;\n    }\n    var callbackFactory = eventCallbackFactory(handler.callback, runtimeContext, runtimeBrick);\n    var pollableCallback = {\n      progress: callbackFactory(\"progress\"),\n      success: callbackFactory(\"success\"),\n      error: callbackFactory(\"error\"),\n      finally: callbackFactory(\"finally\")\n    };\n    var poll;\n    if (isUseProviderHandler(handler)) {\n      poll = computeRealValue(handler.poll, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    if ((_poll = poll) !== null && _poll !== void 0 && _poll.enabled) {\n      startPoll(task, pollableCallback, poll);\n    } else {\n      try {\n        // Try to catch synchronized tasks too.\n        var result = yield task();\n        pollableCallback.success(result);\n      } catch (err) {\n        pollableCallback.error(err);\n      } finally {\n        pollableCallback[\"finally\"]();\n      }\n    }\n  });\n  return _brickCallback.apply(this, arguments);\n}\nfunction handleHistoryAction(event, method, args, callback, runtimeContext) {\n  var baseArgsLength = 0;\n  var hasCallback = false;\n  var overrideMethod = method;\n  switch (method) {\n    case \"push\":\n    case \"replace\":\n    case \"pushQuery\":\n    case \"replaceQuery\":\n    case \"pushAnchor\":\n      baseArgsLength = 2;\n      hasCallback = true;\n      break;\n    case \"reload\":\n      hasCallback = true;\n      break;\n    case \"block\":\n      baseArgsLength = 1;\n      overrideMethod = \"setBlockMessage\";\n      break;\n  }\n  var computedArgs = [];\n  if (baseArgsLength > 0) {\n    computedArgs = argsFactory(args, runtimeContext, event, {\n      useEventDetailAsDefault: true\n    });\n    computedArgs.length = baseArgsLength;\n  }\n  if (hasCallback && callback) {\n    var callbackFactory = eventCallbackFactory(callback, runtimeContext, undefined);\n    computedArgs.push(blocked => {\n      callbackFactory(blocked ? \"error\" : \"success\")({\n        blocked\n      });\n      callbackFactory(\"finally\")({\n        blocked\n      });\n    });\n  }\n  getHistory()[overrideMethod](...computedArgs);\n}\nfunction handleWindowAction(event, args, runtimeContext) {\n  var [url, target, features] = argsFactory(args, runtimeContext, event);\n  window.open(url, target || \"_self\", features);\n}\nfunction handleContextAction(event, method, args, callback, runtimeContext) {\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  runtimeContext.ctxStore.updateValue(name, value, method, callback, runtimeContext);\n}\nfunction handleTplStateAction(event, method, args, callback, runtimeContext) {\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  var tplStateStore = getTplStateStore(runtimeContext, \"state.\".concat(method), \": \".concat(name));\n  tplStateStore.updateValue(name, value, method === \"update\" ? \"replace\" : method, callback, runtimeContext);\n}\nfunction handleLocationAction(event, method, args, runtimeContext) {\n  if (method === \"assign\") {\n    var [url] = argsFactory(args, runtimeContext, event);\n    location.assign(url);\n  } else {\n    location[method]();\n  }\n}\nfunction handleStorageAction(event, object, method, args, runtimeContext) {\n  var storage = object === \"localStorage\" ? localStorage : sessionStorage;\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  if (method === \"setItem\") {\n    if (value !== undefined) {\n      storage.setItem(name, JSON.stringify(value));\n    }\n  } else {\n    storage.removeItem(name);\n  }\n}\nfunction handleConsoleAction(event, method, args, runtimeContext) {\n  // eslint-disable-next-line no-console\n  console[method](...argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  }));\n}\nfunction handleMessageAction(event, method, args, runtimeContext) {\n  var computedArgs = argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  });\n  Notification.show({\n    type: method,\n    message: computedArgs[0]\n  });\n}\nexport function eventCallbackFactory(callback, runtimeContext, runtimeBrick) {\n  return function callbackFactory(type) {\n    return function (result) {\n      var handlers = callback === null || callback === void 0 ? void 0 : callback[type];\n      if (handlers) {\n        try {\n          var event = new CustomEvent(\"callback.\".concat(type), {\n            detail: result\n          });\n          listenerFactory(handlers, runtimeContext, runtimeBrick)(event);\n        } catch (err) {\n          // Do not throw errors in `callback.success` or `callback.progress`,\n          // to avoid the following triggering of `callback.error`.\n          // eslint-disable-next-line\n          console.error(err);\n        }\n      } else if (type === \"error\") {\n        // eslint-disable-next-line\n        console.error(\"Unhandled callback error:\", result);\n      }\n    };\n  };\n}\nfunction argsFactory(args, runtimeContext, event) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return Array.isArray(args) ? computeRealValue(args, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n    event\n  })) : options.useEventAsDefault ? [event] : options.useEventDetailAsDefault ? [event.detail] : [];\n}\n//# sourceMappingURL=bindListeners.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport { eventCallbackFactory, listenerFactory } from \"../bindListeners.js\";\nimport { asyncCheckIf } from \"../compute/checkIf.js\";\nimport { asyncComputeRealValue, computeRealValue } from \"../compute/computeRealValue.js\";\nimport { resolveData } from \"./resolveData.js\";\nimport { resolveDataStore } from \"./resolveDataStore.js\";\nimport { handleHttpError } from \"../../handleHttpError.js\";\nexport class DataStore {\n  constructor(type, hostBrick) {\n    _defineProperty(this, \"type\", void 0);\n    _defineProperty(this, \"data\", new Map());\n    _defineProperty(this, \"changeEventType\", void 0);\n    _defineProperty(this, \"pendingStack\", []);\n    _defineProperty(this, \"hostBrick\", void 0);\n    this.type = type;\n    this.changeEventType = this.type === \"FORM_STATE\" ? \"formstate.change\" : this.type === \"STATE\" ? \"state.change\" : \"context.change\";\n    this.hostBrick = hostBrick;\n  }\n  getValue(name) {\n    var _this$data$get;\n    return (_this$data$get = this.data.get(name)) === null || _this$data$get === void 0 ? void 0 : _this$data$get.value;\n  }\n  updateValue(name, value, method, callback, callbackRuntimeContext) {\n    var item = this.data.get(name);\n    if (!item) {\n      throw new Error(\"\".concat(this.type, \" '\").concat(name, \"' is not defined\"));\n    }\n    if (method === \"refresh\" || method === \"load\") {\n      if (!item.load) {\n        throw new Error(\"You can not \".concat(method, \" \\\"\").concat(this.type, \".\").concat(name, \"\\\" which has no resolve\"));\n      }\n      var promise;\n      if (method === \"load\") {\n        // Try to reuse previous request when calling `load`.\n        if (item.loaded) {\n          promise = Promise.resolve(item.value);\n        } else if (item.loading) {\n          promise = item.loading;\n        }\n      }\n      if (!promise) {\n        promise = item.loading = item.load(_objectSpread({\n          cache: method === \"load\" ? \"default\" : \"reload\"\n        }, value));\n        // Do not use the chained promise, since the callbacks need the original promise.\n        promise.then(val => {\n          item.loaded = true;\n          item.value = val;\n          item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n            detail: item.value\n          }));\n        }, err => {\n          // Let users override error handling.\n          if (!(callback !== null && callback !== void 0 && callback.error)) {\n            handleHttpError(err);\n          }\n        });\n      }\n      if (callback) {\n        var callbackFactory = eventCallbackFactory(callback, callbackRuntimeContext);\n        promise.then(val => {\n          callbackFactory(\"success\")({\n            value: val\n          });\n          callbackFactory(\"finally\")();\n        }, err => {\n          callbackFactory(\"error\")(err);\n          callbackFactory(\"finally\")();\n        });\n      }\n      return;\n    }\n    if (method === \"replace\") {\n      item.value = value;\n    } else {\n      if (isObject(item.value)) {\n        Object.assign(item.value, value);\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn(\"Non-object current value of \\\"\".concat(this.type, \".\").concat(name, \"\\\" for \\\"context.assign\\\", try \\\"context.replace\\\" instead.\"));\n        item.value = value;\n      }\n    }\n    item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n      detail: item.value\n    }));\n  }\n  define(dataConfs, runtimeContext, asyncHostProperties) {\n    if (Array.isArray(dataConfs) && dataConfs.length > 0) {\n      var pending = resolveDataStore(dataConfs, dataConf => this.resolve(dataConf, runtimeContext, asyncHostProperties), this.type);\n      this.pendingStack.push(pending);\n    }\n  }\n  onChange(dataName, listener) {\n    var _this$data$get2;\n    (_this$data$get2 = this.data.get(dataName)) === null || _this$data$get2 === void 0 ? void 0 : _this$data$get2.eventTarget.addEventListener(this.changeEventType, listener);\n  }\n  waitFor(dataNames) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _loop = function* (pendingContexts) {\n        yield Promise.all([...dataNames].map(ctx => {\n          var p = pendingContexts.get(ctx);\n          return p;\n        }));\n      };\n      for (var {\n        pendingContexts\n      } of _this.pendingStack) {\n        yield* _loop(pendingContexts);\n      }\n    })();\n  }\n  waitForAll() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      for (var {\n        pendingResult\n      } of _this2.pendingStack) {\n        yield pendingResult;\n      }\n    })();\n  }\n  resolve(dataConf, runtimeContext, asyncHostProperties) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!(yield asyncCheckIf(dataConf, runtimeContext))) {\n        return false;\n      }\n      var value;\n      if (_this3.type === \"STATE\" && asyncHostProperties && dataConf.expose) {\n        var hostProps = yield asyncHostProperties;\n        if (hasOwnProperty(hostProps, dataConf.name)) {\n          value = hostProps[dataConf.name];\n        }\n      }\n      var load;\n      var isLazyResolve = false;\n      if (value === undefined) {\n        if (dataConf.resolve) {\n          var resolveConf = _objectSpread({\n            transform: \"value\"\n          }, dataConf.resolve);\n          if (yield asyncCheckIf(dataConf.resolve, runtimeContext)) {\n            load = /*#__PURE__*/function () {\n              var _ref = _asyncToGenerator(function* (options) {\n                return (yield resolveData(resolveConf, runtimeContext, options)).value;\n              });\n              return function load(_x) {\n                return _ref.apply(this, arguments);\n              };\n            }();\n            isLazyResolve = dataConf.resolve.lazy;\n            if (!isLazyResolve) {\n              value = yield load();\n            }\n          } else if (!hasOwnProperty(dataConf, \"value\")) {\n            return false;\n          }\n        }\n        if ((!load || isLazyResolve) && dataConf.value !== undefined) {\n          // If the context has no resolve, just use its `value`.\n          // Or if the resolve is ignored or lazy, use its `value` as a fallback.\n          value = yield asyncComputeRealValue(dataConf.value, runtimeContext);\n        }\n      }\n      var newData = {\n        value,\n        // This is required for tracking context, even if no `onChange` is specified.\n        eventTarget: new EventTarget(),\n        load,\n        loaded: !isLazyResolve\n      };\n      if (dataConf.onChange) {\n        newData.eventTarget.addEventListener(_this3.changeEventType, listenerFactory(dataConf.onChange, runtimeContext));\n      }\n      if (dataConf.track && _this3.type !== \"FORM_STATE\") {\n        var deps = strictCollectMemberUsage(load ? dataConf.resolve : dataConf.value, _this3.type);\n        for (var dep of deps) {\n          _this3.onChange(dep, () => {\n            if (load) {\n              _this3.updateValue(dataConf.name, {\n                cache: \"default\"\n              }, \"refresh\");\n            } else {\n              _this3.updateValue(dataConf.name, computeRealValue(dataConf.value, runtimeContext), \"replace\");\n            }\n          });\n        }\n      }\n      if (_this3.data.has(dataConf.name)) {\n        throw new Error(\"\".concat(_this3.type, \" '\").concat(dataConf.name, \"' has already been declared\"));\n      }\n      _this3.data.set(dataConf.name, newData);\n      return true;\n    })();\n  }\n}\n//# sourceMappingURL=DataStore.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { collectMemberUsage } from \"@next-core/utils/storyboard\";\nexport function resolveDataStore(contextConfs, resolveContext) {\n  var keyword = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"CTX\";\n  var dependencyMap = getDependencyMapOfContext(contextConfs, keyword);\n  // There maybe multiple context confs for a specific name, since there are conditional contexts.\n  // This is a map of how many pending context confs for each context name.\n  var pendingDeps = new Map();\n  for (var contextName of Array.from(dependencyMap.keys()).map(contextConf => contextConf.name)) {\n    var _pendingDeps$get;\n    pendingDeps.set(contextName, ((_pendingDeps$get = pendingDeps.get(contextName)) !== null && _pendingDeps$get !== void 0 ? _pendingDeps$get : 0) + 1);\n  }\n  var hasNonStaticUsage = Array.from(dependencyMap.values()).some(stats => stats.hasNonStaticUsage);\n  var processed = new WeakSet();\n  var deferredContexts = new Map();\n  var pendingContexts = new Map([...new Set(contextConfs.map(contextConf => contextConf.name))].map(contextName => [contextName, new Promise((resolve, reject) => {\n    deferredContexts.set(contextName, {\n      resolve,\n      reject\n    });\n  })]));\n  var wrapResolve = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (contextConf) {\n      var _pendingDeps$get2;\n      processed.add(contextConf);\n      var resolved = yield resolveContext(contextConf);\n      dependencyMap.delete(contextConf);\n      var left = (_pendingDeps$get2 = pendingDeps.get(contextConf.name)) !== null && _pendingDeps$get2 !== void 0 ? _pendingDeps$get2 : 0;\n      if (resolved) {\n        // Assert: contextConf.name exists in deferredContexts\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        deferredContexts.get(contextConf.name).resolve();\n        pendingDeps.delete(contextConf.name);\n        if (left === 0) {\n          throw new Error(\"Duplicated context defined: \".concat(contextConf.name));\n        }\n      } else {\n        // Assert: left >= 1\n        if (left === 1) {\n          // Assert: contextConf.name exists in deferredContexts\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          deferredContexts.get(contextConf.name).resolve();\n          pendingDeps.delete(contextConf.name);\n        } else {\n          pendingDeps.set(contextConf.name, left - 1);\n        }\n      }\n      yield scheduleNext();\n    });\n    return function wrapResolve(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var scheduleAsSerial = hasNonStaticUsage;\n  function scheduleNext() {\n    return _scheduleNext.apply(this, arguments);\n  }\n  function _scheduleNext() {\n    _scheduleNext = _asyncToGenerator(function* () {\n      var readyContexts = Array.from(dependencyMap.entries()).filter(predicateNextResolveFactory(pendingDeps, scheduleAsSerial)).map(entry => entry[0]).filter(contextConf => !processed.has(contextConf));\n      yield Promise.all(readyContexts.map(wrapResolve));\n    });\n    return _scheduleNext.apply(this, arguments);\n  }\n  var pendingResult = scheduleNext().then( /*#__PURE__*/_asyncToGenerator(function* () {\n    // If there are still contexts left, it implies one of these situations:\n    //   - Circular contexts.\n    //     Such as: a depends on b, while b depends on a.\n    //   - Related contexts are all ignored.\n    //     Such as: a depends on b,\n    //     while both them are ignore by a falsy result of `if`.\n    if (dependencyMap.size > 0) {\n      // This will throw if circular contexts detected.\n      detectCircularContexts(dependencyMap, keyword);\n      scheduleAsSerial = true;\n      yield scheduleNext();\n    }\n    // There maybe ignored contexts which are still not fulfilled.\n    // We treat them as RESOLVED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.resolve();\n    }\n  })).catch(error => {\n    // There maybe contexts left not fulfilled, when an error occurred.\n    // We treat them as REJECTED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.reject(error);\n    }\n    throw error;\n  });\n  return {\n    pendingResult,\n    pendingContexts\n  };\n}\nfunction predicateNextResolveFactory(pendingDeps, scheduleAsSerial) {\n  return (entry, index) =>\n  // When contexts contain computed CTX accesses, it implies a dynamic dependency map.\n  // So make them process sequentially, keep the same behavior as before.\n  scheduleAsSerial ? index === 0 :\n  // A context is ready when it has no pending dependencies.\n  ![...entry[1].usedProperties].some(dep => pendingDeps.has(dep));\n}\nexport function getDependencyMapOfContext(contextConfs) {\n  var keyword = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"CTX\";\n  var depsMap = new Map();\n  for (var _contextConf of contextConfs) {\n    var stats = collectMemberUsage([_contextConf.if, _contextConf.value, _contextConf.resolve], keyword);\n    depsMap.set(_contextConf, stats);\n  }\n  return depsMap;\n}\nfunction detectCircularContexts(dependencyMap, keyword) {\n  var duplicatedMap = new Map(dependencyMap);\n  var pendingDeps = new Set(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name));\n  var next = () => {\n    var processedAtLeastOne = false;\n    for (var [_contextConf2, stats] of duplicatedMap.entries()) {\n      if (![...stats.usedProperties].some(dep => pendingDeps.has(dep))) {\n        duplicatedMap.delete(_contextConf2);\n        pendingDeps.delete(_contextConf2.name);\n        processedAtLeastOne = true;\n      }\n    }\n    if (processedAtLeastOne) {\n      next();\n    }\n  };\n  next();\n  if (duplicatedMap.size > 0) {\n    throw new ReferenceError(\"Circular \".concat(keyword, \" detected: \").concat(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name).join(\", \")));\n  }\n}\n//# sourceMappingURL=resolveDataStore.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { clamp } from \"lodash\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./constants.js\";\nexport function setupTemplateProxy(hostContext, ref, slots) {\n  var {\n    reversedProxies,\n    asyncHostProperties,\n    externalSlots,\n    tplStateStoreId,\n    hostBrick\n  } = hostContext;\n  var asyncComputedProps;\n  if (ref && reversedProxies) {\n    var propertyProxies = reversedProxies.properties.get(ref);\n    if (propertyProxies) {\n      var getComputedProps = hostProps => {\n        var props = {};\n        for (var {\n          from,\n          to\n        } of propertyProxies) {\n          var propValue = hostProps[from];\n          if (propValue !== undefined && to.refProperty) {\n            props[to.refProperty] = propValue;\n          }\n        }\n        return props;\n      };\n      asyncComputedProps = asyncHostProperties.then(getComputedProps);\n    }\n    var slotProxies = reversedProxies.slots.get(ref);\n    if (slotProxies && externalSlots) {\n      // Use an approach like template-literal's quasis:\n      // `quasi0${0}quais1${1}quasi2...`\n      // Every quasi (indexed by `refPosition`) can be slotted with multiple bricks.\n      var quasisMap = new Map();\n      for (var {\n        from,\n        to\n      } of slotProxies) {\n        var _externalSlots$from$b, _externalSlots$from, _to$refSlot, _to$refPosition;\n        var insertBricks = (_externalSlots$from$b = (_externalSlots$from = externalSlots[from]) === null || _externalSlots$from === void 0 ? void 0 : _externalSlots$from.bricks) !== null && _externalSlots$from$b !== void 0 ? _externalSlots$from$b : [];\n        if (!insertBricks.length) {\n          continue;\n        }\n        var refToSlot = (_to$refSlot = to.refSlot) !== null && _to$refSlot !== void 0 ? _to$refSlot : from;\n        var expandableSlot = quasisMap.get(refToSlot);\n        if (!expandableSlot) {\n          expandableSlot = [];\n          // The size of quasis should be the existed slotted bricks' size plus one.\n          var size = hasOwnProperty(slots, refToSlot) ? slots[refToSlot].bricks.length + 1 : 1;\n          for (var i = 0; i < size; i += 1) {\n            expandableSlot.push([]);\n          }\n          quasisMap.set(refToSlot, expandableSlot);\n        }\n        var refPosition = (_to$refPosition = to.refPosition) !== null && _to$refPosition !== void 0 ? _to$refPosition : -1;\n        expandableSlot[clamp(refPosition < 0 ? expandableSlot.length + refPosition : refPosition, 0, expandableSlot.length - 1)].push(...(hasOwnProperty(hostBrick.runtimeContext, \"forEachItem\") ? setupTemplateExternalBricks(insertBricks, hostBrick.runtimeContext.forEachItem) : insertBricks));\n      }\n      var _loop = function () {\n        if (!hasOwnProperty(slots, slotName)) {\n          slots[slotName] = {\n            type: \"bricks\",\n            bricks: []\n          };\n        }\n        var slotConf = slots[slotName];\n        slotConf.bricks = quasis.flatMap((bricks, index) => index < slotConf.bricks.length ? bricks.concat(slotConf.bricks[index]) : bricks);\n        if (slotConf.bricks.length === 0) {\n          delete slots[slotName];\n        }\n      };\n      for (var [slotName, quasis] of quasisMap.entries()) {\n        _loop();\n      }\n    }\n  }\n  return {\n    [symbolForAsyncComputedPropsFromHost]: asyncComputedProps,\n    [symbolForTplStateStoreId]: tplStateStoreId\n  };\n}\n\n// External bricks of a template, have the same forEachItem context as their host.\nfunction setupTemplateExternalBricks(bricks, forEachItem) {\n  return bricks.map(brick => {\n    var _brick$slots;\n    return _objectSpread(_objectSpread({}, brick), {}, {\n      [symbolForTPlExternalForEachItem]: forEachItem,\n      slots: Object.fromEntries(Object.entries((_brick$slots = brick.slots) !== null && _brick$slots !== void 0 ? _brick$slots : {}).map(_ref => {\n        var _slotConf$bricks;\n        var [slotName, slotConf] = _ref;\n        return [slotName, slotConf.type === \"routes\" ? {\n          type: \"routes\",\n          routes: setupTemplateExternalRoutes(slotConf.routes, forEachItem)\n        } : {\n          type: \"bricks\",\n          bricks: setupTemplateExternalBricks((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : [], forEachItem)\n        }];\n      }))\n    });\n  });\n}\nfunction setupTemplateExternalRoutes(routes, forEachItem) {\n  return routes.map(route => route.type && route.type !== \"bricks\" ? route : _objectSpread(_objectSpread({}, route), {}, {\n    bricks: setupTemplateExternalBricks(route.bricks, forEachItem)\n  }));\n}\n//# sourceMappingURL=setupTemplateProxy.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"properties\", \"slots\", \"children\"];\nimport { isObject } from \"@next-core/utils/general\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nexport function setupUseBrickInTemplate(props, hostContext) {\n  function walk(props) {\n    if (!isObject(props)) {\n      return props;\n    }\n    if (Array.isArray(props)) {\n      return props.map(walk);\n    }\n    return Object.fromEntries(Object.entries(props).map(_ref => {\n      var [key, value] = _ref;\n      return isObject(value) && key === \"useBrick\" ? Array.isArray(value) ? [key, value.map(setup)] : [key, setup(value)] : [key, walk(value)];\n    }).concat(Object.getOwnPropertySymbols(props).map(k => [k, props[k]])));\n  }\n  function setup(item) {\n    var {\n        properties,\n        slots: originalSlots,\n        children\n      } = item,\n      restConf = _objectWithoutProperties(item, _excluded);\n    var transpiledSlots = childrenToSlots(children, originalSlots);\n    var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref2 => {\n      var _slotConf$bricks;\n      var [slotName, slotConf] = _ref2;\n      return [slotName, {\n        type: \"bricks\",\n        bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(setup)\n      }];\n    }));\n    return _objectSpread(_objectSpread({}, restConf), {}, {\n      properties: walk(properties),\n      slots\n    }, setupTemplateProxy(hostContext, restConf.ref, slots));\n  }\n  return walk(props);\n}\n//# sourceMappingURL=setupUseBrickInTemplate.js.map","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nvar _excluded = [\"slots\", \"children\"],\n  _excluded2 = [\"properties\", \"slots\", \"children\"];\nimport { uniqueId } from \"lodash\";\nimport { customTemplates } from \"../../CustomTemplates.js\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { setupUseBrickInTemplate } from \"./setupUseBrickInTemplate.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nimport { collectWidgetContract } from \"../data/CollectContracts.js\";\nexport function expandCustomTemplate(tplTagName, brickConf, hostBrick, asyncHostProperties) {\n  var tplStateStoreId = uniqueId(\"tpl-state-\");\n  var runtimeContext = _objectSpread(_objectSpread({}, hostBrick.runtimeContext), {}, {\n    tplStateStoreId\n  });\n\n  // There is a boundary for `forEachItem` between template internals and externals.\n  delete runtimeContext.forEachItem;\n  var tplStateStore = new DataStore(\"STATE\", hostBrick);\n  runtimeContext.tplStateStoreMap.set(tplStateStoreId, tplStateStore);\n  if (runtimeContext.tplStateStoreScope) {\n    runtimeContext.tplStateStoreScope.push(tplStateStore);\n  }\n  var {\n    bricks,\n    proxy,\n    state,\n    contracts\n  } = customTemplates.get(tplTagName);\n  collectWidgetContract(contracts);\n  tplStateStore.define(state, runtimeContext, asyncHostProperties);\n  var {\n      slots: originalExternalSlots,\n      children: externalChildren\n    } = brickConf,\n    restBrickConf = _objectWithoutProperties(brickConf, _excluded);\n  var newBrickConf = _objectSpread(_objectSpread({}, restBrickConf), {}, {\n    brick: tplTagName\n  });\n  hostBrick.tplHostMetadata = {\n    internalBricksByRef: new Map(),\n    tplStateStoreId,\n    proxy\n  };\n\n  // Reversed proxies are used for expand storyboard before rendering page.\n  var reversedProxies = {\n    properties: new Map(),\n    slots: new Map()\n    // mergeBases: new Map(),\n  };\n\n  if (proxy !== null && proxy !== void 0 && proxy.properties) {\n    for (var [from, to] of Object.entries(proxy.properties)) {\n      var proxies = reversedProxies.properties.get(to.ref);\n      if (!proxies) {\n        proxies = [];\n        reversedProxies.properties.set(to.ref, proxies);\n      }\n      proxies.push({\n        from,\n        to\n      });\n    }\n  }\n  if (proxy !== null && proxy !== void 0 && proxy.slots) {\n    for (var [_from, _to] of Object.entries(proxy.slots)) {\n      var _proxies = reversedProxies.slots.get(_to.ref);\n      if (!_proxies) {\n        _proxies = [];\n        reversedProxies.slots.set(_to.ref, _proxies);\n      }\n      _proxies.push({\n        from: _from,\n        to: _to\n      });\n    }\n  }\n  var hostContext = {\n    reversedProxies,\n    asyncHostProperties,\n    externalSlots: childrenToSlots(externalChildren, originalExternalSlots),\n    tplStateStoreId,\n    hostBrick: hostBrick\n  };\n  newBrickConf.slots = {\n    \"\": {\n      type: \"bricks\",\n      bricks: bricks.map(item => expandBrickInTemplate(item, hostContext))\n    }\n  };\n  return newBrickConf;\n}\nfunction expandBrickInTemplate(brickConfInTemplate, hostContext) {\n  // Ignore `if: null` to make `looseCheckIf` working.\n  if (brickConfInTemplate.if === null) {\n    delete brickConfInTemplate.if;\n  }\n  var {\n      properties,\n      slots: slotsInTemplate,\n      children: childrenInTemplate\n    } = brickConfInTemplate,\n    restBrickConfInTemplate = _objectWithoutProperties(brickConfInTemplate, _excluded2);\n  var transpiledSlots = childrenToSlots(childrenInTemplate, slotsInTemplate);\n  var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref => {\n    var _slotConf$bricks;\n    var [slotName, slotConf] = _ref;\n    return [slotName, {\n      type: \"bricks\",\n      bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(item => expandBrickInTemplate(item, hostContext))\n    }];\n  }));\n  return _objectSpread(_objectSpread({}, restBrickConfInTemplate), {}, {\n    properties: setupUseBrickInTemplate(properties, hostContext),\n    slots\n  }, setupTemplateProxy(hostContext, restBrickConfInTemplate.ref, slots));\n}\n//# sourceMappingURL=expandCustomTemplate.js.map","export var RenderTag = /*#__PURE__*/function (RenderTag) {\n  RenderTag[RenderTag[\"ROOT\"] = 1] = \"ROOT\";\n  RenderTag[RenderTag[\"BRICK\"] = 2] = \"BRICK\";\n  return RenderTag;\n}({});\n//# sourceMappingURL=enums.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"blockingList\", \"node\", \"menuRequests\", \"hasTrackingControls\"];\nimport { enqueueStableLoadBricks, loadBricksImperatively } from \"@next-core/loader\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { debounce } from \"lodash\";\nimport { asyncCheckBrickIf } from \"./compute/checkIf.js\";\nimport { asyncComputeRealProperties } from \"./compute/computeRealProperties.js\";\nimport { resolveData } from \"./data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nimport { preCheckPermissionsForBrickOrRoute } from \"./checkPermissions.js\";\nimport { listenOnTrackingContext } from \"./compute/listenOnTrackingContext.js\";\nimport { matchRoutes } from \"./matchRoutes.js\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./CustomTemplates/constants.js\";\nimport { expandCustomTemplate } from \"./CustomTemplates/expandCustomTemplate.js\";\nimport { getTagNameOfCustomTemplate, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { getBrickPackages } from \"./Runtime.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { getTracks } from \"./compute/getTracks.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nexport function renderRoutes(_x, _x2, _x3, _x4, _x5) {\n  return _renderRoutes.apply(this, arguments);\n}\nfunction _renderRoutes() {\n  _renderRoutes = _asyncToGenerator(function* (returnNode, routes, _runtimeContext, rendererContext, slotId) {\n    var matched = yield matchRoutes(routes, _runtimeContext);\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    switch (matched) {\n      case \"missed\":\n        break;\n      case \"unauthenticated\":\n        output.unauthenticated = true;\n        break;\n      default:\n        {\n          var route = output.route = matched.route;\n          var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n            match: matched.match\n          });\n          runtimeContext.ctxStore.define(route.context, runtimeContext);\n          runtimeContext.pendingPermissionsPreCheck.push(preCheckPermissionsForBrickOrRoute(route, runtimeContext));\n          switch (route.type) {\n            case \"redirect\":\n              {\n                var redirectTo;\n                if (typeof route.redirect === \"string\") {\n                  redirectTo = yield asyncComputeRealValue(route.redirect, runtimeContext);\n                } else {\n                  var resolved = yield resolveData(_objectSpread({\n                    transform: \"redirect\"\n                  }, route.redirect), runtimeContext);\n                  redirectTo = resolved.redirect;\n                }\n                if (typeof redirectTo !== \"string\") {\n                  // eslint-disable-next-line no-console\n                  console.error(\"Unexpected redirect result:\", redirectTo);\n                  throw new Error(\"Unexpected type of redirect result: \".concat(typeof redirectTo));\n                }\n                output.redirect = {\n                  path: redirectTo\n                };\n                break;\n              }\n            case \"routes\":\n              {\n                output.menuRequests.push(loadMenu(route.menu, runtimeContext));\n                var newOutput = yield renderRoutes(returnNode, route.routes, runtimeContext, rendererContext, slotId);\n                mergeRenderOutput(output, newOutput);\n                break;\n              }\n            default:\n              {\n                output.menuRequests.push(loadMenu(route.menu, runtimeContext));\n                var _newOutput = yield renderBricks(returnNode, route.bricks, runtimeContext, rendererContext, slotId);\n                mergeRenderOutput(output, _newOutput);\n              }\n          }\n        }\n    }\n    return output;\n  });\n  return _renderRoutes.apply(this, arguments);\n}\nexport function renderBricks(_x6, _x7, _x8, _x9, _x10, _x11, _x12) {\n  return _renderBricks.apply(this, arguments);\n}\nfunction _renderBricks() {\n  _renderBricks = _asyncToGenerator(function* (returnNode, bricks, runtimeContext, rendererContext, slotId, tplStack, noMemoize) {\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    // 多个构件并行异步转换，但转换的结果按原顺序串行合并。\n    var rendered = yield Promise.all(bricks.map((brickConf, index) => renderBrick(returnNode, brickConf, runtimeContext, rendererContext, slotId, index, tplStack && new Map(tplStack))));\n    rendered.forEach((item, index) => {\n      if (!noMemoize && item.hasTrackingControls) {\n        // Memoize a render node before it's been merged.\n        rendererContext.memoizeControlNode(slotId, index, item.node, returnNode);\n      }\n      mergeRenderOutput(output, item);\n    });\n    return output;\n  });\n  return _renderBricks.apply(this, arguments);\n}\nexport function renderBrick(_x13, _x14, _x15, _x16, _x17, _x18) {\n  return _renderBrick.apply(this, arguments);\n}\nfunction _renderBrick() {\n  _renderBrick = _asyncToGenerator(function* (returnNode, brickConf, _runtimeContext, rendererContext, slotId, key) {\n    var _runtimeContext$app;\n    var tplStack = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new Map();\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    if (!brickConf.brick) {\n      if (brickConf.template) {\n        // eslint-disable-next-line no-console\n        console.error(\"Legacy templates are dropped in v3:\", brickConf);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid brick:\", brickConf);\n      }\n      return output;\n    }\n    var tplStateStoreId = brickConf[symbolForTplStateStoreId];\n    var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n      tplStateStoreId\n    });\n    if (hasOwnProperty(brickConf, symbolForTPlExternalForEachItem)) {\n      // The external bricks of a template should restore their `forEachItem`\n      // from their host.\n      runtimeContext.forEachItem = brickConf[symbolForTPlExternalForEachItem];\n    }\n    var {\n      context\n    } = brickConf;\n    // istanbul ignore next\n    if (Array.isArray(context) && context.length > 0) {\n      var strict = isStrictMode(runtimeContext);\n      warnAboutStrictMode(strict, \"Defining context on bricks\", \"check your brick:\", brickConf);\n      if (!strict) {\n        runtimeContext.ctxStore.define(context, runtimeContext);\n      }\n    }\n    runtimeContext.pendingPermissionsPreCheck.push(preCheckPermissionsForBrickOrRoute(brickConf, runtimeContext));\n    if (!(yield asyncCheckBrickIf(brickConf, runtimeContext))) {\n      return output;\n    }\n    var brickName = brickConf.brick;\n    if (brickName.startsWith(\":\")) {\n      ensureValidControlBrick(brickName);\n      var {\n        dataSource\n      } = brickConf;\n      var renderControlNode = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* () {\n          var _slots$slot;\n          // First, compute the `dataSource`\n          var computedDataSource = yield asyncComputeRealValue(dataSource, runtimeContext);\n\n          // Then, get the matched slot.\n          var slot = brickName === \":forEach\" ? \"\" : brickName === \":switch\" ? String(computedDataSource) : computedDataSource ? \"\" : \"else\";\n\n          // Don't forget to transpile children to slots.\n          var slots = childrenToSlots(brickConf.children, brickConf.slots);\n\n          // Then, get the bricks in that matched slot.\n          var bricks = slots && hasOwnProperty(slots, slot) && ((_slots$slot = slots[slot]) === null || _slots$slot === void 0 ? void 0 : _slots$slot.bricks);\n          if (!Array.isArray(bricks)) {\n            return output;\n          }\n          switch (brickName) {\n            case \":forEach\":\n              {\n                if (!Array.isArray(computedDataSource)) {\n                  return output;\n                }\n                return renderForEach(returnNode, computedDataSource, bricks, runtimeContext, rendererContext, slotId, tplStack);\n              }\n            case \":if\":\n            case \":switch\":\n              {\n                return renderBricks(returnNode, bricks, runtimeContext, rendererContext, slotId, tplStack, true);\n              }\n          }\n        });\n        return function renderControlNode() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      var controlledOutput = yield renderControlNode();\n      var {\n        contextNames,\n        stateNames\n      } = getTracks(dataSource);\n      if (contextNames || stateNames) {\n        controlledOutput.hasTrackingControls = true;\n        var renderId = 0;\n        var listener = /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* () {\n            var currentRenderId = ++renderId;\n            var output = yield renderControlNode();\n            output.blockingList.push(...[...runtimeContext.tplStateStoreMap.values()].map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck);\n            yield Promise.all(output.blockingList);\n            // Ignore stale renders\n            if (renderId === currentRenderId) {\n              rendererContext.rerenderControlNode(slotId, key, output.node, returnNode);\n            }\n          });\n          return function listener() {\n            return _ref2.apply(this, arguments);\n          };\n        }();\n        var debouncedListener = debounce(listener);\n        if (contextNames) {\n          for (var contextName of contextNames) {\n            runtimeContext.ctxStore.onChange(contextName, debouncedListener);\n          }\n        }\n        if (stateNames) {\n          for (var _contextName of stateNames) {\n            var tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(dataSource, \"\\\"\"));\n            tplStateStore.onChange(_contextName, debouncedListener);\n          }\n        }\n      }\n      return controlledOutput;\n    }\n\n    // Widgets need to be defined before rendering.\n    if (/\\.tpl-/.test(brickName) && !customTemplates.get(brickName)) {\n      yield loadBricksImperatively([brickName], getBrickPackages());\n    }\n    var tplTagName = getTagNameOfCustomTemplate(brickName, (_runtimeContext$app = runtimeContext.app) === null || _runtimeContext$app === void 0 ? void 0 : _runtimeContext$app.id);\n    if (tplTagName) {\n      var _tplStack$get;\n      var tplCount = (_tplStack$get = tplStack.get(tplTagName)) !== null && _tplStack$get !== void 0 ? _tplStack$get : 0;\n      if (tplCount >= 10) {\n        throw new Error(\"Maximum custom template stack overflowed: \\\"\".concat(tplTagName, \"\\\"\"));\n      }\n      tplStack.set(tplTagName, tplCount + 1);\n    } else if (brickName.includes(\"-\") && !customElements.get(brickName)) {\n      output.blockingList.push(enqueueStableLoadBricks([brickName], getBrickPackages()));\n    }\n    var brick = {\n      tag: RenderTag.BRICK,\n      type: tplTagName || brickName,\n      return: returnNode,\n      slotId,\n      events: brickConf.events,\n      runtimeContext,\n      portal: brickConf.portal,\n      iid: brickConf.iid,\n      ref: brickConf.ref\n    };\n    output.node = brick;\n\n    // 加载构件属性和加载子构件等任务，可以并行。\n    var blockingList = [];\n    var trackingContextList = [];\n    var loadProperties = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        brick.properties = yield asyncComputeRealProperties(brickConf.properties, runtimeContext, trackingContextList);\n        var computedPropsFromHost = brickConf[symbolForAsyncComputedPropsFromHost];\n        if (computedPropsFromHost) {\n          var _brick$properties;\n          (_brick$properties = brick.properties) !== null && _brick$properties !== void 0 ? _brick$properties : brick.properties = {};\n          var computed = yield computedPropsFromHost;\n          for (var [propName, propValue] of Object.entries(computed)) {\n            brick.properties[propName] = propValue;\n          }\n        }\n        listenOnTrackingContext(brick, trackingContextList);\n        return brick.properties;\n      });\n      return function loadProperties() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    var asyncProperties = loadProperties();\n    blockingList.push(asyncProperties);\n    rendererContext.registerBrickLifeCycle(brick, brickConf.lifeCycle);\n    var expandedBrickConf = brickConf;\n    if (tplTagName) {\n      expandedBrickConf = expandCustomTemplate(tplTagName, brickConf, brick, asyncProperties);\n    }\n    if (expandedBrickConf.portal) {\n      // A portal brick has no slotId.\n      brick.slotId = undefined;\n    }\n    var childRuntimeContext;\n    if (tplTagName) {\n      // There is a boundary for `forEachItem` between template internals and externals.\n      childRuntimeContext = _objectSpread({}, runtimeContext);\n      delete childRuntimeContext.forEachItem;\n    } else {\n      childRuntimeContext = runtimeContext;\n    }\n    var loadChildren = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(function* () {\n        var slots = childrenToSlots(expandedBrickConf.children, expandedBrickConf.slots);\n        if (!slots) {\n          return;\n        }\n        var rendered = yield Promise.all(Object.entries(slots).map(_ref5 => {\n          var [childSlotId, slotConf] = _ref5;\n          return slotConf.type !== \"routes\" ? renderBricks(brick, slotConf.bricks, childRuntimeContext, rendererContext, childSlotId, tplStack) : renderRoutes(brick, slotConf.routes, childRuntimeContext, rendererContext, childSlotId);\n        }));\n        var childrenOutput = _objectSpread(_objectSpread({}, output), {}, {\n          node: undefined,\n          blockingList: []\n        });\n        for (var item of rendered) {\n          mergeRenderOutput(childrenOutput, item);\n        }\n        if (childrenOutput.node) {\n          brick.child = childrenOutput.node;\n        }\n        mergeRenderOutput(output, _objectSpread(_objectSpread({}, childrenOutput), {}, {\n          node: undefined\n        }));\n      });\n      return function loadChildren() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    blockingList.push(loadChildren());\n    yield Promise.all(blockingList);\n    return output;\n  });\n  return _renderBrick.apply(this, arguments);\n}\nfunction ensureValidControlBrick(brick) {\n  if (brick !== \":forEach\" && brick !== \":if\" && brick !== \":switch\") {\n    throw new Error(\"Unknown storyboard control node: \\\"\".concat(brick, \"\\\"\"));\n  }\n}\nfunction renderForEach(_x19, _x20, _x21, _x22, _x23, _x24, _x25) {\n  return _renderForEach.apply(this, arguments);\n}\nfunction _renderForEach() {\n  _renderForEach = _asyncToGenerator(function* (returnNode, dataSource, bricks, runtimeContext, rendererContext, slotId, tplStack) {\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    var rendered = yield Promise.all(dataSource.map((item, i) => Promise.all(bricks.map((brickConf, j) => renderBrick(returnNode, brickConf, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      forEachItem: item\n    }), rendererContext, slotId, i * j, tplStack && new Map(tplStack))))));\n\n    // 多层构件并行异步转换，但转换的结果按原顺序串行合并。\n    for (var item of rendered.flat()) {\n      mergeRenderOutput(output, item);\n    }\n    return output;\n  });\n  return _renderForEach.apply(this, arguments);\n}\nfunction loadMenu(menuConf, runtimeContext) {\n  if (!menuConf) {\n    return;\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"brick\") {\n    // eslint-disable-next-line no-console\n    console.error(\"Set menu with brick is dropped in v3:\", menuConf);\n    throw new Error(\"Set menu with brick is dropped in v3\");\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"resolve\") {\n    // eslint-disable-next-line no-console\n    console.warn(\"Set menu with resolve is not supported in v3 yet:\", menuConf);\n    return;\n  }\n  return asyncComputeRealValue(menuConf, runtimeContext);\n}\nfunction mergeRenderOutput(output, newOutput) {\n  var {\n      blockingList,\n      node,\n      menuRequests,\n      hasTrackingControls\n    } = newOutput,\n    rest = _objectWithoutProperties(newOutput, _excluded);\n  output.blockingList.push(...blockingList);\n  output.menuRequests.push(...menuRequests);\n  if (node) {\n    if (output.node) {\n      var last = output.node;\n      while (last.sibling) {\n        last = last.sibling;\n      }\n      last.sibling = node;\n    } else {\n      output.node = node;\n    }\n  }\n  Object.assign(output, rest);\n}\nexport function childrenToSlots(children, originalSlots) {\n  var newSlots = originalSlots;\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && children && !Array.isArray(children)) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Specified brick children but not array:\", \"<\".concat(typeof children, \">\"), children);\n  }\n  if (Array.isArray(children) && !newSlots) {\n    newSlots = {};\n    for (var child of children) {\n      var _child$slot;\n      var slot = (_child$slot = child.slot) !== null && _child$slot !== void 0 ? _child$slot : \"\";\n      if (!hasOwnProperty(newSlots, slot)) {\n        newSlots[slot] = {\n          type: \"bricks\",\n          bricks: []\n        };\n      }\n      newSlots[slot].bricks.push(child);\n    }\n  }\n  return newSlots;\n}\n//# sourceMappingURL=Renderer.js.map","import { setProperties } from \"./setProperties.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nexport function listenOnTrackingContext(brick, trackingContextList) {\n  var _loop = function (track) {\n    var listener = () => {\n      if (brick.element) {\n        setProperties(brick.element, {\n          [track.propName]: track.propValue\n        }, brick.runtimeContext);\n      }\n    };\n    if (track.contextNames) {\n      for (var contextName of track.contextNames) {\n        brick.runtimeContext.ctxStore.onChange(contextName, listener);\n      }\n    }\n    if (track.stateNames) {\n      var tplStateStore = getTplStateStore(brick.runtimeContext, \"STATE\", \": \\\"\".concat(track.propValue, \"\\\"\"));\n      for (var stateName of track.stateNames) {\n        tplStateStore.onChange(stateName, listener);\n      }\n    }\n    // if (track.formStateNames) {\n    //   const formContext = getCustomFormContext(context.formContextId);\n    //   for (const stateName of track.formStateNames) {\n    //     const ctx = formContext.formState.get().get(stateName);\n    //     (\n    //       ctx as StoryboardContextItemFreeVariable\n    //     )?.eventTarget?.addEventListener(\"formstate.change\", listener);\n    //   }\n    // }\n  };\n  for (var track of trackingContextList) {\n    _loop(track);\n  }\n}\n//# sourceMappingURL=listenOnTrackingContext.js.map","import { getTplStateStore } from \"./utils.js\";\nexport function bindTemplateProxy(brick) {\n  var _tplHostMetadata$prox;\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n\n  // Error recovering brick may have no runtimeContext.\n  if (!ref || !runtimeContext.tplStateStoreId) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"bindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.set(ref, brick);\n  var events = (_tplHostMetadata$prox = tplHostMetadata.proxy) === null || _tplHostMetadata$prox === void 0 ? void 0 : _tplHostMetadata$prox.events;\n  if (events) {\n    var _loop = function (from) {\n      if (to.ref === ref) {\n        var _to$refEvent, _ref, _ref$$$proxyListeners;\n        var listener = e => {\n          if (e.bubbles) {\n            e.stopPropagation();\n          }\n          hostBrick.element.dispatchEvent(new CustomEvent(from, {\n            detail: e.detail,\n            bubbles: e.bubbles,\n            cancelable: e.cancelable,\n            composed: e.composed\n          }));\n        };\n        var eventType = (_to$refEvent = to.refEvent) !== null && _to$refEvent !== void 0 ? _to$refEvent : from;\n        element.addEventListener(eventType, listener);\n        (_ref$$$proxyListeners = (_ref = element).$$proxyListeners) !== null && _ref$$$proxyListeners !== void 0 ? _ref$$$proxyListeners : _ref.$$proxyListeners = [];\n        element.$$proxyListeners.push([eventType, listener]);\n      }\n    };\n    for (var [from, to] of Object.entries(events)) {\n      _loop(from);\n    }\n  }\n}\nexport function unbindTemplateProxy(brick) {\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n  if (!runtimeContext.tplStateStoreId || !ref) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"unbindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.delete(ref);\n  for (var [type, fn] of (_$$proxyListeners = element.$$proxyListeners) !== null && _$$proxyListeners !== void 0 ? _$$proxyListeners : []) {\n    var _$$proxyListeners;\n    element.removeEventListener(type, fn);\n  }\n  delete element.$$proxyListeners;\n}\n//# sourceMappingURL=bindTemplateProxy.js.map","import { bindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { bindListeners } from \"./bindListeners.js\";\nimport { setRealProperties } from \"./compute/setRealProperties.js\";\nimport { RenderTag } from \"./enums.js\";\nexport function unmountTree(mountPoint) {\n  mountPoint.innerHTML = \"\";\n}\nexport function mountTree(root, initializedElement) {\n  var current = root.child;\n  var portalElements = [];\n  while (current) {\n    var tagName = current.type;\n    if (tagName.includes(\"-\") && !customElements.get(tagName)) {\n      // eslint-disable-next-line no-console\n      console.error(\"Undefined custom element: \".concat(tagName));\n    }\n\n    // istanbul ignore if\n    if (tagName === \"basic-bricks.script-brick\") {\n      // eslint-disable-next-line no-console\n      console.warn(\"`basic-bricks.script-brick` is deprecated, please take caution when using it\");\n    }\n    var element = initializedElement && current === root.child ? initializedElement : document.createElement(tagName);\n    current.element = element;\n    if (current.slotId) {\n      element.setAttribute(\"slot\", current.slotId);\n    }\n    if (current.iid) {\n      element.dataset.iid = current.iid;\n    }\n    setRealProperties(element, current.properties);\n    bindListeners(element, current.events, current.runtimeContext);\n    if (current.tplHostMetadata) {\n      // 先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n      // 避免初始化的一次 state update 操作及其 onChange 事件。\n      element.$$tplStateStore = getTplStateStore({\n        tplStateStoreId: current.tplHostMetadata.tplStateStoreId,\n        tplStateStoreMap: current.runtimeContext.tplStateStoreMap\n      }, \"mount\");\n    }\n    bindTemplateProxy(current);\n    if (current.portal) {\n      portalElements.push(element);\n    } else if (current.return) {\n      if (!current.return.childElements) {\n        current.return.childElements = [];\n      }\n      current.return.childElements.push(element);\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        // Append elements inside out\n        if (currentReturn.childElements) {\n          if (currentReturn.tag === RenderTag.ROOT) {\n            var _currentReturn$contai;\n            (_currentReturn$contai = currentReturn.container) === null || _currentReturn$contai === void 0 ? void 0 : _currentReturn$contai.append(...currentReturn.childElements);\n            if (portalElements.length > 0) {\n              var portal = typeof currentReturn.createPortal === \"function\" ? currentReturn.createPortal() : currentReturn.createPortal;\n              portal.append(...portalElements);\n            }\n          } else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            currentReturn.element.append(...currentReturn.childElements);\n          }\n          currentReturn.childElements = undefined;\n        }\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n}\n//# sourceMappingURL=mount.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { isEmpty, remove } from \"lodash\";\nimport { listenerFactory } from \"./bindListeners.js\";\nimport { getHistory } from \"../history.js\";\nimport { getReadOnlyProxy } from \"./proxyFactories.js\";\nimport { mediaEventTarget } from \"./mediaQuery.js\";\nimport { mountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { unbindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nvar commonLifeCycles = [\"onMount\", \"onUnmount\", \"onMediaChange\", \"onScrollIntoView\"];\nvar pageOnlyLifeCycles = [\"onBeforePageLoad\", \"onPageLoad\", \"onPageLeave\", \"onBeforePageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nvar _memoizedLifeCycle = /*#__PURE__*/new WeakMap();\nvar _observers = /*#__PURE__*/new WeakMap();\nvar _mediaListener = /*#__PURE__*/new WeakMap();\nvar _memoizedControlNodes = /*#__PURE__*/new WeakMap();\nvar _unmountBricks = /*#__PURE__*/new WeakSet();\nvar _initializeRerenderBricks = /*#__PURE__*/new WeakSet();\nvar _dispatchGeneralLifeCycle = /*#__PURE__*/new WeakSet();\nvar _addObserver = /*#__PURE__*/new WeakSet();\nexport class RendererContext {\n  /**\n   * - page: render as whole page, triggering page life cycles.\n   * - fragment: render as fragment, not triggering page life cycles.\n   */\n\n  constructor(scope) {\n    _classPrivateMethodInitSpec(this, _addObserver);\n    // Note: no `onScrollIntoView`\n    _classPrivateMethodInitSpec(this, _dispatchGeneralLifeCycle);\n    _classPrivateMethodInitSpec(this, _initializeRerenderBricks);\n    _classPrivateMethodInitSpec(this, _unmountBricks);\n    _defineProperty(this, \"scope\", void 0);\n    _classPrivateFieldInitSpec(this, _memoizedLifeCycle, {\n      writable: true,\n      value: {\n        onBeforePageLoad: [],\n        onPageLoad: [],\n        onPageLeave: [],\n        onBeforePageLeave: [],\n        onAnchorLoad: [],\n        onAnchorUnload: [],\n        onMediaChange: [],\n        onScrollIntoView: [],\n        onMount: [],\n        onUnmount: []\n      }\n    });\n    // #observers: IntersectionObserver[] = [];\n    _classPrivateFieldInitSpec(this, _observers, {\n      writable: true,\n      value: new Map()\n    });\n    _classPrivateFieldInitSpec(this, _mediaListener, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _memoizedControlNodes, {\n      writable: true,\n      value: void 0\n    });\n    this.scope = scope;\n  }\n  registerBrickLifeCycle(brick, lifeCycle) {\n    if (!lifeCycle) {\n      return;\n    }\n    var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n    for (var key of lifeCycleTypes) {\n      var handlers = lifeCycle[key];\n      if (handlers) {\n        _classPrivateFieldGet(this, _memoizedLifeCycle)[key].push({\n          brick,\n          handlers: handlers\n        });\n      }\n    }\n    // istanbul ignore next\n    if (!isEmpty(lifeCycle.useResolves)) {\n      // eslint-disable-next-line no-console\n      console.error(\"`lifeCycle.useResolves` is dropped in v3:\", lifeCycle);\n    }\n  }\n  memoizeControlNode(slotId, key, node, returnNode) {\n    if (!_classPrivateFieldGet(this, _memoizedControlNodes)) {\n      _classPrivateFieldSet(this, _memoizedControlNodes, new WeakMap());\n    }\n    var memKey = \"\".concat(slotId !== null && slotId !== void 0 ? slotId : \"\", \".\").concat(key);\n    var mem = _classPrivateFieldGet(this, _memoizedControlNodes).get(returnNode);\n    if (!mem) {\n      mem = new Map();\n      _classPrivateFieldGet(this, _memoizedControlNodes).set(returnNode, mem);\n    }\n    mem.set(memKey, {\n      node,\n      last: getLastNode(node),\n      lastNormal: getLastNormalNode(node),\n      lastPortal: getLastPortalNode(node)\n    });\n  }\n  rerenderControlNode(slotId, key, node, returnNode) {\n    var _prevLastNormal$eleme, _prevLastNormal$eleme2, _prevLastPortal$eleme, _prevLastPortal$eleme2;\n    var memKey = \"\".concat(slotId !== null && slotId !== void 0 ? slotId : \"\", \".\").concat(key);\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    var memoized = _classPrivateFieldGet(this, _memoizedControlNodes).get(returnNode).get(memKey);\n    var {\n      node: prevNode,\n      last: prevLast,\n      lastNormal: prevLastNormal,\n      lastPortal: prevLastPortal\n    } = memoized;\n    var insertBeforeChild = (_prevLastNormal$eleme = prevLastNormal === null || prevLastNormal === void 0 ? void 0 : (_prevLastNormal$eleme2 = prevLastNormal.element) === null || _prevLastNormal$eleme2 === void 0 ? void 0 : _prevLastNormal$eleme2.nextSibling) !== null && _prevLastNormal$eleme !== void 0 ? _prevLastNormal$eleme : null;\n    var insertPortalBeforeChild = (_prevLastPortal$eleme = prevLastPortal === null || prevLastPortal === void 0 ? void 0 : (_prevLastPortal$eleme2 = prevLastPortal.element) === null || _prevLastPortal$eleme2 === void 0 ? void 0 : _prevLastPortal$eleme2.nextSibling) !== null && _prevLastPortal$eleme !== void 0 ? _prevLastPortal$eleme : null;\n    var last = getLastNode(node);\n    memoized.node = node;\n    memoized.last = last;\n    memoized.lastNormal = getLastNormalNode(node);\n    memoized.lastPortal = getLastPortalNode(node);\n\n    // Figure out the unchanged prev sibling and next sibling\n    var prevSibling;\n    var current = returnNode.child;\n    while (current && current !== prevLast) {\n      if (current.sibling === prevNode) {\n        prevSibling = current;\n        break;\n      }\n      current = current.sibling;\n    }\n    var fragment = document.createDocumentFragment();\n    var portalFragment = document.createDocumentFragment();\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: fragment,\n      createPortal: portalFragment,\n      child: node\n    };\n\n    // Override `return`\n    current = node;\n    while (current) {\n      current.return = renderRoot;\n      current = current.sibling;\n    }\n\n    // Unmount previous bricks, including their descendants\n    var removeBricks = getBrickRange(prevNode, prevLast);\n    _classPrivateMethodGet(this, _unmountBricks, _unmountBricks2).call(this, removeBricks);\n    mountTree(renderRoot);\n\n    // Connect back\n    if (prevSibling) {\n      prevSibling.sibling = node;\n    } else {\n      returnNode.child = node;\n    }\n    if (last) {\n      last.sibling = prevLast === null || prevLast === void 0 ? void 0 : prevLast.sibling;\n    }\n\n    // Resume `return`\n    current = node;\n    while (current) {\n      current.return = returnNode;\n      current = current.sibling;\n    }\n    if (returnNode.tag === RenderTag.ROOT) {\n      var _returnNode$container;\n      (_returnNode$container = returnNode.container) === null || _returnNode$container === void 0 ? void 0 : _returnNode$container.insertBefore(fragment, insertBeforeChild);\n    } else {\n      var _returnNode$element;\n      (_returnNode$element = returnNode.element) === null || _returnNode$element === void 0 ? void 0 : _returnNode$element.insertBefore(fragment, insertBeforeChild);\n    }\n    if (portalFragment.childNodes.length > 0) {\n      var _root;\n      var root = node;\n      while (root && root.return) {\n        root = root.return;\n      }\n      if (((_root = root) === null || _root === void 0 ? void 0 : _root.tag) !== RenderTag.ROOT) {\n        throw new Error(\"Cannot find render root node\");\n      }\n      var portal = typeof root.createPortal === \"function\" ? root.createPortal() : root.createPortal;\n      portal.insertBefore(portalFragment, insertPortalBeforeChild);\n    }\n    var newBricks = getBrickRange(node, last);\n    _classPrivateMethodGet(this, _initializeRerenderBricks, _initializeRerenderBricks2).call(this, newBricks);\n  }\n  dispose() {\n    for (var list of Object.values(_classPrivateFieldGet(this, _memoizedLifeCycle))) {\n      list.length = 0;\n    }\n    for (var _list of _classPrivateFieldGet(this, _observers).values()) {\n      for (var observer of _list) {\n        observer.disconnect();\n      }\n      _list.length = 0;\n    }\n    _classPrivateFieldGet(this, _observers).clear();\n    if (_classPrivateFieldGet(this, _mediaListener)) {\n      mediaEventTarget.removeEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n      _classPrivateFieldSet(this, _mediaListener, undefined);\n    }\n    _classPrivateFieldSet(this, _memoizedControlNodes, undefined);\n  }\n  dispatchBeforePageLoad() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLoad\", new CustomEvent(\"page.beforeLoad\"));\n  }\n  dispatchPageLoad() {\n    var event = new CustomEvent(\"page.load\");\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLoad\", event);\n    // Currently only for e2e testing\n    window.dispatchEvent(event);\n  }\n  dispatchBeforePageLeave(detail) {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLeave\", new CustomEvent(\"page.beforeLeave\", {\n      detail\n    }));\n  }\n  dispatchPageLeave() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLeave\", new CustomEvent(\"page.leave\"));\n  }\n  dispatchAnchorLoad() {\n    var {\n      hash\n    } = getHistory().location;\n    if (hash && hash !== \"#\") {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorLoad\", new CustomEvent(\"anchor.load\", {\n        detail: {\n          hash,\n          anchor: hash.substring(1)\n        }\n      }));\n    } else {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorUnload\", new CustomEvent(\"anchor.unload\"));\n    }\n  }\n  initializeScrollIntoView() {\n    for (var {\n      brick,\n      handlers: conf\n    } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, brick, conf);\n    }\n  }\n  initializeMediaChange() {\n    _classPrivateFieldSet(this, _mediaListener, event => {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMediaChange\", new CustomEvent(\"media.change\", {\n        detail: getReadOnlyProxy(event.detail)\n      }));\n    });\n    mediaEventTarget.addEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n  }\n  dispatchOnMount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMount\", new CustomEvent(\"mount\"));\n  }\n  dispatchOnUnmount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onUnmount\", new CustomEvent(\"unmount\"));\n  }\n}\nfunction _unmountBricks2(bricks) {\n  var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n  var unmountList = [];\n\n  // Clear life cycle handlers, record `onUnmount` at the same time\n  for (var key of lifeCycleTypes) {\n    var removed = remove(_classPrivateFieldGet(this, _memoizedLifeCycle)[key], item => bricks.has(item.brick));\n    if (key === \"onUnmount\") {\n      unmountList.push(...removed);\n    }\n  }\n\n  // Clear intersection observers\n  for (var brick of bricks) {\n    var _brick$element, _brick$element2;\n    var observers = _classPrivateFieldGet(this, _observers).get(brick);\n    if (observers !== null && observers !== void 0 && observers.length) {\n      for (var observer of observers) {\n        observer.disconnect();\n      }\n      observers.length = 0;\n      _classPrivateFieldGet(this, _observers).delete(brick);\n    }\n    unbindTemplateProxy(brick);\n    (_brick$element = brick.element) === null || _brick$element === void 0 ? true : delete _brick$element.$$tplStateStore;\n\n    // Also remove the element\n    (_brick$element2 = brick.element) === null || _brick$element2 === void 0 ? void 0 : _brick$element2.remove();\n  }\n\n  // Dispatch unmount events\n  var unmountEvent = new CustomEvent(\"unmount\");\n  for (var {\n    brick: _brick,\n    handlers\n  } of unmountList) {\n    listenerFactory(handlers, _brick.runtimeContext, _brick)(unmountEvent);\n  }\n}\nfunction _initializeRerenderBricks2(bricks) {\n  var mountEvent = new CustomEvent(\"mount\");\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onMount) {\n    if (bricks.has(brick)) {\n      listenerFactory(handlers, brick.runtimeContext, brick)(mountEvent);\n    }\n  }\n  for (var {\n    brick: _brick2,\n    handlers: conf\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n    if (bricks.has(_brick2)) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, _brick2, conf);\n    }\n  }\n}\nfunction _dispatchGeneralLifeCycle2(type, event) {\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && this.scope === \"fragment\" && pageOnlyLifeCycles.includes(type)) {\n    throw new Error(\"`lifeCycle.\".concat(type, \"` cannot be used in \").concat(this.scope, \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle)[type]) {\n    listenerFactory(handlers, brick.runtimeContext, brick)(event);\n  }\n}\nfunction _addObserver2(brick, conf) {\n  var _conf$threshold;\n  var threshold = (_conf$threshold = conf.threshold) !== null && _conf$threshold !== void 0 ? _conf$threshold : 0.1;\n  var observer = new IntersectionObserver((entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        if (entry.intersectionRatio >= threshold) {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"scroll.into.view\"));\n          observer.disconnect();\n        }\n      }\n    });\n  }, {\n    threshold\n  });\n  observer.observe(brick.element);\n  var list = _classPrivateFieldGet(this, _observers).get(brick);\n  if (!list) {\n    list = [];\n    _classPrivateFieldGet(this, _observers).set(brick, list);\n  }\n  list.push(observer);\n}\nfunction getLastNode(node) {\n  var last = node;\n  while ((_last = last) !== null && _last !== void 0 && _last.sibling) {\n    var _last;\n    last = last.sibling;\n  }\n  return last;\n}\nfunction getLastNormalNode(node) {\n  var last;\n  var current = node;\n  while (current) {\n    if (!current.portal) {\n      last = current;\n    }\n    current = current.sibling;\n  }\n  return last;\n}\nfunction getLastPortalNode(node) {\n  var last;\n  var current = node;\n  while (current) {\n    if (current.portal) {\n      last = current;\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n  return last;\n}\nfunction getBrickRange(from, to) {\n  var range = new Set();\n  var current = from;\n  while (current) {\n    range.add(current);\n    if (current.child) {\n      current = current.child;\n    } else if (current === to) {\n      break;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn2;\n      var currentReturn = current.return;\n      while (currentReturn && currentReturn !== to) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      if (currentReturn === to) {\n        break;\n      }\n      current = (_currentReturn2 = currentReturn) === null || _currentReturn2 === void 0 ? void 0 : _currentReturn2.sibling;\n    }\n  }\n  return range;\n}\n//# sourceMappingURL=RendererContext.js.map","import { getBasePath } from \"./getBasePath.js\";\nvar misc;\n\n/** 运行时页面信息。*/\n\nexport function getPageInfo() {\n  if (!misc) {\n    misc = {\n      isInIframe: false,\n      isInIframeOfSameSite: false,\n      isInIframeOfNext: false,\n      isInIframeOfVisualBuilder: false,\n      isInIframeOfLegacyConsole: false\n    };\n    if (window !== window.parent) {\n      misc.isInIframe = true;\n      try {\n        // Handle:\n        // - Previewing in visual builder by iframe.\n        // - Nesting next in next.\n        // - Nesting console in next.\n        if (window.origin === window.parent.origin) {\n          misc.isInIframeOfSameSite = true;\n          var selfIsNext = getBasePath() === \"/next/\";\n          var parentPathname = window.parent.location.pathname;\n          var parentIsNext = parentPathname.startsWith(\"/next/\");\n          misc.isInIframeOfNext = (Number(selfIsNext) ^ Number(parentIsNext)) === 0;\n          misc.isInIframeOfVisualBuilder = parentPathname.startsWith(\"\".concat(parentIsNext ? \"/next\" : \"\", \"/visual-builder/\"));\n          misc.isInIframeOfLegacyConsole = selfIsNext && !parentIsNext;\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n    Object.freeze(misc);\n  }\n  return misc;\n}\n//# sourceMappingURL=getPageInfo.js.map","import { isObject } from \"@next-core/utils/general\";\nvar computed = new WeakSet();\n\n// The computed (or transformed) result should never be *computed* again.\n// So does the fetched data from a remote api.\nexport function markAsComputed(value) {\n  if (isObject(value)) {\n    if (!hasBeenComputed(value)) {\n      computed.add(value);\n      if (Array.isArray(value)) {\n        value.forEach(markAsComputed);\n      } else {\n        // Only mark pure objects.\n        var proto = Object.getPrototypeOf(value);\n        if (!proto || proto.constructor === Object) {\n          Object.values(value).forEach(markAsComputed);\n        }\n      }\n    }\n  }\n}\nexport function hasBeenComputed(object) {\n  return computed.has(object);\n}\nexport function resetAllComputedMarks() {\n  computed = new WeakSet();\n}\n//# sourceMappingURL=markAsComputed.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { http } from \"@next-core/http\";\nvar nativeController;\nexport function initAbortController() {\n  if (!window.AbortController) {\n    return;\n  }\n  nativeController = new AbortController();\n  http.interceptors.request.use(config => {\n    var _config$options;\n    return _objectSpread(_objectSpread({}, config), {}, {\n      options: _objectSpread(_objectSpread({}, config.options), {}, {\n        signal: (_config$options = config.options) !== null && _config$options !== void 0 && _config$options.noAbortOnRouteChange ? null : nativeController.signal\n      })\n    });\n  });\n}\nexport function abortPendingRequest() {\n  if (nativeController) {\n    nativeController.abort();\n    nativeController = new AbortController();\n  }\n}\n//# sourceMappingURL=abortController.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取系统初始化信息\n * @endpoint GET /api/auth/v2/bootstrap\n */\nexport var BootstrapV2Api_bootstrapV2 = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (params, options) {\n    return (/**! @contract easyops.api.api_gateway.bootstrap_v2.BootstrapV2@1.1.0 */(yield http.get(\"api/auth/v2/bootstrap\", _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function BootstrapV2Api_bootstrapV2(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=bootstrapV2.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 独立小产品Runtime接口\n * @endpoint GET /api/v1/runtime_standalone\n */\nexport var BootstrapStandaloneApi_runtimeStandalone = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (options) {\n    return (/**! @contract easyops.api.api_gateway.bootstrap_standalone.RuntimeStandalone@1.0.1 */(yield http.get(\"api/v1/runtime_standalone\", options)).data\n    );\n  });\n  return function BootstrapStandaloneApi_runtimeStandalone(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=runtimeStandalone.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取app storyboard初始化信息\n * @endpoint GET /api/auth/v2/bootstrap/:appId\n */\nexport var BootstrapV2Api_getAppStoryboardV2 = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (appId, params, options) {\n    return (/**! @contract easyops.api.api_gateway.bootstrap_v2.GetAppStoryboardV2@1.0.0 */(yield http.get(\"api/auth/v2/bootstrap/\".concat(appId), _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function BootstrapV2Api_getAppStoryboardV2(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=getAppStoryboardV2.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 独立小产品Runtime接口\n * @endpoint GET /api/v1/micro_app_standalone/runtime/:appId\n */\nexport var RuntimeApi_runtimeMicroAppStandalone = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (appId, options) {\n    return (/**! @contract easyops.api.micro_app_standalone.runtime.RuntimeMicroAppStandalone@1.0.1 */(yield http.get(\"api/gateway/micro_app_standalone.runtime.RuntimeMicroAppStandalone/api/v1/micro_app_standalone/runtime/\".concat(appId), options)).data\n    );\n  });\n  return function RuntimeApi_runtimeMicroAppStandalone(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=runtimeMicroAppStandalone.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"feature_flags\"],\n  _excluded2 = [\"featureFlags\", \"misc\"];\nimport { BootstrapStandaloneApi_runtimeStandalone, BootstrapV2Api_bootstrapV2, BootstrapV2Api_getAppStoryboardV2 } from \"@next-api-sdk/api-gateway-sdk\";\nimport { http } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { deepFreeze, hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { merge } from \"lodash\";\nimport { JSON_SCHEMA, safeLoad } from \"js-yaml\";\nimport { RuntimeApi_runtimeMicroAppStandalone } from \"@next-api-sdk/micro-app-standalone-sdk\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nexport function loadBootstrapData() {\n  return _loadBootstrapData.apply(this, arguments);\n}\nfunction _loadBootstrapData() {\n  _loadBootstrapData = _asyncToGenerator(function* () {\n    var data = yield window.STANDALONE_MICRO_APPS ? standaloneBootstrap() : BootstrapV2Api_bootstrapV2({\n      appFields: \"defaultConfig,userConfig,locales,name,homepage,id,currentVersion,installStatus,internal,status,icons,standaloneMode\",\n      ignoreTemplateFields: \"templates\",\n      ignoreBrickFields: \"bricks,processors,providers,editors\"\n    });\n    var _loop = function* () {\n      if (app.locales) {\n        // Prefix to avoid conflict between brick package's i18n namespace.\n        var ns = \"tmp/\".concat(app.id);\n        // Support any languages in `app.locales`.\n        Object.entries(app.locales).forEach(_ref => {\n          var [lang, resources] = _ref;\n          i18n.addResourceBundle(lang, ns, resources);\n        });\n        // Use `app.name` as the fallback `app.localeName`.\n        app.localeName = i18n.getFixedT(null, ns)(\"name\", app.name);\n        // Remove the temporary i18n resource bundles.\n        Object.keys(app.locales).forEach(lang => {\n          i18n.removeResourceBundle(lang, ns);\n        });\n      } else {\n        app.localeName = app.name;\n      }\n    };\n    for (var {\n      app\n    } of data.storyboards) {\n      yield* _loop();\n    }\n    if (isObject(data.settings)) {\n      deepFreeze(data.settings);\n    }\n    data.brickPackages = deepFreeze(data.brickPackages);\n    return data;\n  });\n  return _loadBootstrapData.apply(this, arguments);\n}\nfunction standaloneBootstrap() {\n  return _standaloneBootstrap.apply(this, arguments);\n}\nfunction _standaloneBootstrap() {\n  _standaloneBootstrap = _asyncToGenerator(function* () {\n    var requests = [\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    http.get(window.BOOTSTRAP_FILE), http.get(\"\".concat(window.APP_ROOT, \"conf.yaml\"), {\n      responseType: \"text\"\n    }), BootstrapStandaloneApi_runtimeStandalone().catch(error => {\n      // make it not crash when the backend service is not updated.\n      // eslint-disable-next-line no-console\n      console.warn(\"request runtime api from api-gateway failed: \", error, \", something might went wrong running standalone micro app\");\n    })];\n    if (!window.NO_AUTH_GUARD) {\n      var matches;\n      var appId = window.APP_ID || (window.APP_ROOT && (matches = window.APP_ROOT.match(/^(?:(?:\\/next)?\\/)?sa-static\\/([^/]+)\\/versions\\//)) ? matches[1] : null);\n      if (appId) {\n        // No need to wait.\n        safeGetRuntimeMicroAppStandalone(appId);\n      }\n    }\n    var [bootstrapResult, confString, runtimeData] = yield Promise.all(requests);\n    mergeConf(bootstrapResult, confString);\n    mergeRuntimeSettings(bootstrapResult, runtimeData === null || runtimeData === void 0 ? void 0 : runtimeData.settings);\n    return bootstrapResult;\n  });\n  return _standaloneBootstrap.apply(this, arguments);\n}\nfunction mergeConf(bootstrapResult, confString) {\n  var conf;\n  try {\n    conf = confString ? safeLoad(confString, {\n      schema: JSON_SCHEMA,\n      json: true\n    }) : undefined;\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(\"Parse conf.yaml failed\", error);\n    throw new Error(\"Invalid conf.yaml\");\n  }\n  if (conf) {\n    var {\n      sys_settings,\n      user_config,\n      user_config_by_apps\n    } = conf;\n    if (sys_settings) {\n      var {\n          feature_flags: featureFlags\n        } = sys_settings,\n        rest = _objectWithoutProperties(sys_settings, _excluded);\n      bootstrapResult.settings = _objectSpread({\n        featureFlags\n      }, rest);\n    }\n    if (user_config && bootstrapResult.storyboards.length === 1) {\n      bootstrapResult.storyboards[0].app.userConfig = user_config;\n    } else if (user_config_by_apps) {\n      for (var {\n        app\n      } of bootstrapResult.storyboards) {\n        if (hasOwnProperty(user_config_by_apps, app.id)) {\n          app.userConfig = user_config_by_apps[app.id];\n        }\n      }\n    }\n  }\n}\nfunction mergeRuntimeSettings(bootstrapResult, runtimeSettings) {\n  var _bootstrapResult$sett;\n  if (!runtimeSettings) {\n    return;\n  }\n  // Merge Feature Flags & Misc\n  var {\n      featureFlags,\n      misc\n    } = runtimeSettings,\n    rest = _objectWithoutProperties(runtimeSettings, _excluded2);\n  var settings = (_bootstrapResult$sett = bootstrapResult.settings) !== null && _bootstrapResult$sett !== void 0 ? _bootstrapResult$sett : bootstrapResult.settings = {};\n  settings.featureFlags = _objectSpread(_objectSpread({}, settings.featureFlags), featureFlags);\n  settings.misc = _objectSpread(_objectSpread({}, settings.misc), misc);\n  Object.assign(settings, rest);\n}\nvar appRuntimeDataMap = new Map();\nexport function safeGetRuntimeMicroAppStandalone(_x) {\n  return _safeGetRuntimeMicroAppStandalone.apply(this, arguments);\n}\nfunction _safeGetRuntimeMicroAppStandalone() {\n  _safeGetRuntimeMicroAppStandalone = _asyncToGenerator(function* (appId) {\n    if (appRuntimeDataMap.has(appId)) {\n      return appRuntimeDataMap.get(appId);\n    }\n    var promise = RuntimeApi_runtimeMicroAppStandalone(appId).catch(error => {\n      // make it not crash when the backend service is not updated.\n      // eslint-disable-next-line no-console\n      console.warn(\"request standalone runtime api from micro-app-standalone failed: \", error, \", something might went wrong running standalone micro app\");\n    });\n    appRuntimeDataMap.set(appId, promise);\n    return promise;\n  });\n  return _safeGetRuntimeMicroAppStandalone.apply(this, arguments);\n}\nexport function fulfilStoryboard(_x2) {\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction _fulfilStoryboard() {\n  _fulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    if (storyboard.$$fulfilled) {\n      return;\n    }\n    if (!storyboard.$$fulfilling) {\n      storyboard.$$fulfilling = doFulfilStoryboard(storyboard);\n    }\n    return storyboard.$$fulfilling;\n  });\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction doFulfilStoryboard(_x3) {\n  return _doFulfilStoryboard.apply(this, arguments);\n}\nfunction _doFulfilStoryboard() {\n  _doFulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    if (window.STANDALONE_MICRO_APPS) {\n      Object.assign(storyboard, {\n        $$fulfilled: true,\n        $$fulfilling: null\n      });\n      if (!window.NO_AUTH_GUARD) {\n        var appRuntimeData;\n        try {\n          // Note: the request maybe have fired already during bootstrap.\n          appRuntimeData = yield safeGetRuntimeMicroAppStandalone(storyboard.app.id);\n        } catch (error) {\n          // make it not crash when the backend service is not updated.\n          // eslint-disable-next-line no-console\n          console.warn(\"request standalone runtime api from micro-app-standalone failed: \", error, \", something might went wrong running standalone micro app\");\n        }\n        if (appRuntimeData) {\n          var {\n            userConfig,\n            injectMenus\n          } = appRuntimeData;\n          // Merge `app.defaultConfig` and `app.userConfig` to `app.config`.\n          storyboard.app.userConfig = _objectSpread(_objectSpread({}, storyboard.app.userConfig), userConfig);\n\n          // Initialize `overrideApp.config` in `injectMenus`\n          initializeInjectMenus(injectMenus);\n\n          // get inject menus (Actually, appRuntimeData contains both main and inject menus)\n          storyboard.meta = _objectSpread(_objectSpread({}, storyboard.meta), {}, {\n            injectMenus\n          });\n        }\n      }\n    } else {\n      var {\n        routes,\n        meta,\n        app\n      } = yield BootstrapV2Api_getAppStoryboardV2(storyboard.app.id, {});\n      Object.assign(storyboard, {\n        routes,\n        meta,\n        app: _objectSpread(_objectSpread({}, storyboard.app), app),\n        $$fulfilled: true,\n        $$fulfilling: null\n      });\n    }\n    registerAppI18n(storyboard);\n    initializeAppConfig(storyboard.app);\n  });\n  return _doFulfilStoryboard.apply(this, arguments);\n}\nfunction initializeAppConfig(app) {\n  app.config = deepFreeze(merge({}, app.defaultConfig, app.userConfig));\n}\nfunction initializeInjectMenus(menus) {\n  if (!Array.isArray(menus)) {\n    return;\n  }\n  for (var menu of menus) {\n    if (menu.overrideApp) {\n      initializeAppConfig(menu.overrideApp);\n    }\n  }\n}\n//# sourceMappingURL=loadBootstrapData.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 查询独立部署小产品\n * @endpoint POST /api/v1/micro_app_standalone/search\n */\nexport var RuntimeApi_searchMicroAppStandalone = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.micro_app_standalone.runtime.SearchMicroAppStandalone@1.0.1 */(yield http.post(\"api/gateway/micro_app_standalone.runtime.SearchMicroAppStandalone/api/v1/micro_app_standalone/search\", data, options)).data\n    );\n  });\n  return function RuntimeApi_searchMicroAppStandalone(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=searchMicroAppStandalone.js.map","/**\n * Compare [semver](https://semver.org/) version strings to find greater, equal or lesser.\n * This library supports the full semver specification, including comparing versions with different number of digits like `1.0.0`, `1.0`, `1`, and pre-release versions like `1.0.0-alpha`.\n * @param v1 - First version to compare\n * @param v2 - Second version to compare\n * @returns Numeric value compatible with the [Array.sort(fn) interface](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Parameters).\n */\nexport const compareVersions = (v1, v2) => {\n    // validate input and split into segments\n    const n1 = validateAndParse(v1);\n    const n2 = validateAndParse(v2);\n    // pop off the patch\n    const p1 = n1.pop();\n    const p2 = n2.pop();\n    // validate numbers\n    const r = compareSegments(n1, n2);\n    if (r !== 0)\n        return r;\n    // validate pre-release\n    if (p1 && p2) {\n        return compareSegments(p1.split('.'), p2.split('.'));\n    }\n    else if (p1 || p2) {\n        return p1 ? -1 : 1;\n    }\n    return 0;\n};\n/**\n * Validate [semver](https://semver.org/) version strings.\n *\n * @param version Version number to validate\n * @returns `true` if the version number is a valid semver version number, `false` otherwise.\n *\n * @example\n * ```\n * validate('1.0.0-rc.1'); // return true\n * validate('1.0-rc.1'); // return false\n * validate('foo'); // return false\n * ```\n */\nexport const validate = (version) => typeof version === 'string' && /^[v\\d]/.test(version) && semver.test(version);\n/**\n * Compare [semver](https://semver.org/) version strings using the specified operator.\n *\n * @param v1 First version to compare\n * @param v2 Second version to compare\n * @param operator Allowed arithmetic operator to use\n * @returns `true` if the comparison between the firstVersion and the secondVersion satisfies the operator, `false` otherwise.\n *\n * @example\n * ```\n * compare('10.1.8', '10.0.4', '>'); // return true\n * compare('10.0.1', '10.0.1', '='); // return true\n * compare('10.1.1', '10.2.2', '<'); // return true\n * compare('10.1.1', '10.2.2', '<='); // return true\n * compare('10.1.1', '10.2.2', '>='); // return false\n * ```\n */\nexport const compare = (v1, v2, operator) => {\n    // validate input operator\n    assertValidOperator(operator);\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    const res = compareVersions(v1, v2);\n    return operatorResMap[operator].includes(res);\n};\n/**\n * Match [npm semver](https://docs.npmjs.com/cli/v6/using-npm/semver) version range.\n *\n * @param version Version number to match\n * @param range Range pattern for version\n * @returns `true` if the version number is within the range, `false` otherwise.\n *\n * @example\n * ```\n * satisfies('1.1.0', '^1.0.0'); // return true\n * satisfies('1.1.0', '~1.0.0'); // return false\n * ```\n */\nexport const satisfies = (version, range) => {\n    // if no range operator then \"=\"\n    const m = range.match(/^([<>=~^]+)/);\n    const op = m ? m[1] : '=';\n    // if gt/lt/eq then operator compare\n    if (op !== '^' && op !== '~')\n        return compare(version, range, op);\n    // else range of either \"~\" or \"^\" is assumed\n    const [v1, v2, v3, , vp] = validateAndParse(version);\n    const [r1, r2, r3, , rp] = validateAndParse(range);\n    const v = [v1, v2, v3];\n    const r = [r1, r2 !== null && r2 !== void 0 ? r2 : 'x', r3 !== null && r3 !== void 0 ? r3 : 'x'];\n    // validate pre-release\n    if (rp) {\n        if (!vp)\n            return false;\n        if (compareSegments(v, r) !== 0)\n            return false;\n        if (compareSegments(vp.split('.'), rp.split('.')) === -1)\n            return false;\n    }\n    // first non-zero number\n    const nonZero = r.findIndex((v) => v !== '0') + 1;\n    // pointer to where segments can be >=\n    const i = op === '~' ? 2 : nonZero > 1 ? nonZero : 1;\n    // before pointer must be equal\n    if (compareSegments(v.slice(0, i), r.slice(0, i)) !== 0)\n        return false;\n    // after pointer must be >=\n    if (compareSegments(v.slice(i), r.slice(i)) === -1)\n        return false;\n    return true;\n};\nconst semver = /^[v^~<>=]*?(\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+))?(?:-([\\da-z\\-]+(?:\\.[\\da-z\\-]+)*))?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\nconst validateAndParse = (version) => {\n    if (typeof version !== 'string') {\n        throw new TypeError('Invalid argument expected string');\n    }\n    const match = version.match(semver);\n    if (!match) {\n        throw new Error(`Invalid argument not valid semver ('${version}' received)`);\n    }\n    match.shift();\n    return match;\n};\nconst isWildcard = (s) => s === '*' || s === 'x' || s === 'X';\nconst tryParse = (v) => {\n    const n = parseInt(v, 10);\n    return isNaN(n) ? v : n;\n};\nconst forceType = (a, b) => typeof a !== typeof b ? [String(a), String(b)] : [a, b];\nconst compareStrings = (a, b) => {\n    if (isWildcard(a) || isWildcard(b))\n        return 0;\n    const [ap, bp] = forceType(tryParse(a), tryParse(b));\n    if (ap > bp)\n        return 1;\n    if (ap < bp)\n        return -1;\n    return 0;\n};\nconst compareSegments = (a, b) => {\n    for (let i = 0; i < Math.max(a.length, b.length); i++) {\n        const r = compareStrings(a[i] || '0', b[i] || '0');\n        if (r !== 0)\n            return r;\n    }\n    return 0;\n};\nconst operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1],\n};\nconst allowedOperators = Object.keys(operatorResMap);\nconst assertValidOperator = (op) => {\n    if (typeof op !== 'string') {\n        throw new TypeError(`Invalid operator type, expected string but got ${typeof op}`);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n        throw new Error(`Invalid operator, expected one of ${allowedOperators.join('|')}`);\n    }\n};\n//# sourceMappingURL=index.js.map","function collectMemberCallUsageFactory(object, property) {\n  return function collectMemberCallUsage(usage, node, parent) {\n    if (node.name === object) {\n      var memberParent = parent[parent.length - 1];\n      var callParent = parent[parent.length - 2];\n      if ((callParent === null || callParent === void 0 ? void 0 : callParent.node.type) === \"CallExpression\" && (callParent === null || callParent === void 0 ? void 0 : callParent.key) === \"callee\" && (memberParent === null || memberParent === void 0 ? void 0 : memberParent.node.type) === \"MemberExpression\" && memberParent.key === \"object\" && (memberParent.node.computed ? memberParent.node.property.type === \"Literal\" && memberParent.node.property.value === property : memberParent.node.property.type === \"Identifier\" && memberParent.node.property.name === property)) {\n        var args = callParent.node.arguments;\n        if (args.length > 0) {\n          var firstArg = args[0];\n          if (firstArg.type === \"Literal\" && typeof firstArg.value === \"string\") {\n            usage.usedArgs.add(firstArg.value);\n          } else {\n            usage.hasNonStaticUsage = true;\n          }\n        }\n      }\n    }\n  };\n}\nexport var collectAppGetMenuUsage = collectMemberCallUsageFactory(\"APP\", \"getMenu\");\nexport var collectInstalledAppsHasUsage = collectMemberCallUsageFactory(\"INSTALLED_APPS\", \"has\");\n//# sourceMappingURL=collectMemberCallUsage.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { traverseStoryboardExpressions } from \"@next-core/utils/storyboard\";\nimport { RuntimeApi_searchMicroAppStandalone } from \"@next-api-sdk/micro-app-standalone-sdk\";\nimport { compare } from \"compare-versions\";\nimport { collectInstalledAppsHasUsage } from \"./compute/collectMemberCallUsage.js\";\nimport { _internalApiGetAppInBootstrapData } from \"./Runtime.js\";\nvar checkingApps = new Map();\nvar checkedApps = new Map();\nexport function preCheckInstalledApps(storyboard) {\n  if (window.STANDALONE_MICRO_APPS && !window.NO_AUTH_GUARD) {\n    var appIds = scanInstalledAppsUsage(storyboard);\n    var searchIds = [];\n    for (var appId of appIds) {\n      // Do not check these apps already checking or in bootstrap.\n      if (!checkingApps.has(appId) && !_internalApiGetAppInBootstrapData(appId)) {\n        searchIds.push(appId);\n      }\n    }\n    if (searchIds.length === 0) {\n      return;\n    }\n    var promise = RuntimeApi_searchMicroAppStandalone({\n      query: {\n        appId: {\n          $in: searchIds\n        }\n      },\n      fields: [\"appId\", \"currentVersion\", \"installStatus\"]\n    }).catch(error => {\n      // Allow search micro app to fail, and\n      // make it not crash when the backend service is not updated.\n      // eslint-disable-next-line no-console\n      console.error(\"Get off site standalone micro-apps failed\", error);\n    });\n    var _loop = function (_appId) {\n      checkingApps.set(_appId, promise.then(result => {\n        var _result$list;\n        var app = result === null || result === void 0 ? void 0 : (_result$list = result.list) === null || _result$list === void 0 ? void 0 : _result$list.find(item => item.appId === _appId);\n        var checkedApp = app ? _objectSpread(_objectSpread({}, app), {}, {\n          id: _appId\n        }) : undefined;\n        checkedApps.set(_appId, checkedApp);\n        return checkedApp;\n      }));\n    };\n    for (var _appId of searchIds) {\n      _loop(_appId);\n    }\n  }\n}\nexport function waitForCheckingApps(appIds) {\n  return Promise.all(appIds.map(appId => checkingApps.get(appId)));\n}\nexport function hasInstalledApp(appId, matchVersion) {\n  // First, check whether the app is in bootstrap already.\n  var app = _internalApiGetAppInBootstrapData(appId);\n  if (!app && window.STANDALONE_MICRO_APPS) {\n    app = checkedApps.get(appId);\n  }\n  if (!app || app.installStatus === \"running\") {\n    return false;\n  }\n  // Todo: `currentVersion` maybe `\"\"`\n  if (!matchVersion || !app.currentVersion) {\n    return true;\n  }\n  // Valid `matchVersion`:\n  //   >=1.2.3\n  //   >1.2.3\n  //   =1.2.3\n  //   <=1.2.3\n  //   <1.2.3\n  var matches = matchVersion.match(/^([><]=?|=)(.*)$/);\n  try {\n    if (!matches) {\n      throw new TypeError(\"Invalid match version: \".concat(matchVersion));\n    }\n    return compare(app.currentVersion, matches[2], matches[1]);\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error);\n  }\n  return false;\n}\nfunction scanInstalledAppsUsage(storyboard) {\n  var _storyboard$meta;\n  var usage = {\n    usedArgs: new Set()\n  };\n  // `INSTALLED_APPS.has(...)` is not available in storyboard functions\n  var {\n    customTemplates,\n    menus\n  } = (_storyboard$meta = storyboard.meta) !== null && _storyboard$meta !== void 0 ? _storyboard$meta : {};\n  traverseStoryboardExpressions([storyboard.routes, customTemplates, menus], (node, parent) => {\n    collectInstalledAppsHasUsage(usage, node, parent);\n  }, \"INSTALLED_APPS\");\n  return [...usage.usedArgs];\n}\n//# sourceMappingURL=checkInstalledApps.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport { locationsAreEqual } from \"history\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { HttpAbortError } from \"@next-core/http\";\nimport { uniqueId } from \"lodash\";\nimport { getHistory } from \"../history.js\";\nimport { renderRoutes } from \"./Renderer.js\";\nimport { DataStore } from \"./data/DataStore.js\";\nimport { clearResolveCache } from \"./data/resolveData.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { isOutsideApp, matchStoryboard } from \"./matchStoryboard.js\";\nimport { registerStoryboardFunctions } from \"./compute/StoryboardFunctions.js\";\nimport { preCheckPermissions } from \"./checkPermissions.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { applyMode, applyTheme, getLocalAppsTheme, setMode, setTheme } from \"../themeAndMode.js\";\nimport { getRuntime } from \"./Runtime.js\";\nimport { getAuth, isLoggedIn } from \"../auth.js\";\nimport { getPageInfo } from \"../getPageInfo.js\";\nimport { resetAllComputedMarks } from \"./compute/markAsComputed.js\";\nimport { handleHttpError, httpErrorToString, isUnauthenticatedError } from \"../handleHttpError.js\";\nimport { abortPendingRequest, initAbortController } from \"./abortController.js\";\nimport { registerCustomTemplates } from \"./registerCustomTemplates.js\";\nimport { clearCollectWidgetContract, collectContract } from \"./data/CollectContracts.js\";\nimport { fulfilStoryboard } from \"./loadBootstrapData.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { preCheckInstalledApps } from \"./checkInstalledApps.js\";\nimport { insertPreviewRoutes } from \"./insertPreviewRoutes.js\";\nvar _storyboards = /*#__PURE__*/new WeakMap();\nvar _rendering = /*#__PURE__*/new WeakMap();\nvar _prevLocation = /*#__PURE__*/new WeakMap();\nvar _nextLocation = /*#__PURE__*/new WeakMap();\nvar _runtimeContext = /*#__PURE__*/new WeakMap();\nvar _rendererContext = /*#__PURE__*/new WeakMap();\nvar _rendererContextTrashCan = /*#__PURE__*/new WeakMap();\nvar _redirectCount = /*#__PURE__*/new WeakMap();\nvar _renderId = /*#__PURE__*/new WeakMap();\nvar _currentApp = /*#__PURE__*/new WeakMap();\nvar _previousApp = /*#__PURE__*/new WeakMap();\nvar _navConfig = /*#__PURE__*/new WeakMap();\nvar _getBlockMessageBeforePageLave = /*#__PURE__*/new WeakSet();\nvar _safeRedirect = /*#__PURE__*/new WeakSet();\nvar _queuedRender = /*#__PURE__*/new WeakSet();\nvar _render = /*#__PURE__*/new WeakSet();\nexport class Router {\n  constructor(storyboards) {\n    _classPrivateMethodInitSpec(this, _render);\n    _classPrivateMethodInitSpec(this, _queuedRender);\n    _classPrivateMethodInitSpec(this, _safeRedirect);\n    _classPrivateMethodInitSpec(this, _getBlockMessageBeforePageLave);\n    _classPrivateFieldInitSpec(this, _storyboards, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendering, {\n      writable: true,\n      value: false\n    });\n    _classPrivateFieldInitSpec(this, _prevLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _nextLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _runtimeContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContextTrashCan, {\n      writable: true,\n      value: new Set()\n    });\n    _classPrivateFieldInitSpec(this, _redirectCount, {\n      writable: true,\n      value: 0\n    });\n    _classPrivateFieldInitSpec(this, _renderId, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _currentApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _previousApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _navConfig, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldSet(this, _storyboards, storyboards);\n    var _history = getHistory();\n    window.addEventListener(\"beforeunload\", event => {\n      var message = _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {});\n      // See examples in https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload\n      if (message) {\n        // Cancel the event\n        // If you prevent default behavior in Mozilla Firefox prompt will always be shown\n        event.preventDefault();\n        // Chrome requires returnValue to be set\n        event.returnValue = \"\";\n      } else {\n        // the absence of a returnValue property on the event will guarantee the browser unload happens\n        delete event.returnValue;\n      }\n    });\n    _history.block((location, action) => _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {\n      location,\n      action\n    }));\n  }\n  getRenderId() {\n    return _classPrivateFieldGet(this, _renderId);\n  }\n  getRuntimeContext() {\n    return _classPrivateFieldGet(this, _runtimeContext);\n  }\n  getRecentApps() {\n    return {\n      currentApp: _classPrivateFieldGet(this, _currentApp),\n      previousApp: _classPrivateFieldGet(this, _previousApp)\n    };\n  }\n  getNavConfig() {\n    return _classPrivateFieldGet(this, _navConfig);\n  }\n  bootstrap() {\n    initAbortController();\n    var history = getHistory();\n    _classPrivateFieldSet(this, _prevLocation, history.location);\n    history.listen((location, action) => {\n      var _classPrivateFieldGet2, _location$state, _classPrivateFieldGet3;\n      var ignoreRendering = false;\n      var omittedLocationProps = {\n        hash: undefined,\n        state: undefined\n      };\n      // Omit the \"key\" when checking whether locations are equal in certain situations.\n      if (\n      // When current location is triggered by browser action of hash link.\n      location.key === undefined ||\n      // When current location is triggered by browser action of non-push-or-replace,\n      // such as goBack or goForward,\n      action === \"POP\" && (\n      // and the previous location was triggered by hash link,\n      _classPrivateFieldGet(this, _prevLocation).key === undefined ||\n      // or the previous location specified notify false.\n      ((_classPrivateFieldGet2 = _classPrivateFieldGet(this, _prevLocation).state) === null || _classPrivateFieldGet2 === void 0 ? void 0 : _classPrivateFieldGet2.notify) === false)) {\n        omittedLocationProps.key = undefined;\n      }\n      if (locationsAreEqual(_objectSpread(_objectSpread({}, _classPrivateFieldGet(this, _prevLocation)), omittedLocationProps), _objectSpread(_objectSpread({}, location), omittedLocationProps)) || action !== \"POP\" && ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.notify) === false) {\n        // Ignore rendering if location not changed except hash, state and optional key.\n        // Ignore rendering if notify is `false`.\n        ignoreRendering = true;\n      }\n      if (ignoreRendering) {\n        _classPrivateFieldSet(this, _prevLocation, location);\n        return;\n      }\n      abortPendingRequest();\n      _classPrivateFieldSet(this, _prevLocation, location);\n      (_classPrivateFieldGet3 = _classPrivateFieldGet(this, _rendererContext)) === null || _classPrivateFieldGet3 === void 0 ? void 0 : _classPrivateFieldGet3.dispatchPageLeave();\n      // this.locationContext.messageDispatcher.reset();\n\n      if (action === \"POP\") {\n        var storyboard = matchStoryboard(_classPrivateFieldGet(this, _storyboards), location.pathname);\n        // When a browser action of goBack or goForward is performing,\n        // force reload when the target page is a page of an outside app.\n        if (isOutsideApp(storyboard)) {\n          window.location.reload();\n          return;\n        }\n      }\n      if (_classPrivateFieldGet(this, _rendering)) {\n        _classPrivateFieldSet(this, _nextLocation, location);\n      } else {\n        // devtoolsHookEmit(\"locationChange\");\n        _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, location).catch(handleHttpError);\n      }\n    });\n    return _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, history.location);\n  }\n}\nfunction _getBlockMessageBeforePageLave2(detail) {\n  var _classPrivateFieldGet4;\n  var history = getHistory();\n  var previousMessage = history.getBlockMessage();\n  (_classPrivateFieldGet4 = _classPrivateFieldGet(this, _rendererContext)) === null || _classPrivateFieldGet4 === void 0 ? void 0 : _classPrivateFieldGet4.dispatchBeforePageLeave(detail);\n  var message = history.getBlockMessage();\n  if (!previousMessage && message) {\n    // Auto unblock only if new block was introduced by `onBeforePageLeave`.\n    history.unblock();\n  }\n  return message;\n}\nfunction _safeRedirect2(to, state, from) {\n  var _this$redirectCount, _this$redirectCount2;\n  if ((_classPrivateFieldSet(this, _redirectCount, (_this$redirectCount = _classPrivateFieldGet(this, _redirectCount), _this$redirectCount2 = _this$redirectCount++, _this$redirectCount)), _this$redirectCount2) > 10) {\n    var message = \"Infinite redirect detected: from \\\"\".concat(from.pathname).concat(from.search).concat(from.hash, \"\\\" to \\\"\").concat(to, \"\\\"\");\n    // istanbul ignore else: error cannot be caught in test\n    if (process.env.NODE_ENV === \"test\") {\n      // eslint-disable-next-line no-console\n      console.error(message);\n      return;\n    } else {\n      throw new Error(message);\n    }\n  }\n  getHistory().replace(to, state);\n}\nfunction _queuedRender2(_x) {\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _queuedRender3() {\n  _queuedRender3 = _asyncToGenerator(function* (location) {\n    _classPrivateFieldSet(this, _rendering, true);\n    try {\n      yield _classPrivateMethodGet(this, _render, _render2).call(this, location);\n    } finally {\n      _classPrivateFieldSet(this, _rendering, false);\n      if (_classPrivateFieldGet(this, _nextLocation)) {\n        var nextLocation = _classPrivateFieldGet(this, _nextLocation);\n        _classPrivateFieldSet(this, _nextLocation, undefined);\n        yield _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, nextLocation);\n      }\n    }\n  });\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _render2(_x2) {\n  return _render3.apply(this, arguments);\n}\nfunction _render3() {\n  _render3 = _asyncToGenerator(function* (location) {\n    var _classPrivateFieldGet5;\n    _classPrivateFieldSet(this, _renderId, uniqueId(\"render-id-1\"));\n    resetAllComputedMarks();\n    clearResolveCache();\n    clearCollectWidgetContract();\n    var history = getHistory();\n    history.unblock();\n    var storyboard = matchStoryboard(_classPrivateFieldGet(this, _storyboards), location.pathname);\n    var previousApp = (_classPrivateFieldGet5 = _classPrivateFieldGet(this, _runtimeContext)) === null || _classPrivateFieldGet5 === void 0 ? void 0 : _classPrivateFieldGet5.app;\n    if (storyboard !== null && storyboard !== void 0 && storyboard.app) {\n      yield fulfilStoryboard(storyboard);\n    }\n    var currentApp = _classPrivateFieldSet(this, _currentApp, storyboard === null || storyboard === void 0 ? void 0 : storyboard.app);\n\n    // Storyboard maybe re-assigned, e.g. when open launchpad.\n    var appChanged = previousApp && currentApp ? previousApp.id !== currentApp.id : previousApp !== currentApp;\n\n    // TODO: handle favicon\n\n    // Set `Router::#currentApp` before calling `getFeatureFlags()`\n    var flags = getRuntime().getFeatureFlags();\n    var prevRendererContext = _classPrivateFieldGet(this, _rendererContext);\n    var redirectTo = (to, state) => {\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      _classPrivateMethodGet(this, _safeRedirect, _safeRedirect2).call(this, to, state, location);\n    };\n    var redirectToLogin = () => {\n      var to = flags[\"sso-enabled\"] ? \"/sso-auth/login\" : \"/auth/login\";\n      redirectTo(to, {\n        from: location\n      });\n    };\n    var main = document.querySelector(\"#main-mount-point\");\n    var portal = document.querySelector(\"#portal-mount-point\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: main,\n      createPortal: portal\n    };\n    var cleanUpPreviousRender = () => {\n      unmountTree(main);\n      unmountTree(portal);\n\n      // Note: redirects can lead to multiple trash renderer contexts.\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      for (var item of _classPrivateFieldGet(this, _rendererContextTrashCan)) {\n        if (item) {\n          item.dispatchOnUnmount();\n          item.dispose();\n        }\n      }\n      _classPrivateFieldGet(this, _rendererContextTrashCan).clear();\n      setTheme(currentApp && (getLocalAppsTheme()[currentApp.id] || currentApp.theme) || \"light\");\n      setMode(\"default\");\n      if (appChanged) {\n        _classPrivateFieldSet(this, _previousApp, previousApp);\n        window.dispatchEvent(new CustomEvent(\"app.change\", {\n          detail: {\n            previousApp,\n            currentApp\n          }\n        }));\n      }\n    };\n    if (currentApp) {\n      var _storyboard$meta, _storyboard$meta2;\n      preCheckInstalledApps(storyboard);\n      var runtimeContext = _classPrivateFieldSet(this, _runtimeContext, {\n        app: currentApp,\n        location,\n        query: new URLSearchParams(location.search),\n        flags,\n        sys: _objectSpread(_objectSpread({}, getAuth()), getPageInfo()),\n        ctxStore: new DataStore(\"CTX\"),\n        pendingPermissionsPreCheck: [preCheckPermissions(storyboard)],\n        tplStateStoreMap: new Map()\n      });\n      var rendererContext = _classPrivateFieldSet(this, _rendererContext, new RendererContext(\"page\"));\n      _classPrivateFieldSet(this, _navConfig, undefined);\n      registerCustomTemplates(storyboard);\n      registerStoryboardFunctions((_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.functions, currentApp);\n      collectContract((_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.contracts);\n      var failed = false;\n      var output;\n      try {\n        output = yield renderRoutes(renderRoot, insertPreviewRoutes(storyboard.routes), runtimeContext, rendererContext);\n        if (output.unauthenticated) {\n          redirectToLogin();\n          return;\n        }\n        if (output.redirect) {\n          redirectTo(output.redirect.path, output.redirect.state);\n          return;\n        }\n        // Reset redirect count if no redirect is set.\n        _classPrivateFieldSet(this, _redirectCount, 0);\n        flushStableLoadBricks();\n        yield Promise.all([...output.blockingList, runtimeContext.ctxStore.waitForAll(), ...[...runtimeContext.tplStateStoreMap.values()].map(store => store.waitForAll()),\n        // Todo: load processors only when they would used in current rendering.\n        // loadProcessorsImperatively(\n        //   strictCollectMemberUsage(\n        //     [storyboard.routes, storyboard.meta?.customTemplates],\n        //     \"PROCESSORS\",\n        //     2\n        //   ),\n        //   getBrickPackages()\n        // ),\n        ...runtimeContext.pendingPermissionsPreCheck]);\n        var menuConfs = yield Promise.all(output.menuRequests);\n        _classPrivateFieldSet(this, _navConfig, mergeMenuConfs(menuConfs));\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error(\"Router failed:\", error);\n        if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n          redirectToLogin();\n          return;\n        } else if (error instanceof HttpAbortError) {\n          _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n          return;\n        } else {\n          failed = true;\n          output = {\n            node: {\n              tag: RenderTag.BRICK,\n              type: \"div\",\n              properties: {\n                textContent: httpErrorToString(error)\n              },\n              runtimeContext: null,\n              return: renderRoot\n            },\n            blockingList: [],\n            menuRequests: []\n          };\n        }\n      }\n      renderRoot.child = output.node;\n      cleanUpPreviousRender();\n      if (output.route && output.route.type !== \"routes\" || failed) {\n        if (!failed) {\n          // There is a window to set theme and mode by `lifeCycle.onBeforePageLoad`.\n          rendererContext.dispatchBeforePageLoad();\n        }\n        applyTheme();\n        applyMode();\n        mountTree(renderRoot);\n\n        // Scroll to top after each rendering.\n        // See https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/scroll-restoration.md\n        window.scrollTo(0, 0);\n        if (!failed) {\n          rendererContext.dispatchPageLoad();\n          rendererContext.dispatchAnchorLoad();\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n        }\n        return;\n      }\n    } else if (!window.NO_AUTH_GUARD && !isLoggedIn()) {\n      // Todo(steve): refine after api-gateway supports fetching storyboards before logged in.\n      // Redirect to login if no storyboard is matched.\n      redirectToLogin();\n      return;\n    } else {\n      cleanUpPreviousRender();\n    }\n    applyTheme();\n    applyMode();\n    var node = {\n      tag: RenderTag.BRICK,\n      type: \"div\",\n      properties: {\n        textContent: \"Page not found\"\n      },\n      runtimeContext: null,\n      return: renderRoot\n    };\n    renderRoot.child = node;\n    mountTree(renderRoot);\n\n    // Scroll to top after each rendering.\n    window.scrollTo(0, 0);\n  });\n  return _render3.apply(this, arguments);\n}\nfunction mergeMenuConfs(menuConfs) {\n  var navConfig = {\n    breadcrumb: []\n  };\n  for (var menuConf of menuConfs) {\n    if (menuConf) {\n      var {\n        breadcrumb\n      } = menuConf;\n      if (breadcrumb) {\n        if (breadcrumb.overwrite) {\n          navConfig.breadcrumb = breadcrumb.items;\n        } else {\n          navConfig.breadcrumb.push(...breadcrumb.items);\n        }\n      }\n    }\n  }\n  return navConfig;\n}\n//# sourceMappingURL=Router.js.map","import { customTemplates } from \"../CustomTemplates.js\";\nexport function registerCustomTemplates(storyboard) {\n  var _storyboard$meta;\n  if (storyboard.$$registerCustomTemplateProcessed) {\n    return;\n  }\n  storyboard.$$registerCustomTemplateProcessed = true;\n  var templates = (_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.customTemplates;\n  if (Array.isArray(templates)) {\n    for (var tpl of templates) {\n      var tagName = tpl.name.includes(\".\") ? tpl.name : \"\".concat(storyboard.app.id, \".\").concat(tpl.name);\n      customTemplates.define(tagName, tpl);\n    }\n  }\n}\n//# sourceMappingURL=registerCustomTemplates.js.map","import { findLastIndex } from \"lodash\";\nexport function insertPreviewRoutes(routes) {\n  // Insert preview routes for iframe only.\n  if (window.parent === window) {\n    return routes;\n  }\n  var mergedRoutes = routes;\n  var specificTemplatePreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/template-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificTemplatePreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/template-preview/:templateId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificTemplatePreviewIndex + 1)];\n  var specificSnippetPreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/snippet-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificSnippetPreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/snippet-preview/:snippetId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificSnippetPreviewIndex + 1)];\n  return mergedRoutes;\n}\n//# sourceMappingURL=insertPreviewRoutes.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 判断用户是否登录\n * @endpoint GET /api/auth/login\n */\nexport var AuthApi_checkLogin = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (options) {\n    return (/**! @contract easyops.api.api_gateway.auth.CheckLogin@1.1.4 */(yield http.get(\"api/auth/login\", options)).data\n    );\n  });\n  return function AuthApi_checkLogin(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=checkLogin.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { AuthApi_checkLogin } from \"@next-api-sdk/api-gateway-sdk\";\nimport { authenticate } from \"../auth.js\";\nexport function loadCheckLogin() {\n  return _loadCheckLogin.apply(this, arguments);\n}\nfunction _loadCheckLogin() {\n  _loadCheckLogin = _asyncToGenerator(function* () {\n    if (!window.NO_AUTH_GUARD) {\n      var auth = yield AuthApi_checkLogin();\n      if (auth.loggedIn) {\n        authenticate(auth);\n      }\n    }\n  });\n  return _loadCheckLogin.apply(this, arguments);\n}\n//# sourceMappingURL=loadCheckLogin.js.map","// Allow inject bootstrap data in a runtime other than Brick Next.\nexport var injectedBootstrapData =\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntypeof BOOTSTRAP_DATA !== \"undefined\" ? BOOTSTRAP_DATA : undefined;\n//# sourceMappingURL=bootstrapData.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nvar widgetFunctionRegistry = new Map();\nexport var widgetFunctions = new Proxy(Object.freeze({}), {\n  get(target, key) {\n    return widgetFunctionRegistry.get(key);\n  }\n});\nexport function registerWidgetFunctions(widgetId, functions, widgetVersion) {\n  if (widgetFunctionRegistry.has(widgetId)) {\n    // eslint-disable-next-line no-console\n    throw new Error(\"Widget functions of \\\"\".concat(widgetId, \"\\\" already registered\"));\n  }\n  var {\n    storyboardFunctions,\n    registerStoryboardFunctions\n  } = StoryboardFunctionRegistryFactory({\n    widgetId,\n    widgetVersion\n  });\n  widgetFunctionRegistry.set(widgetId, storyboardFunctions);\n  registerStoryboardFunctions(functions);\n}\n//# sourceMappingURL=WidgetFunctions.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 搜索实例\n * @endpoint POST /object/:objectId/instance/_search\n */\nexport var InstanceApi_postSearch = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (objectId, data, options) {\n    return (/**! @contract easyops.api.cmdb.instance.PostSearch@1.1.0 */(yield http.post(\"api/gateway/cmdb.instance.PostSearch/object/\".concat(objectId, \"/instance/_search\"), data, options)).data\n    );\n  });\n  return function InstanceApi_postSearch(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=postSearch.js.map","export var symbolAppId = Symbol(\"appId\");\nexport var symbolMenuI18nNamespace = Symbol(\"menuI18nNamespace\");\nexport var symbolOverrideApp = Symbol(\"overrideApp\");\n//# sourceMappingURL=constants.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { _internalApiGetAppInBootstrapData } from \"../Runtime.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nexport function loadDynamicMenuItems(_x, _x2, _x3) {\n  return _loadDynamicMenuItems.apply(this, arguments);\n}\nfunction _loadDynamicMenuItems() {\n  _loadDynamicMenuItems = _asyncToGenerator(function* (menu, runtimeContext, menuWithI18n) {\n    if (menu.dynamicItems && menu.itemsResolve) {\n      var overrideAppId = menu.app[0].appId;\n      var newRuntimeContext = runtimeContext;\n      if (overrideAppId !== runtimeContext.app.id) {\n        var overrideApp = window.STANDALONE_MICRO_APPS ? menu.overrideApp : _internalApiGetAppInBootstrapData(overrideAppId);\n        newRuntimeContext = _objectSpread(_objectSpread({}, runtimeContext), {}, {\n          overrideApp,\n          appendI18nNamespace: menuWithI18n.get(menu)\n        });\n      }\n      var resolved = yield resolveData(_objectSpread({\n        transform: \"items\"\n      }, menu.itemsResolve), newRuntimeContext);\n      menu.items = resolved.items;\n    }\n  });\n  return _loadDynamicMenuItems.apply(this, arguments);\n}\n//# sourceMappingURL=loadDynamicMenuItems.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { symbolAppId, symbolMenuI18nNamespace, symbolOverrideApp } from \"./constants.js\";\nimport { loadDynamicMenuItems } from \"./loadDynamicMenuItems.js\";\nexport function mergeMenu(_x, _x2) {\n  return _mergeMenu.apply(this, arguments);\n}\nfunction _mergeMenu() {\n  _mergeMenu = _asyncToGenerator(function* (menuList, runtimeContext) {\n    var mainMenu = menuList.find(menu => menu.type !== \"inject\");\n    if (!mainMenu) {\n      return undefined;\n    }\n    var validMenuList = [];\n    var injectWithMenus = new Map();\n    var menuWithI18n = new WeakMap();\n    var _loop = function* () {\n      if (menu.i18n) {\n        var menuI18nNamespace = getI18nNamespace(\"menu\", \"\".concat(menu.menuId, \"~\").concat(menu.app[0].appId, \"+\").concat(menu.instanceId));\n        // Support any language in `menu.i18n`.\n        Object.entries(menu.i18n).forEach(_ref => {\n          var [lang, resources] = _ref;\n          i18n.addResourceBundle(lang, menuI18nNamespace, resources);\n        });\n        menuWithI18n.set(menu, menuI18nNamespace);\n      }\n    };\n    for (var menu of menuList) {\n      yield* _loop();\n    }\n    yield Promise.all(menuList.map(menu => loadDynamicMenuItems(menu, runtimeContext, menuWithI18n)));\n    for (var _menu of menuList) {\n      var _menu$items;\n      if ((_menu$items = _menu.items) !== null && _menu$items !== void 0 && _menu$items.length) {\n        if (_menu.type === \"inject\" && _menu.injectMenuGroupId) {\n          var injectingMenus = injectWithMenus.get(_menu.injectMenuGroupId);\n          if (!injectingMenus) {\n            injectingMenus = [];\n            injectWithMenus.set(_menu.injectMenuGroupId, injectingMenus);\n          }\n          injectingMenus.push(_menu);\n        } else {\n          validMenuList.push(_menu);\n        }\n      }\n    }\n    return _objectSpread(_objectSpread({}, mainMenu), {}, {\n      items: validMenuList.flatMap(menu =>\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      processGroupInject(menu.items, menu, injectWithMenus, menuWithI18n)),\n      [symbolMenuI18nNamespace]: menuWithI18n.get(mainMenu),\n      [symbolOverrideApp]: mainMenu.overrideApp\n    });\n  });\n  return _mergeMenu.apply(this, arguments);\n}\nfunction processGroupInject(items, menu, injectWithMenus, menuWithI18n) {\n  return items === null || items === void 0 ? void 0 : items.map(item => {\n    var _processGroupInject;\n    var foundInjectingMenus = item.groupId && injectWithMenus.get(item.groupId);\n    if (foundInjectingMenus) {\n      // Each menu to be injected with should be injected only once.\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      injectWithMenus.delete(item.groupId);\n    }\n    return _objectSpread(_objectSpread({}, item), {}, {\n      children: ((_processGroupInject = processGroupInject(item.children, menu, injectWithMenus, menuWithI18n)) !== null && _processGroupInject !== void 0 ? _processGroupInject : []).concat(foundInjectingMenus ? foundInjectingMenus.flatMap(injectingMenu =>\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      processGroupInject(injectingMenu.items, injectingMenu, injectWithMenus, menuWithI18n)) : []),\n      [symbolAppId]: menu.app[0].appId,\n      [symbolMenuI18nNamespace]: menuWithI18n.get(menu),\n      [symbolOverrideApp]: menu.overrideApp\n    });\n  });\n}\n//# sourceMappingURL=mergeMenu.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { sortBy } from \"lodash\";\nexport function reorderMenuItems(menuData) {\n  menuData.items = sortMenuItems(menuData.items).map(item => _objectSpread(_objectSpread({}, item), {}, {\n    children: sortMenuItems(item.children)\n  }));\n}\nfunction sortMenuItems(list) {\n  return sortBy(list, item => {\n    var _item$sort;\n    return (_item$sort = item.sort) !== null && _item$sort !== void 0 ? _item$sort : -Infinity;\n  });\n}\n//# sourceMappingURL=reorderMenuItems.js.map","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nvar _excluded = [\"children\"];\nimport { asyncComputeRealValue } from \"../compute/computeRealValue.js\";\nimport { _internalApiGetAppInBootstrapData } from \"../Runtime.js\";\nimport { symbolAppId, symbolMenuI18nNamespace, symbolOverrideApp } from \"./constants.js\";\nexport function computeMenuData(data, overrideAppId, runtimeContext) {\n  var newRuntimeContext = runtimeContext;\n  if (overrideAppId !== runtimeContext.app.id) {\n    var overrideApp = window.STANDALONE_MICRO_APPS ? data[symbolOverrideApp] : _internalApiGetAppInBootstrapData(overrideAppId);\n    newRuntimeContext = _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      overrideApp,\n      appendI18nNamespace: data[symbolMenuI18nNamespace]\n    });\n  }\n  return asyncComputeRealValue(data, newRuntimeContext, {\n    ignoreSymbols: true\n  });\n}\nexport function computeMenuItems(items, runtimeContext) {\n  return Promise.all(items.map( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(function* (_ref) {\n      var {\n          children\n        } = _ref,\n        rest = _objectWithoutProperties(_ref, _excluded);\n      var [computedRest, computedChildren] = yield Promise.all([computeMenuData(rest, rest[symbolAppId], runtimeContext), children && (yield computeMenuItems(children, runtimeContext))]);\n      return _objectSpread(_objectSpread({}, computedRest), {}, {\n        children: computedChildren\n      });\n    });\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }()));\n}\n//# sourceMappingURL=computeMenuData.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取实例详情\n * @endpoint GET /object/:objectId/instance/:instanceId\n */\nexport var InstanceApi_getDetail = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (objectId, instanceId, params, options) {\n    return (/**! @contract easyops.api.cmdb.instance.GetDetail@1.0.0 */(yield http.get(\"api/gateway/cmdb.instance.GetDetail/object/\".concat(objectId, \"/instance/\").concat(instanceId), _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function InstanceApi_getDetail(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=getDetail.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isEmpty } from \"lodash\";\nimport { InstanceApi_getDetail } from \"@next-api-sdk/cmdb-sdk\";\nvar menuTitleCache = new Map();\nexport function fetchMenuTitle(_x) {\n  return _fetchMenuTitle.apply(this, arguments);\n}\nfunction _fetchMenuTitle() {\n  _fetchMenuTitle = _asyncToGenerator(function* (menuData) {\n    if (menuData.title || isEmpty(menuData.titleDataSource)) {\n      return menuData.title;\n    }\n    var cacheKey = JSON.stringify(menuData.titleDataSource);\n    if (menuTitleCache.has(cacheKey)) {\n      return menuTitleCache.get(cacheKey);\n    }\n    var {\n      objectId,\n      instanceId,\n      attributeId\n    } = menuData.titleDataSource;\n    var attr = attributeId !== null && attributeId !== void 0 ? attributeId : \"name\";\n    var instanceData = yield InstanceApi_getDetail(objectId, instanceId, {\n      fields: attr\n    });\n    var title;\n    if (attributeId === \"#showKey\" && Array.isArray(instanceData[attr])) {\n      var [primary, ...rest] = instanceData[attr];\n      title = rest.length > 0 ? \"\".concat(primary, \"(\").concat(rest.join(\",\"), \")\") : String(primary);\n    } else {\n      title = String(instanceData[attr]);\n    }\n    menuTitleCache.set(cacheKey, title);\n    return title;\n  });\n  return _fetchMenuTitle.apply(this, arguments);\n}\n//# sourceMappingURL=fetchMenuTitle.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"items\", \"app\"];\nimport { InstanceApi_postSearch } from \"@next-api-sdk/cmdb-sdk\";\nimport { pick } from \"lodash\";\nimport { mergeMenu } from \"./mergeMenu.js\";\nimport { reorderMenuItems } from \"./reorderMenuItems.js\";\nimport { preCheckPermissionsForAny } from \"../checkPermissions.js\";\nimport { checkIfOfComputed } from \"../compute/checkIf.js\";\nimport { computeMenuItems, computeMenuData } from \"./computeMenuData.js\";\nimport { fetchMenuTitle } from \"./fetchMenuTitle.js\";\nimport { getMenusOfStandaloneApp } from \"./getMenusOfStandaloneApp.js\";\nvar menuPromises = new Map();\nvar menuCache = new Map();\nexport function getMenuById(menuId) {\n  return menuCache.get(menuId);\n}\nexport function fetchMenuById(menuId, runtimeContext) {\n  var promise = menuPromises.get(menuId);\n  if (!promise) {\n    promise = _fetchMenuById(menuId, runtimeContext);\n  }\n  return promise;\n}\nfunction _fetchMenuById(_x, _x2) {\n  return _fetchMenuById2.apply(this, arguments);\n}\nfunction _fetchMenuById2() {\n  _fetchMenuById2 = _asyncToGenerator(function* (menuId, runtimeContext) {\n    var menuList = window.STANDALONE_MICRO_APPS ? getMenusOfStandaloneApp(menuId, runtimeContext.app.id) : (yield InstanceApi_postSearch(\"EASYOPS_STORYBOARD_MENU\", {\n      page: 1,\n      page_size: 200,\n      fields: {\n        menuId: true,\n        title: true,\n        icon: true,\n        link: true,\n        titleDataSource: true,\n        defaultCollapsed: true,\n        defaultCollapsedBreakpoint: true,\n        type: true,\n        injectMenuGroupId: true,\n        dynamicItems: true,\n        itemsResolve: true,\n        items: true,\n        i18n: true,\n        \"items.children\": true,\n        \"app.appId\": true\n      },\n      query: {\n        menuId: {\n          $eq: menuId\n        },\n        app: {\n          $size: {\n            $gt: 0\n          }\n        }\n      }\n    })).list;\n    var menuData = yield mergeMenu(menuList, runtimeContext);\n    if (!menuData) {\n      throw new Error(\"Menu not found: \".concat(menuId));\n    }\n    reorderMenuItems(menuData);\n    var {\n        items,\n        app\n      } = menuData,\n      restMenuData = _objectWithoutProperties(menuData, _excluded);\n    var newRuntimeContext = _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      pendingPermissionsPreCheck: [...runtimeContext.pendingPermissionsPreCheck, preCheckPermissionsForAny([items, restMenuData])]\n    });\n    delete newRuntimeContext.tplStateStoreId;\n    delete newRuntimeContext.forEachItem;\n    var rootAppId = app[0].appId;\n    var [computedMenuData, computedMenuItems] = yield Promise.all([computeMenuData(restMenuData, rootAppId, newRuntimeContext), computeMenuItems(items, newRuntimeContext)]);\n    var finalMenuData = _objectSpread(_objectSpread({\n      title: yield fetchMenuTitle(computedMenuData)\n    }, pick(computedMenuData, [\"icon\", \"link\", \"defaultCollapsed\", \"defaultCollapsedBreakpoint\"])), {}, {\n      menuItems: computedMenuItems.filter(checkIfOfComputed).map(item => {\n        var _item$children;\n        var children = (_item$children = item.children) === null || _item$children === void 0 ? void 0 : _item$children.filter(checkIfOfComputed);\n        return item.type === \"group\" ? {\n          type: \"group\",\n          title: item.text,\n          items: children\n        } : children !== null && children !== void 0 && children.length ? {\n          type: \"subMenu\",\n          title: item.text,\n          icon: item.icon,\n          items: children,\n          defaultExpanded: item.defaultExpanded\n        } : item;\n      })\n    });\n\n    // Todo(steve): reconsider the menu cache strategy\n    menuCache.set(menuId, finalMenuData);\n  });\n  return _fetchMenuById2.apply(this, arguments);\n}\n//# sourceMappingURL=fetchMenuById.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { _internalApiGetStoryboardInBootstrapData } from \"../Runtime.js\";\nexport function getMenusOfStandaloneApp(menuId, appId) {\n  var _ref, _storyboard$meta$inje, _storyboard$meta, _storyboard$meta2;\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  var menus = (_ref = (_storyboard$meta$inje = (_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.injectMenus) !== null && _storyboard$meta$inje !== void 0 ? _storyboard$meta$inje : (_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.menus) !== null && _ref !== void 0 ? _ref : [];\n  return menus.filter(menu => menu.menuId === menuId).map(menu => {\n    var _menu$app, _menu$app$;\n    return _objectSpread(_objectSpread({}, menu), (_menu$app = menu.app) !== null && _menu$app !== void 0 && (_menu$app$ = _menu$app[0]) !== null && _menu$app$ !== void 0 && _menu$app$.appId ? {} : {\n      app: [{\n        appId\n      }]\n    });\n  });\n\n  // Todo: maybe: fetch menus from STANDALONE_MENU@EASYOPS\n}\n//# sourceMappingURL=getMenusOfStandaloneApp.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { transformAndInject, transform, inject } from \"@next-core/inject\";\nimport { asyncEvaluate, isPreEvaluated, evaluate, shouldDismissMarkingComputed } from \"./evaluate.js\";\nimport { getNextStateOfUseBrick, isLazyContentInUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { hasBeenComputed, markAsComputed } from \"./markAsComputed.js\";\nexport function asyncComputeRealValue(_x, _x2) {\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nfunction _asyncComputeRealValue() {\n  _asyncComputeRealValue = _asyncToGenerator(function* (value, runtimeContext) {\n    var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var preEvaluated = isPreEvaluated(value);\n    if (preEvaluated || typeof value === \"string\") {\n      // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n      // are kept and to be evaluated later.\n      var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n      var result;\n      var dismissMarkingComputed = lazy;\n      if (preEvaluated || isEvaluable(value)) {\n        result = yield asyncEvaluate(value, runtimeContext, {\n          lazy\n        });\n        dismissMarkingComputed = shouldDismissMarkingComputed(value);\n      } else {\n        result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n      }\n      if (!dismissMarkingComputed) {\n        markAsComputed(result);\n      }\n      return result;\n    }\n    if (!isObject(value) || hasBeenComputed(value)) {\n      return value;\n    }\n    if (Array.isArray(value)) {\n      var nextOptions = getNextComputeOptions(internalOptions, true);\n      return Promise.all(value.map(v => asyncComputeRealValue(v, runtimeContext, nextOptions)));\n    }\n    return Object.fromEntries((yield Promise.all(Object.entries(value).map(_ref2 => {\n      var [k, v] = _ref2;\n      return Promise.all([asyncComputeRealValue(k, runtimeContext), asyncComputeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))]);\n    }))).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n  });\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nexport function computeRealValue(value, runtimeContext) {\n  var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var preEvaluated = isPreEvaluated(value);\n  if (preEvaluated || typeof value === \"string\") {\n    // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n    // are kept and to be evaluated later.\n    var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n    var result;\n    var dismissMarkingComputed = lazy;\n    if (preEvaluated || isEvaluable(value)) {\n      result = evaluate(value, runtimeContext);\n      dismissMarkingComputed = shouldDismissMarkingComputed(value);\n    } else {\n      result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n    }\n    if (!dismissMarkingComputed) {\n      markAsComputed(result);\n    }\n    return result;\n  }\n  if (!isObject(value) || hasBeenComputed(value)) {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    var nextOptions = getNextComputeOptions(internalOptions, true);\n    return value.map(v => computeRealValue(v, runtimeContext, nextOptions));\n  }\n  return Object.fromEntries(Object.entries(value).map(_ref => {\n    var [k, v] = _ref;\n    return [computeRealValue(k, runtimeContext), computeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))];\n  }).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n}\nfunction getNextComputeOptions(internalOptions, isArray, key) {\n  return internalOptions.$$lazyForUseBrick ? _objectSpread(_objectSpread({}, internalOptions), {}, {\n    $$stateOfUseBrick: getNextStateOfUseBrick(internalOptions.$$stateOfUseBrick, isArray, key)\n  }) : internalOptions;\n}\nfunction identity(value) {\n  return value;\n}\n//# sourceMappingURL=computeRealValue.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { difference } from \"lodash\";\nimport { scanPermissionActionsInAny, scanPermissionActionsInStoryboard } from \"@next-core/utils/storyboard\";\nimport { PermissionApi_validatePermissions } from \"@next-api-sdk/micro-app-sdk\";\nimport { getAuth, isLoggedIn } from \"../auth.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nvar checkedPermissions = [];\nvar permissionMap = new Map();\nexport function preCheckPermissions(storyboard) {\n  if (isLoggedIn() && !getAuth().isAdmin) {\n    var usedActions = scanPermissionActionsInStoryboard(storyboard);\n    return validatePermissions(usedActions);\n  }\n}\nexport function preCheckPermissionsForBrickOrRoute(_x, _x2) {\n  return _preCheckPermissionsForBrickOrRoute.apply(this, arguments);\n}\nfunction _preCheckPermissionsForBrickOrRoute() {\n  _preCheckPermissionsForBrickOrRoute = _asyncToGenerator(function* (container, runtimeContext) {\n    if (isLoggedIn() && !getAuth().isAdmin && Array.isArray(container.permissionsPreCheck)) {\n      var actions = yield asyncComputeRealValue(container.permissionsPreCheck, runtimeContext);\n      return validatePermissions(actions);\n    }\n  });\n  return _preCheckPermissionsForBrickOrRoute.apply(this, arguments);\n}\nexport function preCheckPermissionsForAny(data) {\n  if (isLoggedIn() && !getAuth().isAdmin) {\n    var usedActions = scanPermissionActionsInAny(data);\n    return validatePermissions(usedActions);\n  }\n}\nexport function validatePermissions(_x3) {\n  return _validatePermissions.apply(this, arguments);\n}\n\n/**\n * Check the current logged-in user whether to have all\n * permissions of actions passed to it.\n *\n * @param actions - Required permission actions.\n */\nfunction _validatePermissions() {\n  _validatePermissions = _asyncToGenerator(function* (usedActions) {\n    // Do not request known actions.\n    var actions = difference(usedActions, [...checkedPermissions]);\n    if (actions.length === 0) {\n      return;\n    }\n    checkedPermissions.push(...actions);\n    try {\n      var result = yield PermissionApi_validatePermissions({\n        actions\n      });\n      for (var item of result.actions) {\n        permissionMap.set(item.action, item.authorizationStatus);\n        if (item.authorizationStatus === \"undefined\") {\n          // eslint-disable-next-line no-console\n          console.error(\"Undefined permission action: \\\"\".concat(item.action, \"\\\"\"));\n        }\n      }\n    } catch (error) {\n      // Allow pre-check to fail, and\n      // make it not crash when the backend service is not updated.\n      // eslint-disable-next-line no-console\n      console.error(\"Pre-check permissions failed\", error);\n    }\n  });\n  return _validatePermissions.apply(this, arguments);\n}\nexport function checkPermissions() {\n  if (!isLoggedIn()) {\n    return false;\n  }\n  if (getAuth().isAdmin) {\n    return true;\n  }\n  for (var _len = arguments.length, actions = new Array(_len), _key = 0; _key < _len; _key++) {\n    actions[_key] = arguments[_key];\n  }\n  for (var action of actions) {\n    // Only **exclusively authorized** permissions are ok.\n    // Those scenarios below will fail:\n    // - unauthorized actions (pre-check results)\n    // - undefined actions (pre-check results)\n    // - Un-pre-checked or pre-check failed\n    switch (permissionMap.get(action)) {\n      case \"unauthorized\":\n      case \"undefined\":\n        return false;\n      case undefined:\n        // eslint-disable-next-line no-console\n        console.error(\"Un-checked permission action: \\\"\".concat(action, \"\\\", please make sure the permission to check is defined in permissionsPreCheck.\"));\n        return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Reset permission pre-checks after logged-out.\n */\nexport function resetPermissionPreChecks() {\n  checkedPermissions.length = 0;\n  permissionMap.clear();\n}\n//# sourceMappingURL=checkPermissions.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\n// import { userAnalytics } from \"@next-core/easyops-analytics\";\n\nimport { resetPermissionPreChecks } from \"./internal/checkPermissions.js\";\nvar auth = {};\n\n/** @internal */\n\n/** @internal */\nexport function authenticate(newAuth) {\n  Object.assign(auth, {\n    org: newAuth.org,\n    username: newAuth.username,\n    userInstanceId: newAuth.userInstanceId,\n    loginFrom: newAuth.loginFrom,\n    accessRule: newAuth.accessRule,\n    isAdmin: newAuth.isAdmin,\n    csrfToken: newAuth.csrfToken,\n    license: newAuth.license,\n    userShowValue: newAuth.userShowValue\n  });\n\n  // re-init analytics to set user_id\n  // if (userAnalytics.initialized) {\n  //   userAnalytics.setUserId(newAuth.userInstanceId);\n  // }\n}\n\n/**\n * 获取当前登录认证信息。\n *\n * @returns 当前登录认证信息。\n */\nexport function getAuth() {\n  return _objectSpread({}, auth);\n}\n\n/** @internal */\nexport function logout() {\n  for (var key of Object.keys(auth)) {\n    auth[key] = undefined;\n  }\n  resetPermissionPreChecks();\n\n  // re-init analytics to clear user_id\n  // userAnalytics.setUserId();\n}\n\n/**\n * 查看当前是否已登录。\n *\n * @returns 当前是否已登录。\n */\nexport function isLoggedIn() {\n  return auth.username !== undefined;\n}\n//# sourceMappingURL=auth.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getProviderBrick } from \"./internal/data/getProviderBrick.js\";\nimport { resolveByProvider } from \"./internal/data/resolveData.js\";\nexport function fetchByProvider(_x, _x2, _x3) {\n  return _fetchByProvider.apply(this, arguments);\n}\nfunction _fetchByProvider() {\n  _fetchByProvider = _asyncToGenerator(function* (provider, args, options) {\n    var providerBrick = yield getProviderBrick(provider);\n    return resolveByProvider(providerBrick, provider, \"resolve\", args, options);\n  });\n  return _fetchByProvider.apply(this, arguments);\n}\n//# sourceMappingURL=fetchByProvider.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { renderBricks } from \"./internal/Renderer.js\";\nimport { RendererContext } from \"./internal/RendererContext.js\";\nimport { mountTree, unmountTree } from \"./internal/mount.js\";\nimport { httpErrorToString } from \"./handleHttpError.js\";\nimport { applyMode, applyTheme, setMode, setTheme } from \"./themeAndMode.js\";\nimport { RenderTag } from \"./internal/enums.js\";\nexport function unstable_createRoot(container) {\n  var {\n    portal: _portal,\n    scope = \"fragment\"\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var portal = _portal;\n  var createPortal;\n  if (_portal) {\n    createPortal = _portal;\n  } else {\n    // Create portal container when necessary.\n    createPortal = () => {\n      portal = document.createElement(\"div\");\n      portal.style.position = \"absolute\";\n      portal.style.width = portal.style.height = \"0\";\n      document.body.append(portal);\n      return portal;\n    };\n  }\n  var unmounted = false;\n  var rendererContext;\n  return {\n    render(brick) {\n      var _arguments = arguments;\n      return _asyncToGenerator(function* () {\n        var {\n          theme\n        } = _arguments.length > 1 && _arguments[1] !== undefined ? _arguments[1] : {};\n        if (unmounted) {\n          throw new Error(\"The root is unmounted and cannot be rendered any more\");\n        }\n        var bricks = [].concat(brick);\n        var runtimeContext = {\n          pendingPermissionsPreCheck: [],\n          tplStateStoreMap: new Map()\n        };\n        var previousRendererContext = rendererContext;\n        rendererContext = new RendererContext(scope);\n        var renderRoot = {\n          tag: RenderTag.ROOT,\n          container,\n          createPortal\n        };\n        var failed = false;\n        var output;\n        try {\n          output = yield renderBricks(renderRoot, bricks, runtimeContext, rendererContext);\n          output.blockingList.push(...[...runtimeContext.tplStateStoreMap.values()].map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck);\n          flushStableLoadBricks();\n          yield Promise.all(output.blockingList);\n        } catch (error) {\n          failed = true;\n          output = {\n            node: {\n              tag: RenderTag.BRICK,\n              type: \"div\",\n              properties: {\n                textContent: httpErrorToString(error)\n              },\n              return: renderRoot,\n              runtimeContext: null\n            },\n            blockingList: [],\n            menuRequests: []\n          };\n        }\n        renderRoot.child = output.node;\n        previousRendererContext === null || previousRendererContext === void 0 ? void 0 : previousRendererContext.dispose();\n        unmountTree(container);\n        if (portal) {\n          unmountTree(portal);\n        }\n        if (scope === \"page\") {\n          setTheme(theme !== null && theme !== void 0 ? theme : \"light\");\n          setMode(\"default\");\n          if (!failed) {\n            rendererContext.dispatchBeforePageLoad();\n          }\n          applyTheme();\n          applyMode();\n        }\n        mountTree(renderRoot);\n        if (scope === \"page\") {\n          window.scrollTo(0, 0);\n        }\n        if (!failed) {\n          if (scope === \"page\") {\n            rendererContext.dispatchPageLoad();\n            // rendererContext.dispatchAnchorLoad();\n          }\n\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n        }\n      })();\n    },\n    unmount() {\n      if (unmounted) {\n        return;\n      }\n      unmounted = true;\n      unmountTree(container);\n      if (portal) {\n        unmountTree(portal);\n        // Only remove the portal from its parent when it's dynamic created.\n        if (!_portal) {\n          portal.remove();\n        }\n      }\n    }\n  };\n}\n//# sourceMappingURL=createRoot.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { pick } from \"lodash\";\nimport { _internalApiGetRuntimeContext, _internalApiGetStoryboardInBootstrapData, _internalApiLoadBricks, _internalApiSetBootstrapData } from \"./Runtime.js\";\nimport { renderBrick } from \"./Renderer.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nimport { loadNotificationService } from \"../Notification.js\";\nimport { loadDialogService } from \"../Dialog.js\";\nexport function renderUseBrick(_x, _x2) {\n  return _renderUseBrick.apply(this, arguments);\n}\nfunction _renderUseBrick() {\n  _renderUseBrick = _asyncToGenerator(function* (useBrick, data) {\n    var _runtimeContext$tplSt, _output$node;\n    var tplStateStoreScope = [];\n    var runtimeContext = _objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n      data,\n      pendingPermissionsPreCheck: [],\n      tplStateStoreScope\n    });\n    (_runtimeContext$tplSt = runtimeContext.tplStateStoreMap) !== null && _runtimeContext$tplSt !== void 0 ? _runtimeContext$tplSt : runtimeContext.tplStateStoreMap = new Map();\n    var rendererContext = new RendererContext(\"fragment\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      // Will set during `mountUseBrick`\n      createPortal: null\n    };\n    var transform = useBrick.transform;\n    var strict = isStrictMode();\n    if (transform) {\n      warnAboutStrictMode(strict, \"`useBrick.transform`\", 'please use \"properties\" instead, check your useBrick:', useBrick);\n    }\n    var output = yield renderBrick(renderRoot, strict ? useBrick : _objectSpread(_objectSpread({}, useBrick), {}, {\n      properties: _objectSpread(_objectSpread({}, useBrick.properties), transform)\n    }), runtimeContext, rendererContext);\n    flushStableLoadBricks();\n    yield Promise.all([...output.blockingList,\n    // Wait for local tpl state stores belong to current `useBrick` only.\n    ...tplStateStoreScope.map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck]);\n    if ((_output$node = output.node) !== null && _output$node !== void 0 && _output$node.portal) {\n      throw new Error(\"The root brick of useBrick cannot be a portal brick\");\n    }\n    renderRoot.child = output.node;\n    var tagName = output.node ? output.node.type : null;\n    return {\n      tagName,\n      renderRoot,\n      rendererContext\n    };\n  });\n  return _renderUseBrick.apply(this, arguments);\n}\nexport function mountUseBrick(_ref, element) {\n  var {\n    renderRoot,\n    rendererContext\n  } = _ref;\n  var portal;\n  renderRoot.createPortal = () => {\n    var portalRoot = document.querySelector(\"#portal-mount-point\");\n    portal = document.createElement(\"div\");\n    portalRoot.appendChild(portal);\n    return portal;\n  };\n  mountTree(renderRoot, element);\n  rendererContext.dispatchOnMount();\n  rendererContext.initializeScrollIntoView();\n  rendererContext.initializeMediaChange();\n  return {\n    portal\n  };\n}\nexport function unmountUseBrick(_ref2, mountResult) {\n  var {\n    rendererContext\n  } = _ref2;\n  // if (mountResult.mainBrick) {\n  //   mountResult.mainBrick.unmount();\n  // }\n  if (mountResult.portal) {\n    unmountTree(mountResult.portal);\n    mountResult.portal.remove();\n  }\n  rendererContext.dispatchOnUnmount();\n  rendererContext.dispose();\n}\nexport function initializePlayground(data) {\n  _internalApiSetBootstrapData(data);\n  // Todo: allow configuration of notification bricks.\n  loadNotificationService(\"shoelace.show-notification\");\n  loadDialogService(\"shoelace.show-dialog\");\n}\nexport function legacyDoTransform(data, to, options) {\n  if (options) {\n    throw new Error(\"Legacy doTransform does not support options in v3\");\n  }\n  return computeRealValue(to, _objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n    data\n  }), {\n    noInject: true\n  });\n}\nexport var loadBricks = _internalApiLoadBricks;\nexport function updateStoryboard(appId, storyboardPatch) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  Object.assign(storyboard, _objectSpread(_objectSpread({}, storyboardPatch), {}, {\n    $$fulfilling: null,\n    $$fulfilled: true,\n    $$registerCustomTemplateProcessed: false\n  }));\n  registerAppI18n(storyboard);\n}\nexport function updateStoryboardByRoute(appId, newRoute) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  var match = false;\n  var getKey = route => \"\".concat(route.path, \".\").concat(route.exact);\n  var replaceRoute = (routes, key) => {\n    return routes.map(route => {\n      var routeKey = getKey(route);\n      if (route.type === \"routes\") {\n        route.routes = replaceRoute(route.routes, key);\n        return route;\n      } else if (routeKey === key) {\n        match = true;\n        return newRoute;\n      } else {\n        return route;\n      }\n    });\n  };\n  storyboard.routes = replaceRoute(storyboard.routes, getKey(newRoute));\n  if (!match) {\n    storyboard.routes.unshift(newRoute);\n  }\n}\nexport function updateStoryboardByTemplate(appId, newTemplate, settings) {\n  var tplName = \"\".concat(appId, \".\").concat(newTemplate.name);\n  // customTemplateRegistry.delete(tplName);\n  customTemplates.define(tplName, {\n    bricks: newTemplate.bricks,\n    proxy: newTemplate.proxy,\n    state: newTemplate.state\n  });\n  updateTemplatePreviewSettings(appId, newTemplate.name, settings);\n}\nexport function updateTemplatePreviewSettings(appId, templateId, settings) {\n  _updatePreviewSettings(appId, \"${APP.homepage}/_dev_only_/template-preview/\".concat(templateId), [_objectSpread({\n    brick: templateId\n  }, pick(settings, \"properties\", \"events\", \"lifeCycle\", \"context\"))]);\n}\nexport function updateStoryboardBySnippet(appId, snippetData) {\n  var _snippetData$bricks;\n  _updatePreviewSettings(appId, \"${APP.homepage}/_dev_only_/snippet-preview/\".concat(snippetData.snippetId), (_snippetData$bricks = snippetData.bricks) !== null && _snippetData$bricks !== void 0 && _snippetData$bricks.length ? snippetData.bricks : [{\n    brick: \"span\"\n  }]);\n}\nexport var updateSnippetPreviewSettings = updateStoryboardBySnippet;\nfunction _updatePreviewSettings(appId, path, bricks) {\n  var {\n    routes\n  } = _internalApiGetStoryboardInBootstrapData(appId);\n  var previewRouteIndex = routes.findIndex(route => route.path === path);\n  var newPreviewRoute = {\n    path,\n    bricks,\n    menu: false,\n    exact: true\n  };\n  if (previewRouteIndex === -1) {\n    routes.unshift(newPreviewRoute);\n  } else {\n    routes.splice(previewRouteIndex, 1, newPreviewRoute);\n  }\n}\n//# sourceMappingURL=secret_internals.js.map"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","_classPrivateMethodGet","receiver","privateSet","has","TypeError","_classPrivateMethodInitSpec","obj","add","_defineProperty","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","_objectSpread2","target","i","length","source","forEach","getOwnPropertyDescriptors","defineProperties","_objectWithoutProperties","excluded","sourceKeys","indexOf","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_toPropertyKey","input","hint","prim","Symbol","toPrimitive","res","String","PermissionApi_validatePermissions","_ref","data","options","http","_x","_x2","_registry","WeakMap","customProcessors","constructor","Map","define","processorFullName","processorFunc","namespace","processorName","split","pkg","get","set","Error","concat","registerAppI18n","app","meta","i18n","i18nNamespace","getI18nNamespace","id","entries","_ref2","lang","resources","type","registerWidgetI18n","widgetId","i18nData","ns","widgetI18nFactory","widgetImagesFactory","widgetVersion","name","_window$PUBLIC_ROOT","window","PUBLIC_ROOT","PUBLIC_ROOT_WITH_VERSION","getDevHook","__BRICK_NEXT_DEVTOOLS_HOOK__","THROW","readOnlyHandler","deleteProperty","setPrototypeOf","getReadOnlyProxy","Proxy","getDynamicReadOnlyProxy","fromEntries","map","freeze","theme","storage","JsonStorage","localStorage","LOCAL_STORAGE_APPS_THEME_KEY","setTheme","getTheme","getCurrentTheme","document","documentElement","dataset","applyTheme","dispatchEvent","CustomEvent","detail","batchSetAppsLocalTheme","appsTheme","setItem","getLocalAppsTheme","_result","result","getItem","_unused","console","mode","setMode","getCurrentMode","applyMode","getCssPropertyValue","_window$getComputedSt","el","getComputedStyle","getPropertyValue","getBasePath","base","querySelector","getAttribute","getGeneralGlobals","attemptToVisitGlobals","globalVariables","variableName","variable","getIndividualGlobal","appId","isBuildPush","collectCoverage","appendI18nNamespace","storyboardFunctions","isStoryboardFunction","replace","APP_ROOT","identity","Boolean","fakeI18nText","i18nText","check","fakeCheckPermissions","checkPermissions","href","origin","host","hostname","location","en","StoryboardFunctionRegistryFactory","currentApp","registeredFunctions","collector","processed","cooked","createCollector","precooked","precookFunction","typescript","hooks","beforeVisit","cook","function","rules","noVar","supply","beforeEvaluate","beforeCall","beforeBranch","getStoryboardFunction","registerStoryboardFunctions","functions","clear","Array","isArray","deps","strictCollectMemberUsageInFunction","hasPermissionsCheck","updateStoryboardFunction","newFn","checkPermissionsUsage","functionNames","checkedFunctions","Set","some","EventTarget","wm","create","proto","dispatch","once","removeEventListener","listener","handleEvent","_stopImmediatePropagationFlag","secret","listeners","event","slice","currentTarget","splice","MediaBreakpoint","mediaBreakpointMinWidthMap","xLarge","large","medium","small","xSmall","mediaEventTarget","breakpointMatchesMap","MEDIA","handleMatchesChange","breakpoint","changed","_breakpoint","matches","minWidth","mediaQueryList","matchMedia","addEventListener","addListener","getMedia","getStorageItem","storageType","_storage$getItem","sessionStorage","JSON","parse","matchStoryboard","storyboards","pathname","sortedStoryboards","orderBy","storyboard","_storyboard$app$homep","_storyboard$app","_storyboard$app$homep2","homepage","startsWith","isOutsideApp","_getRuntime$getCurren","getRuntime","getCurrentApp","STANDALONE_MICRO_APPS","standaloneMode","_excluded","blocked","getUserConfirmation","message","callback","confirm","createHistory","browserHistory","createBrowserHistory","basename","assign","blockMessage","originalPush","originalReplace","state","updateQueryFactory","method","query","extraQuery","keepHash","urlSearchParams","URLSearchParams","search","params","item","delete","append","toString","hash","pushQuery","replaceQuery","pushAnchor","notify","reload","setBlockMessage","getBlockMessage","unblock","updateFactory","path","pathIsString","parsePath","_bootstrapData$storyb","_bootstrapData9","bootstrapData","_internalApiMatchStoryboard","substring","createHref","historyOverridden","historyExtended","getHistory","ContractApi_searchSingleContract","contractsMap","widgetContractMap","addContract","contracts","contract","namespaceId","flowApiDefinitionPromiseMap","isFlowApiProvider","provider","includes","getArgsOfFlowApi","_x3","_getArgsOfFlowApi","originalArgs","apiDefinition","promise","_x4","_fetchFlowApiDefinition2","_fetchFlowApiDefinition","fetchFlowApiDefinition","apiProfile","api","_contract$endpoint","_contract$response","schema","json","uri","ext_fields","endpoint","responseWrapper","response","wrapper","toLowerCase","serviceName","version","isFileType","request","getApiProfileFromApiDefinition","fileName","apiMethod","isDownload","shift","url","prefix","restArgs","getTransformedUriAndRestArgs","originalUri","getApiArgsFromApiProfile","namespaceName","nameWithVersion","getContract","_contractData$namespa","_contractData$namespa2","contractData","contractName","FLOW_API_PROVIDER","hasFields","callFlowApi","_callFlowApi","isSimpleRequest","defaultOptions","responseType","_len2","_key2","_originalUri$match$le","_originalUri$match","_request$fields$lengt","_request$fields","match","fields","isUploadType","processFields","isEmpty","field","hasFileType","hasQueryParams","hasBodyParams","_len","_key","_data","_params","_options","_options2","processExtFields","FormData","formData","_loop","v","isObject","Blob","Date","k","transformFormData","pool","getProviderBrick","_getProviderBrick","brick","customElements","createProviderClass","loadBricksImperatively","getBrickPackages","createElement","cache","resolveData","_resolveData","resolveConf","runtimeContext","useProvider","onReject","legacyProvider","providerBrick","actualArgs","all","asyncComputeRealValue","resolveByProvider","transform","isHandleRejectByTransform","_x5","_x6","_x7","_x8","_x9","_resolveByProvider","cacheKey","stringify","e","finalArgs","asyncCheckIf","_asyncCheckIf","ifContainer","hasOwnProperty","if","isPreEvaluated","checkIf","computeRealValue","checkIfOfComputed","_asyncCheckBrickIf","brickConf","checkIfByTransform","StateOfUseBrick","isLazyContentInUseBrick","USE_BRICK_PROPERTIES","USE_BRICK_TRANSFORM","USE_BRICK_EVENTS","USE_BRICK_IF","USE_BRICK_LIFECYCLE","USE_BRICK_DATA_SOURCE","getNextStateOfUseBrick","USE_BRICK","USE_BRICK_ITEM","USE_BRICK_SLOTS_ITEM_BRICKS","USE_BRICK_SLOTS_ITEM_BRICKS_ITEM","INITIAL","USE_BRICK_SLOTS","USE_BRICK_SLOTS_ITEM","getTracks","contextNames","stateNames","formStateNames","isEvaluable","raw","symbolForRaw","track","_asyncComputeRealProperties","properties","trackingContextList","_ref3","propName","propValue","realValue","$$lazyForUseBrick","$$stateOfUseBrick","setRealProperties","realProps","setProperties","bricks","computeRealProperties","isStrictMode","_getRuntime","flags","getFeatureFlags","warnAboutStrictMode","strict","extraLogs","punctuation","warn","allowedNativeProps","customTemplates","tagName","_constructor$proxy$pr","_constructor$proxy","_compatibleConstructo","_compatibleConstructo2","registered","proxyProperties","proxy","validProxyProps","legacyTplVariables","asVariable","mergeProperty","refTransform","ref","compatibleConstructor","expose","tpl","_state$filter$map","exposedStates","uniq","proxyMethods","methods","props","entry","nativeProps","prop","HTMLElement","p","join","TplElement","$$typeof","_dev_only_definedProperties","_dev_only_definedMethods","$$getElementByRef","_this$$$tplStateStore","_this$$$tplStateStore2","_this$$$tplStateStore3","_this$$$tplStateStore4","$$tplStateStore","hostBrick","tplHostMetadata","internalBricksByRef","element","connectedCallback","shadowRoot","attachShadow","fragment","createDocumentFragment","style","textContent","slot","appendChild","disconnectedCallback","getValue","_this$$$tplStateStore5","updateValue","_loop2","from","to","_to$refProperty","refProperty","_this$$$getElementByR","_to$refProperty2","_loop3","_from","_to","_to$refMethod","refMethod","getTplStateStore","using","extraInfo","tplStateStoreId","tplStateStoreMap","store","getTplHostElement","hostElement","escapeString","str","sensitive","stringToRegexp","tokens","_a","_b","start","_c","end","_d","encode","x","_e","delimiter","_f","endsWith","endsWithRe","delimiterRe","route","_i","tokens_1","token","suffix","pattern","modifier","mod","endToken","isEndDelimited","RegExp","tokensToRegexp","char","index","count","j","code","charCodeAt","lexer","prefixes","defaultPattern","tryConsume","mustConsume","nextType","consumeText","name_1","pattern_1","pathToRegexp","groupsRegex","execResult","exec","regexpToRegexp","paths","parts","arrayToRegexp","cacheLimit","cacheCount","matchPath","exact","reduce","matched","regexp","pathCache","cacheResult","compilePath","values","isExact","memo","_matchRoutes","routes","routePath","noAuthGuard","public","isLoggedIn","symbolForAsyncComputedPropsFromHost","for","symbolForTplStateStoreId","symbolForTPlExternalForEachItem","timeoutIdList","K","REQUEST_FAILED","SOMETHING_WENT_WRONG","LOGIN_TIMEOUT_MESSAGE","NETWORK_ERROR","zh","NS","locales","loadDialogService","_internalApiLoadBricks","Dialog","show","content","setTimeout","alert","httpErrorToString","Event","HTMLScriptElement","src","HttpFetchError","HttpResponseError","responseJson","msg","isUnauthenticatedError","status","lastErrorMessage","unauthenticatedConfirming","handleHttpError","HttpAbortError","NO_AUTH_GUARD","ssoEnabled","history","title","contentStyle","whiteSpace","loadNotificationService","Notification","bindListeners","eventsMap","eventType","handlers","listenerFactory","handler","$$listeners","$$eventListeners","isBuiltinHandler","action","isUseProviderHandler","isCustomHandler","targetRef","runtimeBrick","handleHistoryAction","handleWindowAction","handleLocationAction","handleStorageAction","preventDefault","handleConsoleAction","handleMessageAction","handleContextAction","handleTplStateAction","init","argsFactory","handleUseProviderAction","handleCustomAction","_handleUseProviderAction","brickCallback","targets","rawTarget","rawTargetRef","computedTarget","multiple","querySelectorAll","found","computedTargetRef","targetRefs","tplHostElement","_tplHostElement$$$get","isExecuteCustomHandler","useEventAsDefault","isSetPropsCustomHandler","_x10","_x11","_brickCallback","_poll","task","computedArgs","poll","callbackFactory","eventCallbackFactory","pollableCallback","progress","success","finally","enabled","currentTimeoutId","finallyCallback","interval","leadingRequestDelay","continueOnError","delegateLoadingBar","expectPollEnd","expectPollStopImmediately","currentRenderId","_internalApiGetRenderId","shouldStop","delayedPoll","delay","startPoll","baseArgsLength","hasCallback","overrideMethod","useEventDetailAsDefault","features","open","ctxStore","removeItem","DataStore","changeEventType","_this$data$get","callbackRuntimeContext","eventTarget","load","loaded","loading","val","dataConfs","asyncHostProperties","pending","contextConfs","resolveContext","keyword","dependencyMap","depsMap","_contextConf","stats","collectMemberUsage","getDependencyMapOfContext","pendingDeps","contextName","contextConf","_pendingDeps$get","hasNonStaticUsage","WeakSet","deferredContexts","pendingContexts","wrapResolve","_pendingDeps$get2","resolved","left","scheduleNext","scheduleAsSerial","_scheduleNext","readyContexts","usedProperties","dep","predicateNextResolveFactory","pendingResult","deferred","size","duplicatedMap","next","processedAtLeastOne","_contextConf2","ReferenceError","detectCircularContexts","catch","resolveDataStore","dataConf","pendingStack","onChange","dataName","_this$data$get2","waitFor","dataNames","_this","ctx","waitForAll","_this2","_this3","hostProps","isLazyResolve","lazy","newData","strictCollectMemberUsage","setupTemplateProxy","hostContext","slots","asyncComputedProps","reversedProxies","externalSlots","propertyProxies","slotProxies","quasisMap","_externalSlots$from$b","_externalSlots$from","_to$refSlot","_to$refPosition","insertBricks","refToSlot","refSlot","expandableSlot","refPosition","clamp","setupTemplateExternalBricks","forEachItem","slotName","slotConf","quasis","flatMap","_brick$slots","_slotConf$bricks","setupTemplateExternalRoutes","setupUseBrickInTemplate","walk","setup","originalSlots","children","restConf","transpiledSlots","childrenToSlots","_excluded2","expandCustomTemplate","tplTagName","uniqueId","tplStateStore","tplStateStoreScope","collectWidgetContract","originalExternalSlots","externalChildren","restBrickConf","newBrickConf","proxies","_proxies","expandBrickInTemplate","brickConfInTemplate","slotsInTemplate","childrenInTemplate","restBrickConfInTemplate","RenderTag","renderRoutes","_renderRoutes","returnNode","_runtimeContext","rendererContext","slotId","matchRoutes","output","blockingList","menuRequests","unauthenticated","context","pendingPermissionsPreCheck","preCheckPermissionsForBrickOrRoute","redirectTo","redirect","loadMenu","menu","mergeRenderOutput","renderBricks","_x12","_renderBricks","tplStack","noMemoize","renderBrick","hasTrackingControls","memoizeControlNode","node","_x13","_x14","_x15","_x16","_x17","_x18","_renderBrick","_runtimeContext$app","template","asyncCheckBrickIf","brickName","ensureValidControlBrick","dataSource","renderControlNode","_slots$slot","computedDataSource","_x19","_x20","_x21","_x22","_x23","_x24","_x25","_renderForEach","renderForEach","controlledOutput","renderId","rerenderControlNode","debouncedListener","debounce","_contextName","test","getTagNameOfCustomTemplate","_tplStack$get","tplCount","enqueueStableLoadBricks","tag","BRICK","return","events","portal","iid","loadProperties","asyncComputeRealProperties","computedPropsFromHost","_brick$properties","computed","stateName","listenOnTrackingContext","asyncProperties","registerBrickLifeCycle","lifeCycle","childRuntimeContext","expandedBrickConf","loadChildren","_ref4","rendered","_ref5","childSlotId","childrenOutput","child","flat","menuConf","newOutput","rest","last","sibling","newSlots","_child$slot","bindTemplateProxy","_tplHostMetadata$prox","_to$refEvent","_ref$$$proxyListeners","bubbles","stopPropagation","cancelable","composed","refEvent","$$proxyListeners","unbindTemplateProxy","_$$proxyListeners","unmountTree","mountPoint","innerHTML","mountTree","root","initializedElement","current","portalElements","setAttribute","childElements","_currentReturn","currentReturn","_currentReturn$contai","ROOT","container","createPortal","misc","commonLifeCycles","pageOnlyLifeCycles","_memoizedLifeCycle","_observers","_mediaListener","_memoizedControlNodes","_unmountBricks","_initializeRerenderBricks","_dispatchGeneralLifeCycle","_addObserver","RendererContext","scope","onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload","onMediaChange","onScrollIntoView","onMount","onUnmount","lifeCycleTypes","useResolves","memKey","mem","getLastNode","lastNormal","getLastNormalNode","lastPortal","getLastPortalNode","_prevLastNormal$eleme","_prevLastNormal$eleme2","_prevLastPortal$eleme","_prevLastPortal$eleme2","prevSibling","memoized","prevNode","prevLast","prevLastNormal","prevLastPortal","insertBeforeChild","nextSibling","insertPortalBeforeChild","portalFragment","renderRoot","_returnNode$container","_returnNode$element","removeBricks","getBrickRange","_unmountBricks2","insertBefore","childNodes","_root","newBricks","_initializeRerenderBricks2","dispose","list","_list","observer","disconnect","dispatchBeforePageLoad","_dispatchGeneralLifeCycle2","dispatchPageLoad","dispatchBeforePageLeave","dispatchPageLeave","dispatchAnchorLoad","anchor","initializeScrollIntoView","conf","_addObserver2","initializeMediaChange","dispatchOnMount","dispatchOnUnmount","unmountList","removed","remove","_brick$element","_brick$element2","observers","unmountEvent","_brick","mountEvent","_brick2","_conf$threshold","threshold","IntersectionObserver","isIntersecting","intersectionRatio","observe","_last","range","_currentReturn2","getPageInfo","isInIframe","isInIframeOfSameSite","isInIframeOfNext","isInIframeOfVisualBuilder","isInIframeOfLegacyConsole","parent","selfIsNext","parentPathname","parentIsNext","Number","nativeController","markAsComputed","hasBeenComputed","getPrototypeOf","BootstrapV2Api_bootstrapV2","BootstrapStandaloneApi_runtimeStandalone","BootstrapV2Api_getAppStoryboardV2","RuntimeApi_runtimeMicroAppStandalone","loadBootstrapData","_loadBootstrapData","_standaloneBootstrap","standaloneBootstrap","appFields","ignoreTemplateFields","ignoreBrickFields","localeName","settings","deepFreeze","brickPackages","requests","BOOTSTRAP_FILE","APP_ID","safeGetRuntimeMicroAppStandalone","bootstrapResult","confString","runtimeData","safeLoad","JSON_SCHEMA","sys_settings","user_config","user_config_by_apps","feature_flags","featureFlags","userConfig","mergeConf","runtimeSettings","_bootstrapResult$sett","mergeRuntimeSettings","appRuntimeDataMap","_safeGetRuntimeMicroAppStandalone","_fulfilStoryboard","$$fulfilled","$$fulfilling","_doFulfilStoryboard","doFulfilStoryboard","appRuntimeData","injectMenus","menus","overrideApp","initializeAppConfig","initializeInjectMenus","config","merge","defaultConfig","RuntimeApi_searchMicroAppStandalone","compare","v1","v2","operator","assertValidOperator","n1","validateAndParse","n2","p1","pop","p2","r","compareSegments","compareVersions","operatorResMap","semver","isWildcard","s","tryParse","n","parseInt","isNaN","compareStrings","a","b","ap","bp","forceType","Math","max","allowedOperators","op","collectMemberCallUsageFactory","property","usage","memberParent","callParent","firstArg","usedArgs","collectAppGetMenuUsage","collectInstalledAppsHasUsage","checkingApps","checkedApps","hasInstalledApp","matchVersion","_internalApiGetAppInBootstrapData","installStatus","currentVersion","_storyboards","_rendering","_prevLocation","_nextLocation","_rendererContext","_rendererContextTrashCan","_redirectCount","_renderId","_currentApp","_previousApp","_navConfig","_getBlockMessageBeforePageLave","_safeRedirect","_queuedRender","_render","Router","_history","_getBlockMessageBeforePageLave2","returnValue","block","getRenderId","getRuntimeContext","getRecentApps","previousApp","getNavConfig","bootstrap","AbortController","_config$options","signal","noAbortOnRouteChange","listen","_classPrivateFieldGet2","_location$state","_classPrivateFieldGet3","ignoreRendering","omittedLocationProps","locationsAreEqual","abort","_queuedRender2","_classPrivateFieldGet4","previousMessage","_safeRedirect2","_this$redirectCount","_this$redirectCount2","_queuedRender3","_render2","nextLocation","_render3","_classPrivateFieldGet5","fulfilStoryboard","appChanged","prevRendererContext","redirectToLogin","main","cleanUpPreviousRender","_storyboard$meta","_storyboard$meta2","appIds","traverseStoryboardExpressions","scanInstalledAppsUsage","searchIds","$in","_appId","_result$list","find","checkedApp","preCheckInstalledApps","sys","getAuth","preCheckPermissions","$$registerCustomTemplateProcessed","templates","registerCustomTemplates","failed","mergedRoutes","specificTemplatePreviewIndex","findLastIndex","specificSnippetPreviewIndex","insertPreviewRoutes","flushStableLoadBricks","menuConfs","navConfig","breadcrumb","overwrite","items","mergeMenuConfs","scrollTo","AuthApi_checkLogin","loadCheckLogin","_loadCheckLogin","auth","loggedIn","authenticate","runtime","router","BOOTSTRAP_DATA","createRuntime","initializeI18n","Runtime","_bootstrapData","_router$getRecentApps","_router","_router2","_bootstrapData2","_bootstrapData2$setti","_router3","_router3$getRecentApp","_router3$getRecentApp2","_router3$getRecentApp3","getMiscSettings","_bootstrapData3","_bootstrapData3$setti","_router4","_router4$getRecentApp","_router4$getRecentApp2","_router4$getRecentApp3","getBrandSettings","_bootstrapData4","_bootstrapData4$setti","base_title","brand","getLaunchpadSettings","_bootstrapData5","_bootstrapData5$setti","columns","rows","launchpad","getDesktops","_bootstrapData$deskto","_bootstrapData6","desktops","getLaunchpadSiteMap","_bootstrapData$siteSo","_bootstrapData7","siteSort","toggleLaunchpadEffect","body","classList","toggle","applyPageTitle","pageTitle","baseTitle","_router5","_bootstrapData$brickP","_bootstrapData8","_router6","_internalApiGetRuntimeContext","_router7","_internalApiGetStoryboardInBootstrapData","_bootstrapData10","_bootstrapData10$stor","_internalApiGetStoryb","widgetFunctionRegistry","widgetFunctions","registerWidgetFunctions","InstanceApi_postSearch","objectId","symbolAppId","symbolMenuI18nNamespace","symbolOverrideApp","_loadDynamicMenuItems","menuWithI18n","dynamicItems","itemsResolve","overrideAppId","newRuntimeContext","_mergeMenu","menuList","mainMenu","validMenuList","injectWithMenus","menuI18nNamespace","menuId","instanceId","_menu","loadDynamicMenuItems","_menu$items","injectMenuGroupId","injectingMenus","processGroupInject","_processGroupInject","foundInjectingMenus","groupId","injectingMenu","sortMenuItems","sortBy","_item$sort","sort","computeMenuData","ignoreSymbols","computeMenuItems","computedRest","computedChildren","InstanceApi_getDetail","menuTitleCache","fetchMenuTitle","_fetchMenuTitle","menuData","titleDataSource","attributeId","attr","instanceData","primary","menuPromises","menuCache","getMenuById","_fetchMenuById2","_storyboard$meta$inje","_menu$app","_menu$app$","getMenusOfStandaloneApp","page","page_size","icon","link","defaultCollapsed","defaultCollapsedBreakpoint","$eq","$size","$gt","mergeMenu","reorderMenuItems","restMenuData","preCheckPermissionsForAny","rootAppId","computedMenuData","computedMenuItems","finalMenuData","pick","menuItems","_item$children","text","defaultExpanded","symbolForContext","shouldDismissMarkingComputed","shouldAllowRecursiveEvaluations","possibleErrorConstructs","SyntaxError","getCookErrorConstructor","_asyncEvaluate","run","lowLevelEvaluate","isAsync","_1","_2","_3","passByRuntimeContext","menuUsage","hasAppUsage","preevaluate","withParent","beforeVisitGlobal","usedCtx","usedProcessors","usedStates","devHook","usedTpls","loadProcessorsImperatively","attemptToCheckPermissions","usedFunctions","usedMenuIds","_fetchMenuById","fetchMenuById","_runtimeContext$overr","_match$params","cloneDeep","getMenu","t","getAll","expression","_message","_asyncComputeRealValue","internalOptions","preEvaluated","dismissMarkingComputed","asyncEvaluate","noInject","transformAndInject","inject","nextOptions","getNextComputeOptions","evaluate","checkedPermissions","permissionMap","isAdmin","validatePermissions","scanPermissionActionsInStoryboard","_preCheckPermissionsForBrickOrRoute","permissionsPreCheck","scanPermissionActionsInAny","_validatePermissions","usedActions","actions","difference","authorizationStatus","newAuth","org","username","userInstanceId","loginFrom","accessRule","csrfToken","license","userShowValue","logout","fetchByProvider","_fetchByProvider","unstable_createRoot","_portal","position","width","height","unmounted","render","_arguments","previousRendererContext","unmount","renderUseBrick","_renderUseBrick","useBrick","_runtimeContext$tplSt","_output$node","mountUseBrick","portalRoot","unmountUseBrick","mountResult","initializePlayground","_internalApiSetBootstrapData","legacyDoTransform","loadBricks","updateStoryboard","storyboardPatch","updateStoryboardByRoute","newRoute","getKey","replaceRoute","routeKey","unshift","updateStoryboardByTemplate","newTemplate","tplName","updateTemplatePreviewSettings","templateId","_updatePreviewSettings","updateStoryboardBySnippet","snippetData","_snippetData$bricks","snippetId","updateSnippetPreviewSettings","previewRouteIndex","findIndex","newPreviewRoute"],"sourceRoot":""}